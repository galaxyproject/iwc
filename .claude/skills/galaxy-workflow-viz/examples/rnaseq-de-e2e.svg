<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 500" role="img" aria-label="RNA-seq Differential Expression End-to-End workflow diagram">
  <title>RNA-seq DE End-to-End Workflow</title>
  <desc>End-to-end differential expression analysis: Sample Sheet → RNA-seq Processing → DE Analysis → Results</desc>

  <defs>
    <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
      <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#c5d5e4" stroke-width="0.5"/>
    </pattern>
    <pattern id="grid-major" width="100" height="100" patternUnits="userSpaceOnUse">
      <rect width="100" height="100" fill="url(#grid)"/>
      <path d="M 100 0 L 0 0 0 100" fill="none" stroke="#b0c4d8" stroke-width="1"/>
    </pattern>
    <!-- Subworkflow diagonal stripe pattern -->
    <pattern id="subworkflow-stripe" width="8" height="8" patternUnits="userSpaceOnUse" patternTransform="rotate(45)">
      <line x1="0" y1="0" x2="0" y2="8" stroke="#e9ecef" stroke-width="4"/>
    </pattern>

    <style>
      .connection {
        stroke: #25537b;
        stroke-width: 4;
        fill: none;
        stroke-linecap: round;
      }
      .connection-secondary {
        stroke: #25537b;
        stroke-width: 3;
        fill: none;
        stroke-linecap: round;
      }
      .connection-qc {
        stroke: #25537b;
        stroke-width: 3;
        fill: none;
        stroke-linecap: round;
        stroke-dasharray: 5 3;
      }
      .node-card {
        filter: drop-shadow(1px 2px 3px rgba(0,0,0,0.15));
      }
      .subworkflow-card {
        filter: drop-shadow(2px 3px 5px rgba(0,0,0,0.2));
      }
    </style>
  </defs>

  <!-- Background -->
  <rect width="1200" height="500" fill="#f8f9fa"/>
  <rect width="1200" height="500" fill="url(#grid-major)"/>

  <!-- Title bar -->
  <rect x="0" y="0" width="1200" height="45" fill="#25537b"/>
  <text x="20" y="28" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="white">RNA-seq DE End-to-End</text>
  <text x="220" y="28" font-family="system-ui, sans-serif" font-size="12" fill="rgba(255,255,255,0.7)">Complete Pipeline: Processing → Quantification → Differential Expression</text>

  <!-- ==================== CONNECTIONS ==================== -->

  <!-- Sample Sheet output (200,145) → RNA-seq Processing input (300,145) -->
  <path class="connection" d="M 200 145 C 250 145, 250 145, 300 145"/>

  <!-- GTF output (200,270) → RNA-seq Processing input (300,180) -->
  <path class="connection-secondary" d="M 200 270 C 250 270, 250 180, 300 180"/>

  <!-- RNA-seq Processing output (580,130) → DE Analysis input (640,130) -->
  <path class="connection" d="M 580 130 C 610 130, 610 130, 640 130"/>

  <!-- RNA-seq Processing output (580,160) → DE Analysis input (640,160) -->
  <path class="connection" d="M 580 160 C 610 160, 610 160, 640 160"/>

  <!-- DE Analysis outputs → Output nodes -->
  <path class="connection" d="M 920 120 C 960 120, 960 95, 1000 95"/>
  <path class="connection" d="M 920 150 C 960 150, 960 165, 1000 165"/>
  <path class="connection-secondary" d="M 920 180 C 960 180, 960 235, 1000 235"/>

  <!-- RNA-seq Processing → Coverage output -->
  <path class="connection-secondary" d="M 580 200 C 700 200, 700 330, 1000 330"/>

  <!-- RNA-seq Processing QC → MultiQC -->
  <path class="connection-qc" d="M 440 260 C 440 380, 200 380, 200 420"/>

  <!-- ==================== INPUT NODES (Gold) ==================== -->

  <!-- NODE: Sample Sheet -->
  <g class="node-card" transform="translate(20, 100)">
    <rect width="180" height="90" rx="4" fill="white" stroke="#ffd700" stroke-width="1.5"/>
    <rect width="180" height="28" rx="4" fill="#ffd700"/>
    <rect x="0" y="24" width="180" height="4" fill="#ffd700"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(44,49,67,0.6)">1:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#2C3143">Sample Sheet</text>
    <text x="90" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">PE FASTQ Collection</text>
    <text x="90" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">with condition labels</text>
    <circle cx="180" cy="45" r="6" fill="white" stroke="#ffd700" stroke-width="2"/>
  </g>

  <!-- NODE: GTF Annotation -->
  <g class="node-card" transform="translate(20, 225)">
    <rect width="180" height="90" rx="4" fill="white" stroke="#ffd700" stroke-width="1.5"/>
    <rect width="180" height="28" rx="4" fill="#ffd700"/>
    <rect x="0" y="24" width="180" height="4" fill="#ffd700"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(44,49,67,0.6)">2:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#2C3143">GTF Annotation</text>
    <text x="90" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Gene Annotation</text>
    <text x="90" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">Reference GTF</text>
    <circle cx="180" cy="45" r="6" fill="white" stroke="#ffd700" stroke-width="2"/>
  </g>

  <!-- ==================== SUBWORKFLOW NODES (Blue with stripe) ==================== -->

  <!-- SUBWORKFLOW: RNA-seq Processing -->
  <g class="subworkflow-card" transform="translate(300, 70)">
    <rect width="280" height="190" rx="6" fill="url(#subworkflow-stripe)" stroke="#25537b" stroke-width="2"/>
    <rect width="280" height="190" rx="6" fill="rgba(255,255,255,0.92)" stroke="#25537b" stroke-width="2"/>
    <!-- Header -->
    <rect width="280" height="32" rx="6" fill="#25537b"/>
    <rect x="0" y="28" width="280" height="4" fill="#25537b"/>
    <text x="12" y="22" font-family="system-ui, sans-serif" font-size="14" fill="white">⎔</text>
    <text x="30" y="22" font-family="system-ui, sans-serif" font-size="12" font-weight="700" fill="white">RNA-seq Processing</text>
    <!-- Mini flow description -->
    <text x="140" y="58" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">fastp → STAR → Quantification</text>
    <line x1="20" y1="70" x2="260" y2="70" stroke="#e2e8f0" stroke-width="1"/>
    <!-- Mini flow diagram -->
    <g transform="translate(30, 82)">
      <rect x="0" y="0" width="50" height="24" rx="3" fill="#e8f4f8" stroke="#25537b" stroke-width="1"/>
      <text x="25" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#25537b">fastp</text>
      <line x1="50" y1="12" x2="68" y2="12" stroke="#25537b" stroke-width="2"/>
      <rect x="68" y="0" width="50" height="24" rx="3" fill="#e8f4f8" stroke="#25537b" stroke-width="1"/>
      <text x="93" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#25537b">STAR</text>
      <line x1="118" y1="12" x2="136" y2="12" stroke="#25537b" stroke-width="2"/>
      <rect x="136" y="0" width="70" height="24" rx="3" fill="#e8f4f8" stroke="#25537b" stroke-width="1"/>
      <text x="171" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#25537b">Counts/FPKM</text>
    </g>
    <!-- Outputs list -->
    <text x="20" y="130" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Outputs:</text>
    <text x="20" y="145" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">• Counts Table  • Coverage (bigWig)</text>
    <text x="20" y="158" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">• FPKM values  • Mapped BAMs</text>
    <text x="20" y="171" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">• MultiQC Report</text>
    <!-- Terminals -->
    <circle cx="0" cy="75" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="0" cy="110" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="280" cy="60" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="280" cy="90" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="280" cy="130" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="140" cy="190" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
  </g>

  <!-- SUBWORKFLOW: DE Analysis -->
  <g class="subworkflow-card" transform="translate(640, 70)">
    <rect width="280" height="170" rx="6" fill="url(#subworkflow-stripe)" stroke="#25537b" stroke-width="2"/>
    <rect width="280" height="170" rx="6" fill="rgba(255,255,255,0.92)" stroke="#25537b" stroke-width="2"/>
    <!-- Header -->
    <rect width="280" height="32" rx="6" fill="#25537b"/>
    <rect x="0" y="28" width="280" height="4" fill="#25537b"/>
    <text x="12" y="22" font-family="system-ui, sans-serif" font-size="14" fill="white">⎔</text>
    <text x="30" y="22" font-family="system-ui, sans-serif" font-size="12" font-weight="700" fill="white">Differential Expression</text>
    <!-- Mini flow description -->
    <text x="140" y="56" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">DESeq2 → Filter → Visualization</text>
    <line x1="20" y1="66" x2="260" y2="66" stroke="#e2e8f0" stroke-width="1"/>
    <!-- Mini flow diagram -->
    <g transform="translate(30, 78)">
      <rect x="0" y="0" width="55" height="24" rx="3" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
      <text x="27" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#92400e">DESeq2</text>
      <line x1="55" y1="12" x2="73" y2="12" stroke="#25537b" stroke-width="2"/>
      <rect x="73" y="0" width="50" height="24" rx="3" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
      <text x="98" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#92400e">Filter</text>
      <line x1="123" y1="12" x2="141" y2="12" stroke="#25537b" stroke-width="2"/>
      <rect x="141" y="0" width="55" height="24" rx="3" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
      <text x="168" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#92400e">Plots</text>
    </g>
    <!-- Outputs list -->
    <text x="20" y="126" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Outputs:</text>
    <text x="20" y="141" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">• DE Results  • Volcano Plot  • Heatmaps</text>
    <text x="20" y="154" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">• Normalized Counts  • Significant Genes</text>
    <!-- Terminals -->
    <circle cx="0" cy="60" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="0" cy="90" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="280" cy="50" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="280" cy="80" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="280" cy="110" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
  </g>

  <!-- ==================== OUTPUT NODES (Orange) ==================== -->

  <!-- OUTPUT: DE Results -->
  <g class="node-card" transform="translate(1000, 65)">
    <rect width="170" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="170" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="170" height="4" fill="#f97316"/>
    <text x="85" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">DE Results Table</text>
    <text x="85" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">Annotated with gene names</text>
    <text x="85" y="52" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">log2FC, padj, baseMean</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- OUTPUT: Volcano Plot -->
  <g class="node-card" transform="translate(1000, 135)">
    <rect width="170" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="170" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="170" height="4" fill="#f97316"/>
    <text x="85" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Volcano Plot</text>
    <text x="85" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">DE genes visualization</text>
    <text x="85" y="52" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">up/down regulated</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- OUTPUT: Heatmaps -->
  <g class="node-card" transform="translate(1000, 205)">
    <rect width="170" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="170" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="170" height="4" fill="#f97316"/>
    <text x="85" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Heatmaps</text>
    <text x="85" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">Z-scores &amp; normalized counts</text>
    <text x="85" y="52" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">clustered expression</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- OUTPUT: Coverage -->
  <g class="node-card" transform="translate(1000, 300)">
    <rect width="170" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="170" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="170" height="4" fill="#f97316"/>
    <text x="85" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Coverage Tracks</text>
    <text x="85" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">bigWig for browser</text>
    <text x="85" y="52" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">stranded/unstranded</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- NODE: MultiQC (Report - Green) -->
  <g class="node-card" transform="translate(60, 420)">
    <rect width="200" height="55" rx="4" fill="white" stroke="#10b981" stroke-width="1.5"/>
    <rect width="200" height="22" rx="4" fill="#10b981"/>
    <rect x="0" y="18" width="200" height="4" fill="#10b981"/>
    <text x="15" y="15" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">MultiQC Report</text>
    <text x="100" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Combined QC metrics</text>
    <text x="100" y="52" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">fastp, STAR, featureCounts</text>
    <circle cx="140" cy="0" r="5" fill="white" stroke="#10b981" stroke-width="2"/>
  </g>

  <!-- Legend -->
  <g transform="translate(300, 460)">
    <text x="0" y="0" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#495057">Legend:</text>
    <rect x="60" y="-10" width="14" height="14" rx="2" fill="white" stroke="#ffd700" stroke-width="1.5"/>
    <text x="80" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Input</text>
    <rect x="120" y="-10" width="14" height="14" rx="2" fill="url(#subworkflow-stripe)" stroke="#25537b" stroke-width="1"/>
    <text x="140" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Subworkflow</text>
    <line x1="220" y1="-4" x2="260" y2="-4" stroke="#25537b" stroke-width="4" stroke-linecap="round"/>
    <text x="268" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Data flow</text>
    <line x1="340" y1="-4" x2="380" y2="-4" stroke="#25537b" stroke-width="3" stroke-linecap="round" stroke-dasharray="5 3"/>
    <text x="388" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">QC metrics</text>
    <rect x="460" y="-10" width="14" height="14" rx="2" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <text x="480" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Output</text>
    <rect x="530" y="-10" width="14" height="14" rx="2" fill="white" stroke="#10b981" stroke-width="1.5"/>
    <text x="550" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Report</text>
  </g>

</svg>
