<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 500" role="img" aria-label="End to End Differential Expression RNA-seq workflow diagram">
  <title>End to End DE RNA-seq</title>
  <desc>Complete RNA-seq differential expression pipeline: Sample sheet → RNA-seq processing → DE analysis → Results</desc>

  <defs>
    <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
      <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#c5d5e4" stroke-width="0.5"/>
    </pattern>
    <pattern id="grid-major" width="100" height="100" patternUnits="userSpaceOnUse">
      <rect width="100" height="100" fill="url(#grid)"/>
      <path d="M 100 0 L 0 0 0 100" fill="none" stroke="#b0c4d8" stroke-width="1"/>
    </pattern>

    <!-- Subworkflow pattern -->
    <pattern id="subworkflow-pattern" width="8" height="8" patternUnits="userSpaceOnUse">
      <path d="M 0 8 L 8 0" stroke="#e2e8f0" stroke-width="1"/>
    </pattern>

    <style>
      .connection {
        stroke: #25537b;
        stroke-width: 4;
        fill: none;
        stroke-linecap: round;
      }
      .connection-secondary {
        stroke: #25537b;
        stroke-width: 3;
        fill: none;
        stroke-linecap: round;
      }
      .node-card {
        filter: drop-shadow(1px 2px 3px rgba(0,0,0,0.15));
      }
      .subworkflow-card {
        filter: drop-shadow(2px 3px 5px rgba(0,0,0,0.2));
      }
    </style>
  </defs>

  <!-- Background -->
  <rect width="1200" height="500" fill="#f8f9fa"/>
  <rect width="1200" height="500" fill="url(#grid-major)"/>

  <!-- Title bar -->
  <rect x="0" y="0" width="1200" height="45" fill="#25537b"/>
  <text x="20" y="28" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="white">End to End Differential Expression RNA-seq</text>
  <text x="380" y="28" font-family="system-ui, sans-serif" font-size="12" fill="rgba(255,255,255,0.7)">Complete Pipeline: Processing → Quantification → Differential Expression</text>

  <!-- ==================== CONNECTIONS ==================== -->

  <!-- Sample sheet → RNA-seq processing: (200,145) → (300,145) -->
  <path class="connection" d="M 200 145 C 250 145, 250 145, 300 145"/>

  <!-- GTF → RNA-seq processing: (200,270) → (300,180) -->
  <path class="connection-secondary" d="M 200 270 C 250 270, 250 180, 300 180"/>

  <!-- RNA-seq → DE Analysis: (580,160) → (640,160) -->
  <path class="connection" d="M 580 160 C 610 160, 610 160, 640 160"/>

  <!-- RNA-seq Counts → DE Analysis -->
  <path class="connection" d="M 580 130 C 610 130, 610 130, 640 130"/>

  <!-- DE Analysis → Outputs -->
  <path class="connection" d="M 920 120 C 970 120, 970 95, 1000 95"/>
  <path class="connection" d="M 920 150 C 970 150, 970 165, 1000 165"/>
  <path class="connection" d="M 920 180 C 970 180, 970 235, 1000 235"/>

  <!-- RNA-seq → Coverage outputs -->
  <path class="connection-secondary" d="M 580 200 C 700 200, 700 330, 1000 330"/>

  <!-- RNA-seq → MultiQC -->
  <path class="connection-secondary" d="M 440 260 C 440 400, 200 400, 200 420"/>

  <!-- ==================== INPUT NODES ==================== -->

  <!-- NODE: Sample Sheet (Input) -->
  <g class="node-card" transform="translate(20, 100)">
    <rect width="180" height="90" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="180" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="24" width="180" height="4" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)">1:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">Sample Sheet</text>
    <text x="90" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">PE FASTQ Collection</text>
    <text x="90" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">with condition labels</text>
    <circle cx="180" cy="45" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
  </g>

  <!-- NODE: GTF Annotation (Input) -->
  <g class="node-card" transform="translate(20, 225)">
    <rect width="180" height="90" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="180" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="24" width="180" height="4" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)">2:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">GTF Annotation</text>
    <text x="90" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Gene Annotation</text>
    <text x="90" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">Reference GTF</text>
    <circle cx="180" cy="45" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
  </g>

  <!-- ==================== SUBWORKFLOW NODES ==================== -->

  <!-- SUBWORKFLOW: RNA-seq Processing -->
  <g class="subworkflow-card" transform="translate(300, 70)">
    <!-- Outer box with pattern fill -->
    <rect width="280" height="190" rx="6" fill="url(#subworkflow-pattern)" stroke="#25537b" stroke-width="2"/>
    <rect width="280" height="190" rx="6" fill="rgba(255,255,255,0.9)" stroke="#25537b" stroke-width="2"/>
    <!-- Header -->
    <rect width="280" height="32" rx="6" fill="#25537b"/>
    <rect x="0" y="28" width="280" height="4" fill="#25537b"/>
    <!-- Subworkflow icon -->
    <text x="12" y="22" font-family="system-ui, sans-serif" font-size="14" fill="white">⎔</text>
    <text x="30" y="22" font-family="system-ui, sans-serif" font-size="12" font-weight="700" fill="white">RNA-seq Processing</text>
    <!-- Inner content -->
    <text x="140" y="60" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">fastp → STAR → Quantification</text>
    <line x1="20" y1="72" x2="260" y2="72" stroke="#e2e8f0" stroke-width="1"/>
    <!-- Mini flow diagram -->
    <g transform="translate(30, 85)">
      <rect x="0" y="0" width="50" height="25" rx="3" fill="#e8f4f8" stroke="#25537b" stroke-width="1"/>
      <text x="25" y="16" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#25537b">fastp</text>
      <line x1="50" y1="12" x2="70" y2="12" stroke="#25537b" stroke-width="2"/>
      <rect x="70" y="0" width="50" height="25" rx="3" fill="#e8f4f8" stroke="#25537b" stroke-width="1"/>
      <text x="95" y="16" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#25537b">STAR</text>
      <line x1="120" y1="12" x2="140" y2="12" stroke="#25537b" stroke-width="2"/>
      <rect x="140" y="0" width="70" height="25" rx="3" fill="#e8f4f8" stroke="#25537b" stroke-width="1"/>
      <text x="175" y="16" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#25537b">Counts/FPKM</text>
    </g>
    <!-- Outputs list -->
    <text x="20" y="135" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Outputs:</text>
    <text x="20" y="150" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">• Counts Table  • Coverage (bigWig)</text>
    <text x="20" y="163" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">• FPKM values  • Mapped BAMs</text>
    <text x="20" y="176" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">• MultiQC Report</text>
    <!-- Terminals -->
    <circle cx="0" cy="75" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="0" cy="110" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="280" cy="60" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="280" cy="90" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="280" cy="130" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="140" cy="190" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
  </g>

  <!-- SUBWORKFLOW: DE Analysis -->
  <g class="subworkflow-card" transform="translate(640, 70)">
    <rect width="280" height="170" rx="6" fill="url(#subworkflow-pattern)" stroke="#25537b" stroke-width="2"/>
    <rect width="280" height="170" rx="6" fill="rgba(255,255,255,0.9)" stroke="#25537b" stroke-width="2"/>
    <!-- Header -->
    <rect width="280" height="32" rx="6" fill="#25537b"/>
    <rect x="0" y="28" width="280" height="4" fill="#25537b"/>
    <text x="12" y="22" font-family="system-ui, sans-serif" font-size="14" fill="white">⎔</text>
    <text x="30" y="22" font-family="system-ui, sans-serif" font-size="12" font-weight="700" fill="white">Differential Expression</text>
    <!-- Inner content -->
    <text x="140" y="58" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">DESeq2 → Visualization</text>
    <line x1="20" y1="68" x2="260" y2="68" stroke="#e2e8f0" stroke-width="1"/>
    <!-- Mini flow -->
    <g transform="translate(30, 80)">
      <rect x="0" y="0" width="60" height="25" rx="3" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
      <text x="30" y="16" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#92400e">DESeq2</text>
      <line x1="60" y1="12" x2="80" y2="12" stroke="#25537b" stroke-width="2"/>
      <rect x="80" y="0" width="60" height="25" rx="3" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
      <text x="110" y="16" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#92400e">Filter</text>
      <line x1="140" y1="12" x2="160" y2="12" stroke="#25537b" stroke-width="2"/>
      <rect x="160" y="0" width="55" height="25" rx="3" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
      <text x="187" y="16" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#92400e">Plots</text>
    </g>
    <!-- Outputs list -->
    <text x="20" y="130" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Outputs:</text>
    <text x="20" y="145" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">• DE Results  • Volcano Plot  • Heatmaps</text>
    <text x="20" y="158" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">• Normalized Counts  • Significant Genes</text>
    <!-- Terminals -->
    <circle cx="0" cy="60" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="0" cy="90" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="280" cy="50" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="280" cy="80" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="280" cy="110" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
  </g>

  <!-- ==================== OUTPUT NODES ==================== -->

  <!-- OUTPUT: DE Results -->
  <g class="node-card" transform="translate(1000, 65)">
    <rect width="170" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="170" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="170" height="4" fill="#f97316"/>
    <text x="85" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">DE Results Table</text>
    <text x="85" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">Annotated with gene names</text>
    <text x="85" y="52" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">log2FC, padj, baseMean</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- OUTPUT: Volcano Plot -->
  <g class="node-card" transform="translate(1000, 135)">
    <rect width="170" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="170" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="170" height="4" fill="#f97316"/>
    <text x="85" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Volcano Plot</text>
    <text x="85" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">DE genes visualization</text>
    <text x="85" y="52" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">up/down regulated</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- OUTPUT: Heatmaps -->
  <g class="node-card" transform="translate(1000, 205)">
    <rect width="170" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="170" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="170" height="4" fill="#f97316"/>
    <text x="85" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Heatmaps</text>
    <text x="85" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">Z-scores &amp; normalized counts</text>
    <text x="85" y="52" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">clustered expression</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- OUTPUT: Coverage -->
  <g class="node-card" transform="translate(1000, 300)">
    <rect width="170" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="170" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="170" height="4" fill="#f97316"/>
    <text x="85" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Coverage Tracks</text>
    <text x="85" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">bigWig for browser</text>
    <text x="85" y="52" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">stranded/unstranded</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- NODE: MultiQC -->
  <g class="node-card" transform="translate(60, 420)">
    <rect width="200" height="55" rx="4" fill="white" stroke="#10b981" stroke-width="1.5"/>
    <rect width="200" height="22" rx="4" fill="#10b981"/>
    <rect x="0" y="18" width="200" height="4" fill="#10b981"/>
    <text x="15" y="15" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">MultiQC Report</text>
    <text x="100" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Combined QC metrics</text>
    <text x="100" y="52" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">fastp, STAR, featureCounts</text>
    <circle cx="140" cy="0" r="5" fill="white" stroke="#10b981" stroke-width="2"/>
  </g>

  <!-- Legend -->
  <g transform="translate(350, 455)">
    <text x="0" y="0" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#495057">Legend:</text>
    <rect x="60" y="-12" width="20" height="16" rx="3" fill="url(#subworkflow-pattern)" stroke="#25537b" stroke-width="1.5"/>
    <text x="88" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Subworkflow</text>
    <line x1="170" y1="-4" x2="200" y2="-4" stroke="#25537b" stroke-width="4" stroke-linecap="round"/>
    <text x="208" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Data flow</text>
    <rect x="280" y="-10" width="14" height="14" rx="2" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <text x="300" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Output</text>
    <rect x="360" y="-10" width="14" height="14" rx="2" fill="white" stroke="#10b981" stroke-width="1.5"/>
    <text x="380" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Report</text>
  </g>

</svg>
