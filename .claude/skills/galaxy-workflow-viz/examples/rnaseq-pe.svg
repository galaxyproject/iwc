<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1300 550" role="img" aria-label="RNA-seq PE workflow diagram">
  <title>RNA-Seq PE Workflow</title>
  <desc>Paired-end RNA-seq analysis: FASTQ → QC/Trim → STAR mapping → Quantification branches → Outputs</desc>

  <defs>
    <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
      <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#c5d5e4" stroke-width="0.5"/>
    </pattern>
    <pattern id="grid-major" width="100" height="100" patternUnits="userSpaceOnUse">
      <rect width="100" height="100" fill="url(#grid)"/>
      <path d="M 100 0 L 0 0 0 100" fill="none" stroke="#b0c4d8" stroke-width="1"/>
    </pattern>

    <style>
      .connection {
        stroke: #25537b;
        stroke-width: 4;
        fill: none;
        stroke-linecap: round;
      }
      .connection-secondary {
        stroke: #25537b;
        stroke-width: 3;
        fill: none;
        stroke-linecap: round;
      }
      .connection-qc {
        stroke: #25537b;
        stroke-width: 3;
        fill: none;
        stroke-linecap: round;
        stroke-dasharray: 5 3;
      }
      .node-card {
        filter: drop-shadow(1px 2px 3px rgba(0,0,0,0.15));
      }
    </style>
  </defs>

  <!-- Background -->
  <rect width="1300" height="550" fill="#f8f9fa"/>
  <rect width="1300" height="550" fill="url(#grid-major)"/>

  <!-- Title bar -->
  <rect x="0" y="0" width="1300" height="45" fill="#25537b"/>
  <text x="20" y="28" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="white">RNA-Seq PE</text>
  <text x="130" y="28" font-family="system-ui, sans-serif" font-size="12" fill="rgba(255,255,255,0.7)">Paired-End RNA-Seq Analysis with Multiple Quantification Methods</text>

  <!-- ==================== CONNECTIONS ==================== -->

  <!-- PE FASTQs output (200,145) → fastp input (280,145) -->
  <path class="connection" d="M 200 145 C 240 145, 240 145, 280 145"/>

  <!-- GTF output (200,270) → STAR input (560,175) -->
  <path class="connection-secondary" d="M 200 270 C 300 270, 400 175, 560 175"/>

  <!-- fastp output (480,145) → STAR input (560,145) -->
  <path class="connection" d="M 480 145 C 520 145, 520 145, 560 145"/>

  <!-- STAR → Coverage branch: (760,120) → (840,90) -->
  <path class="connection-secondary" d="M 760 120 C 800 120, 800 90, 840 90"/>

  <!-- STAR → Gene Counts branch: (760,145) → (840,170) -->
  <path class="connection" d="M 760 145 C 800 145, 800 170, 840 170"/>

  <!-- STAR → Cufflinks branch: (760,170) → (840,280) -->
  <path class="connection-secondary" d="M 760 170 C 800 170, 800 280, 840 280"/>

  <!-- STAR → StringTie branch: (760,170) → (840,370) -->
  <path class="connection-secondary" d="M 760 170 C 790 170, 790 370, 840 370"/>

  <!-- Coverage → Output: (1040,90) → (1140,90) -->
  <path class="connection-secondary" d="M 1040 90 C 1090 90, 1090 90, 1140 90"/>

  <!-- Gene Counts → Output: (1040,170) → (1140,160) -->
  <path class="connection" d="M 1040 170 C 1090 170, 1090 160, 1140 160"/>

  <!-- Cufflinks → Output: (1040,280) → (1140,230) -->
  <path class="connection-secondary" d="M 1040 280 C 1090 280, 1090 230, 1140 230"/>

  <!-- StringTie → Output: (1040,370) → (1140,300) -->
  <path class="connection-secondary" d="M 1040 370 C 1090 370, 1090 300, 1140 300"/>

  <!-- QC: fastp (380,200) → MultiQC (160,455) -->
  <path class="connection-qc" d="M 380 200 C 380 340, 160 340, 160 455"/>

  <!-- QC: STAR (660,200) → MultiQC (200,455) -->
  <path class="connection-qc" d="M 660 200 C 660 380, 200 380, 200 455"/>

  <!-- QC: Gene Counts (940,220) → MultiQC (240,455) -->
  <path class="connection-qc" d="M 940 220 C 940 420, 240 420, 240 455"/>

  <!-- ==================== NODES ==================== -->

  <!-- NODE: PE FASTQs (Input - Gold) -->
  <g class="node-card" transform="translate(20, 100)">
    <rect width="180" height="90" rx="4" fill="white" stroke="#ffd700" stroke-width="1.5"/>
    <rect width="180" height="28" rx="4" fill="#ffd700"/>
    <rect x="0" y="24" width="180" height="4" fill="#ffd700"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(44,49,67,0.6)">1:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#2C3143">PE FASTQs</text>
    <text x="90" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Paired Collection</text>
    <text x="90" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">RNA-seq reads</text>
    <circle cx="180" cy="45" r="6" fill="white" stroke="#ffd700" stroke-width="2"/>
  </g>

  <!-- NODE: GTF Annotation (Input - Gold) -->
  <g class="node-card" transform="translate(20, 225)">
    <rect width="180" height="90" rx="4" fill="white" stroke="#ffd700" stroke-width="1.5"/>
    <rect width="180" height="28" rx="4" fill="#ffd700"/>
    <rect x="0" y="24" width="180" height="4" fill="#ffd700"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(44,49,67,0.6)">2:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#2C3143">GTF Annotation</text>
    <text x="90" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Gene Annotation</text>
    <text x="90" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">Reference GTF</text>
    <circle cx="180" cy="45" r="6" fill="white" stroke="#ffd700" stroke-width="2"/>
  </g>

  <!-- NODE: fastp (Processing - Blue) -->
  <g class="node-card" transform="translate(280, 100)">
    <rect width="200" height="100" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="200" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="24" width="200" height="4" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)">3:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">fastp</text>
    <text x="100" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">QC &amp; Adapter Trimming</text>
    <text x="100" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">Quality filtering</text>
    <line x1="10" y1="82" x2="190" y2="82" stroke="#25537b" stroke-width="1" stroke-dasharray="2 2"/>
    <circle cx="0" cy="45" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="200" cy="45" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="100" cy="100" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
  </g>

  <!-- NODE: RNA STAR (Processing - Blue, key step) -->
  <g class="node-card" transform="translate(560, 100)">
    <rect width="200" height="100" rx="4" fill="white" stroke="#25537b" stroke-width="2"/>
    <rect width="200" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="24" width="200" height="4" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)">4:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="700" fill="white">RNA STAR</text>
    <text x="100" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#495057">Splice-aware Alignment</text>
    <text x="100" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">ENCODE parameters</text>
    <line x1="10" y1="82" x2="190" y2="82" stroke="#25537b" stroke-width="1" stroke-dasharray="2 2"/>
    <circle cx="0" cy="45" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="0" cy="75" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="200" cy="20" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="200" cy="45" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="200" cy="70" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="100" cy="100" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
  </g>

  <!-- NODE: Coverage Generation (Processing - Blue) -->
  <g class="node-card" transform="translate(840, 60)">
    <rect width="200" height="60" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="200" height="24" rx="4" fill="#25537b"/>
    <rect x="0" y="20" width="200" height="4" fill="#25537b"/>
    <text x="10" y="17" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Coverage Generation</text>
    <text x="100" y="45" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">bedtools → bigWig</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="200" cy="30" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
  </g>

  <!-- NODE: Gene Counts (Processing - Blue) -->
  <g class="node-card" transform="translate(840, 140)">
    <rect width="200" height="80" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="200" height="24" rx="4" fill="#25537b"/>
    <rect x="0" y="20" width="200" height="4" fill="#25537b"/>
    <text x="10" y="17" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Gene Counts</text>
    <text x="100" y="45" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#495057">STAR counts or featureCounts</text>
    <text x="100" y="60" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">HTSeq-compatible format</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="200" cy="30" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="100" cy="80" r="4" fill="white" stroke="#25537b" stroke-width="1"/>
  </g>

  <!-- NODE: Cufflinks (Processing - Blue) -->
  <g class="node-card" transform="translate(840, 250)">
    <rect width="200" height="60" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="200" height="24" rx="4" fill="#25537b"/>
    <rect x="0" y="20" width="200" height="4" fill="#25537b"/>
    <text x="10" y="17" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Cufflinks</text>
    <text x="100" y="45" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">FPKM quantification</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="200" cy="30" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
  </g>

  <!-- NODE: StringTie (Processing - Blue) -->
  <g class="node-card" transform="translate(840, 340)">
    <rect width="200" height="60" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="200" height="24" rx="4" fill="#25537b"/>
    <rect x="0" y="20" width="200" height="4" fill="#25537b"/>
    <text x="10" y="17" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">StringTie</text>
    <text x="100" y="45" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">FPKM/TPM quantification</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <circle cx="200" cy="30" r="5" fill="white" stroke="#25537b" stroke-width="1.5"/>
  </g>

  <!-- OUTPUT NODES (Orange) -->

  <!-- OUTPUT: Coverage bigWig -->
  <g class="node-card" transform="translate(1140, 60)">
    <rect width="130" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="130" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="130" height="4" fill="#f97316"/>
    <text x="65" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Coverage</text>
    <text x="65" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">bigWig tracks</text>
    <text x="65" y="50" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">stranded/unstranded</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- OUTPUT: Counts Table -->
  <g class="node-card" transform="translate(1140, 130)">
    <rect width="130" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="130" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="130" height="4" fill="#f97316"/>
    <text x="65" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Counts Table</text>
    <text x="65" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">Gene counts</text>
    <text x="65" y="50" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">for DESeq2/edgeR</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- OUTPUT: Cufflinks FPKM -->
  <g class="node-card" transform="translate(1140, 200)">
    <rect width="130" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="130" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="130" height="4" fill="#f97316"/>
    <text x="65" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Cufflinks FPKM</text>
    <text x="65" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">Gene expression</text>
    <text x="65" y="50" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">normalized values</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- OUTPUT: StringTie FPKM -->
  <g class="node-card" transform="translate(1140, 270)">
    <rect width="130" height="55" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="130" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="18" width="130" height="4" fill="#f97316"/>
    <text x="65" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">StringTie FPKM</text>
    <text x="65" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">Gene abundance</text>
    <text x="65" y="50" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#adb5bd">TPM/FPKM values</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- NODE: MultiQC (Report - Green) -->
  <g class="node-card" transform="translate(60, 455)">
    <rect width="220" height="70" rx="4" fill="white" stroke="#10b981" stroke-width="1.5"/>
    <rect width="220" height="24" rx="4" fill="#10b981"/>
    <rect x="0" y="20" width="220" height="4" fill="#10b981"/>
    <text x="15" y="17" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">MultiQC</text>
    <text x="110" y="45" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Combined QC Report</text>
    <text x="110" y="60" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">fastp, STAR, featureCounts, RSeQC</text>
    <circle cx="100" cy="0" r="5" fill="white" stroke="#10b981" stroke-width="2"/>
    <circle cx="140" cy="0" r="5" fill="white" stroke="#10b981" stroke-width="2"/>
    <circle cx="180" cy="0" r="5" fill="white" stroke="#10b981" stroke-width="2"/>
  </g>

  <!-- Legend -->
  <g transform="translate(400, 510)">
    <text x="0" y="0" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#495057">Legend:</text>
    <rect x="60" y="-10" width="14" height="14" rx="2" fill="white" stroke="#ffd700" stroke-width="1.5"/>
    <text x="80" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Input</text>
    <line x1="120" y1="-4" x2="160" y2="-4" stroke="#25537b" stroke-width="4" stroke-linecap="round"/>
    <text x="168" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Data flow</text>
    <line x1="240" y1="-4" x2="280" y2="-4" stroke="#25537b" stroke-width="3" stroke-linecap="round" stroke-dasharray="5 3"/>
    <text x="288" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">QC metrics</text>
    <rect x="360" y="-10" width="14" height="14" rx="2" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <text x="380" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Output</text>
    <rect x="430" y="-10" width="14" height="14" rx="2" fill="white" stroke="#10b981" stroke-width="1.5"/>
    <text x="450" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Report</text>
  </g>

</svg>
