{"version":3,"file":"CollectionContent.CSHjp14j.js","sources":["../../src/components/CollectionContent.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref, computed, onMounted, onUnmounted } from \"vue\";\nimport { useStore } from \"@nanostores/vue\";\nimport Fuse from \"fuse.js\";\nimport { allWorkflows, collectionSearchQuery, viewMode } from \"../stores/workflowStore\";\nimport WorkflowCard from \"./WorkflowCard.vue\";\nimport WorkflowListItem from \"./WorkflowListItem.vue\";\nimport ViewToggle from \"./ViewToggle.vue\";\n\nconst props = defineProps<{\n    collectionName: string;\n}>();\n\nconst workflows = useStore(allWorkflows);\nconst mode = useStore(viewMode);\nconst localSearchQuery = ref(\"\");\n\n// Filter workflows by the selected collection\nconst collectionWorkflows = computed(() =>\n    workflows.value.filter((workflow) =>\n        workflow.collections.some((col) => col.toLowerCase() === props.collectionName.toLowerCase()),\n    ),\n);\n\n// Sort workflows descending by workflow.updated\nconst sortedWorkflows = computed(() =>\n    collectionWorkflows.value.slice().sort((a, b) => new Date(b.updated).getTime() - new Date(a.updated).getTime()),\n);\n\n// Define a fuse instance for fuzzy searching\nconst fuseOptions = {\n    keys: [\n        {\n            name: \"definition.name\",\n            weight: 0.7,\n        },\n        {\n            name: \"definition.annotation\",\n            weight: 0.3,\n        },\n        {\n            name: \"definition.tags\",\n            weight: 0.1,\n        },\n    ],\n    threshold: 0.3,\n};\n\nconst fuse = computed(() => new Fuse(sortedWorkflows.value, fuseOptions));\n\nconst filteredWorkflows = computed(() => {\n    if (!localSearchQuery.value) {\n        return sortedWorkflows.value;\n    } else {\n        const searchResults = fuse.value.search(localSearchQuery.value.trim());\n        return searchResults.map((result) => result.item);\n    }\n});\n\nconst isSearching = computed(() => localSearchQuery.value.trim().length > 0);\n\nconst handleSearchInput = (e: Event) => {\n    const value = (e.target as HTMLInputElement).value;\n    localSearchQuery.value = value;\n    collectionSearchQuery.set(value);\n};\n\nonMounted(() => {\n    // Initialize view mode from localStorage\n    const savedViewMode = localStorage.getItem(\"iwc-view-mode\");\n    if (savedViewMode === \"list\" || savedViewMode === \"grid\") {\n        viewMode.set(savedViewMode);\n    }\n});\n\nonUnmounted(() => {\n    // Reset search query when leaving the collection page\n    collectionSearchQuery.set(\"\");\n});\n</script>\n\n<template>\n    <div>\n        <!-- Search input -->\n        <div class=\"mb-4\">\n            <input\n                type=\"text\"\n                :value=\"localSearchQuery\"\n                :placeholder=\"`Search ${collectionName} workflows...`\"\n                class=\"w-full p-3 border border-chicago-200 bg-white rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-hokey-pokey-500 focus:border-transparent transition-shadow\"\n                @input=\"handleSearchInput\" />\n        </div>\n\n        <!-- Results header with view toggle -->\n        <div class=\"flex justify-between items-center mb-4\">\n            <p v-if=\"isSearching\" class=\"text-chicago-600 text-sm\">\n                Found <span class=\"font-semibold\">{{ filteredWorkflows.length }}</span> workflows\n            </p>\n            <p v-else class=\"text-chicago-600 text-sm\">\n                <span class=\"font-semibold\">{{ filteredWorkflows.length }}</span> workflows\n            </p>\n            <ViewToggle />\n        </div>\n\n        <div v-if=\"filteredWorkflows.length === 0\" class=\"text-center py-8\">\n            <p class=\"text-gray-500 text-lg\">No workflows found matching your search.</p>\n            <button\n                class=\"text-blue-600 hover:text-blue-800 underline mt-2 inline-block\"\n                @click=\"\n                    localSearchQuery = '';\n                    collectionSearchQuery.set('');\n                \">\n                Clear search\n            </button>\n        </div>\n\n        <!-- List View -->\n        <div\n            v-else-if=\"mode === 'list'\"\n            id=\"workflows\"\n            class=\"flex flex-col border border-ebony-clay-100 rounded-xl overflow-hidden shadow-sm\">\n            <WorkflowListItem\n                v-for=\"workflow in filteredWorkflows\"\n                :key=\"workflow.definition.uuid\"\n                :workflow=\"workflow\" />\n        </div>\n\n        <!-- Grid View -->\n        <div v-else id=\"workflows\" class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            <WorkflowCard\n                v-for=\"workflow in filteredWorkflows\"\n                :key=\"workflow.definition.uuid\"\n                :workflow=\"workflow\"\n                compact />\n        </div>\n    </div>\n</template>\n"],"names":["props","__props","workflows","useStore","allWorkflows","mode","viewMode","localSearchQuery","ref","collectionWorkflows","computed","workflow","col","sortedWorkflows","a","b","fuseOptions","fuse","Fuse","filteredWorkflows","result","isSearching","handleSearchInput","e","value","collectionSearchQuery","onMounted","savedViewMode","onUnmounted","_hoisted_1","_hoisted_3","_hoisted_5","_hoisted_7","_createElementBlock","_createElementVNode","$setup","$props","_hoisted_2","_openBlock","_hoisted_4","_cache","_createTextVNode","_toDisplayString","_hoisted_6","_createVNode","_hoisted_8","$event","_hoisted_9","_Fragment","_renderList","_createBlock","_hoisted_10"],"mappings":"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"}