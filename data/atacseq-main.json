{
    "name": "main",
    "subclass": "Galaxy",
    "publish": true,
    "primaryDescriptorPath": "/atacseq.ga",
    "testParameterFiles": [
        "/atacseq-tests.yml"
    ],
    "authors": [
        {
            "name": "Lucille Delisle",
            "orcid": "0000-0002-1964-4960"
        }
    ],
    "definition": {
        "a_galaxy_workflow": "true",
        "annotation": "Complete ATAC-seq analysis pipeline for paired-end reads. Processes raw FASTQ data through adapter and bad quality removal (cutadapt), alignment (Bowtie2 end-to-end), and filtering (removes MT reads, discordant pairs, low mapping quality <30, PCR duplicates). Generates 5' cut site pileups (\u00b1100bp), performs peak calling, and quantifies reads in 1kb summit-centered regions. Produces two normalized coverage tracks (per million mapped reads and per million reads in peaks) and fragment length distribution plots for quality assessment.",
        "comments": [],
        "creator": [
            {
                "class": "Person",
                "identifier": "https://orcid.org/0000-0002-1964-4960",
                "name": "Lucille Delisle"
            }
        ],
        "format-version": "0.1",
        "license": "MIT",
        "release": "1.0",
        "name": "ATAC-seq Analysis: Chromatin Accessibility Profiling",
        "steps": {
            "0": {
                "annotation": "Should be a paired collection with ATAC-seq fastqs",
                "content_id": null,
                "errors": null,
                "id": 0,
                "input_connections": {},
                "inputs": [
                    {
                        "description": "Should be a paired collection with ATAC-seq fastqs",
                        "name": "PE fastq input"
                    }
                ],
                "label": "PE fastq input",
                "name": "Input dataset collection",
                "outputs": [],
                "position": {
                    "left": 0,
                    "top": 579.4833374023438
                },
                "tool_id": null,
                "tool_state": "{\"optional\": false, \"tag\": \"\", \"collection_type\": \"list:paired\"}",
                "tool_version": null,
                "type": "data_collection_input",
                "uuid": "3b1d869d-e8a9-49d9-894c-8aa500cd445d",
                "when": null,
                "workflow_outputs": []
            },
            "1": {
                "annotation": "reference_genome",
                "content_id": null,
                "errors": null,
                "id": 1,
                "input_connections": {},
                "inputs": [
                    {
                        "description": "reference_genome",
                        "name": "reference_genome"
                    }
                ],
                "label": "reference_genome",
                "name": "Input parameter",
                "outputs": [],
                "position": {
                    "left": 30.550048828125,
                    "top": 684.38330078125
                },
                "tool_id": null,
                "tool_state": "{\"restrictOnConnections\": true, \"parameter_type\": \"text\", \"optional\": false}",
                "tool_version": null,
                "type": "parameter_input",
                "uuid": "c085055c-9d18-49d7-9f87-fae61683d775",
                "when": null,
                "workflow_outputs": []
            },
            "2": {
                "annotation": "Used by macs2:\\nH. sapiens: 2700000000, M. musculus: 1870000000, D. melanogaster: 120000000, C. elegans: 90000000",
                "content_id": null,
                "errors": null,
                "id": 2,
                "input_connections": {},
                "inputs": [
                    {
                        "description": "Used by macs2:\\nH. sapiens: 2700000000, M. musculus: 1870000000, D. melanogaster: 120000000, C. elegans: 90000000",
                        "name": "effective_genome_size"
                    }
                ],
                "label": "effective_genome_size",
                "name": "Input parameter",
                "outputs": [],
                "position": {
                    "left": 98,
                    "top": 787.9833374023438
                },
                "tool_id": null,
                "tool_state": "{\"parameter_type\": \"integer\", \"optional\": false}",
                "tool_version": null,
                "type": "parameter_input",
                "uuid": "43f5c231-ed56-4cda-bd50-0495dfd77d70",
                "when": null,
                "workflow_outputs": []
            },
            "3": {
                "annotation": "Bin size for normalized bigwig (usually 50bp is sufficient)",
                "content_id": null,
                "errors": null,
                "id": 3,
                "input_connections": {},
                "inputs": [
                    {
                        "description": "Bin size for normalized bigwig (usually 50bp is sufficient)",
                        "name": "bin_size"
                    }
                ],
                "label": "bin_size",
                "name": "Input parameter",
                "outputs": [],
                "position": {
                    "left": 155.54247082439377,
                    "top": 898.8496207394044
                },
                "tool_id": null,
                "tool_state": "{\"parameter_type\": \"integer\", \"optional\": false}",
                "tool_version": null,
                "type": "parameter_input",
                "uuid": "942c77e6-f462-49ac-87ed-6e4e14589b0b",
                "when": null,
                "workflow_outputs": []
            },
            "4": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.9+galaxy1",
                "errors": null,
                "id": 4,
                "input_connections": {
                    "library|input_1": {
                        "id": 0,
                        "output_name": "output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool Cutadapt",
                        "name": "library"
                    }
                ],
                "label": "Cutadapt (remove adapter + bad quality bases)",
                "name": "Cutadapt",
                "outputs": [
                    {
                        "name": "out_pairs",
                        "type": "input"
                    },
                    {
                        "name": "report",
                        "type": "txt"
                    }
                ],
                "position": {
                    "left": 278.16668701171875,
                    "top": 492.36669921875
                },
                "post_job_actions": {
                    "HideDatasetActionout_pairs": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_pairs"
                    },
                    "HideDatasetActionreport": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "report"
                    },
                    "RenameDatasetActionreport": {
                        "action_arguments": {
                            "newname": "cutadapt report"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "report"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.9+galaxy1",
                "tool_shed_repository": {
                    "changeset_revision": "5eb7e84243f2",
                    "name": "cutadapt",
                    "owner": "lparsons",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"adapter_options\": {\"action\": \"trim\", \"error_rate\": \"0.1\", \"no_indels\": false, \"times\": \"1\", \"overlap\": \"3\", \"match_read_wildcards\": false, \"no_match_adapter_wildcards\": true, \"revcomp\": false}, \"filter_options\": {\"discard_trimmed\": false, \"discard_untrimmed\": false, \"minimum_length\": \"15\", \"minimum_length2\": null, \"maximum_length\": null, \"maximum_length2\": null, \"max_n\": null, \"max_expected_errors\": null, \"max_average_error_rate\": null, \"discard_casava\": false, \"pair_filter\": \"any\"}, \"library\": {\"type\": \"paired_collection\", \"__current_case__\": 2, \"input_1\": {\"__class__\": \"ConnectedValue\"}, \"r1\": {\"adapters\": [{\"__index__\": 0, \"adapter_source\": {\"adapter_source_list\": \"user\", \"__current_case__\": 0, \"adapter_name\": \"Nextera R1\", \"adapter\": \"CTGTCTCTTATACACATCTCCGAGCCCACGAGAC\"}, \"single_noindels\": false}], \"front_adapters\": [], \"anywhere_adapters\": []}, \"r2\": {\"adapters2\": [{\"__index__\": 0, \"adapter_source\": {\"adapter_source_list\": \"user\", \"__current_case__\": 0, \"adapter_name\": \"Nextera R2\", \"adapter\": \"CTGTCTCTTATACACATCTGACGCTGCCGACGA\"}, \"single_noindels\": false}], \"front_adapters2\": [], \"anywhere_adapters2\": []}, \"pair_adapters\": false}, \"other_trimming_options\": {\"cut\": \"0\", \"cut2\": \"0\", \"quality_cutoff\": \"30\", \"quality_cutoff2\": \"\", \"nextseq_trim\": \"0\", \"trim_n\": false, \"poly_a\": false, \"shorten_options\": {\"shorten_values\": \"False\", \"__current_case__\": 1}, \"shorten_options_r2\": {\"shorten_values_r2\": \"False\", \"__current_case__\": 1}}, \"output_selector\": [\"report\"], \"read_mod_options\": {\"strip_suffix\": \"\", \"length_tag\": \"\", \"rename\": \"\", \"zero_cap\": false}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "4.9+galaxy1",
                "type": "tool",
                "uuid": "33fa2759-9f3f-431b-b35c-b5c777d5d5b7",
                "when": null,
                "workflow_outputs": []
            },
            "5": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.3+galaxy1",
                "errors": null,
                "id": 5,
                "input_connections": {
                    "library|input_1": {
                        "id": 4,
                        "output_name": "out_pairs"
                    },
                    "reference_genome|index": {
                        "id": 1,
                        "output_name": "output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool Bowtie2",
                        "name": "library"
                    },
                    {
                        "description": "runtime parameter for tool Bowtie2",
                        "name": "reference_genome"
                    }
                ],
                "label": "Bowtie2 map on reference",
                "name": "Bowtie2",
                "outputs": [
                    {
                        "name": "output",
                        "type": "bam"
                    },
                    {
                        "name": "mapping_stats",
                        "type": "txt"
                    }
                ],
                "position": {
                    "left": 555.13330078125,
                    "top": 395.6499938964844
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    },
                    "RenameDatasetActionmapping_stats": {
                        "action_arguments": {
                            "newname": "mapping stats"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "mapping_stats"
                    },
                    "RenameDatasetActionoutput": {
                        "action_arguments": {
                            "newname": "bowtie2 output (BAM)"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.3+galaxy1",
                "tool_shed_repository": {
                    "changeset_revision": "d5ceb9f3c25b",
                    "name": "bowtie2",
                    "owner": "devteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"analysis_type\": {\"analysis_type_selector\": \"simple\", \"__current_case__\": 0, \"presets\": \"--very-sensitive\"}, \"library\": {\"type\": \"paired_collection\", \"__current_case__\": 2, \"input_1\": {\"__class__\": \"RuntimeValue\"}, \"unaligned_file\": false, \"aligned_file\": false, \"paired_options\": {\"paired_options_selector\": \"yes\", \"__current_case__\": 0, \"I\": \"0\", \"X\": \"1000\", \"fr_rf_ff\": \"--fr\", \"no_mixed\": false, \"no_discordant\": false, \"dovetail\": true, \"no_contain\": false, \"no_overlap\": false}}, \"reference_genome\": {\"source\": \"indexed\", \"__current_case__\": 0, \"index\": {\"__class__\": \"ConnectedValue\"}}, \"rg\": {\"rg_selector\": \"do_not_set\", \"__current_case__\": 3}, \"sam_options\": {\"sam_options_selector\": \"no\", \"__current_case__\": 1}, \"save_mapping_stats\": true, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "2.5.3+galaxy1",
                "type": "tool",
                "uuid": "c32a3847-f673-487f-af98-8d50999f2d21",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "mapping stats",
                        "output_name": "mapping_stats",
                        "uuid": "0a898754-6a14-4282-9269-02f5d516e49f"
                    }
                ]
            },
            "6": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.5.2+galaxy2",
                "errors": null,
                "id": 6,
                "input_connections": {
                    "input_bam": {
                        "id": 5,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": "filter MAPQ30 concordant pairs and not mitochondrial pairs",
                "name": "Filter BAM",
                "outputs": [
                    {
                        "name": "out_file2",
                        "type": "txt"
                    },
                    {
                        "name": "out_file1",
                        "type": "bam"
                    }
                ],
                "position": {
                    "left": 826.183349609375,
                    "top": 318.58331298828125
                },
                "post_job_actions": {
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    },
                    "HideDatasetActionout_file2": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file2"
                    },
                    "RenameDatasetActionout_file1": {
                        "action_arguments": {
                            "newname": "filtered BAM"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.5.2+galaxy2",
                "tool_shed_repository": {
                    "changeset_revision": "993b19f20c76",
                    "name": "bamtools_filter",
                    "owner": "devteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"conditions\": [{\"__index__\": 0, \"filters\": [{\"__index__\": 0, \"bam_property\": {\"bam_property_selector\": \"mapQuality\", \"__current_case__\": 14, \"bam_property_value\": \">=30\"}}, {\"__index__\": 1, \"bam_property\": {\"bam_property_selector\": \"isProperPair\", \"__current_case__\": 11, \"bam_property_value\": true}}, {\"__index__\": 2, \"bam_property\": {\"bam_property_selector\": \"reference\", \"__current_case__\": 20, \"bam_property_value\": \"!chrM\"}}, {\"__index__\": 3, \"bam_property\": {\"bam_property_selector\": \"mateReference\", \"__current_case__\": 16, \"bam_property_value\": \"!MT\"}}]}], \"input_bam\": {\"__class__\": \"ConnectedValue\"}, \"rule_configuration\": {\"rules_selector\": \"true\", \"__current_case__\": 1, \"rules\": null}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "2.5.2+galaxy2",
                "type": "tool",
                "uuid": "eba4c413-30c9-4bab-a088-dc12d5956c91",
                "when": null,
                "workflow_outputs": []
            },
            "7": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.5",
                "errors": null,
                "id": 7,
                "input_connections": {
                    "input": {
                        "id": 5,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": "Get number of reads per chromosome",
                "name": "Samtools idxstats",
                "outputs": [
                    {
                        "name": "output",
                        "type": "tabular"
                    }
                ],
                "position": {
                    "left": 945.2166748046875,
                    "top": 539.63330078125
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.5",
                "tool_shed_repository": {
                    "changeset_revision": "fa5d3e61e429",
                    "name": "samtools_idxstats",
                    "owner": "devteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "2.0.5",
                "type": "tool",
                "uuid": "024f7338-2712-4fb1-a913-dfd5bc2d4f1e",
                "when": null,
                "workflow_outputs": []
            },
            "8": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/3.1.1.0",
                "errors": null,
                "id": 8,
                "input_connections": {
                    "inputFile": {
                        "id": 6,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": "remove PCR duplicates",
                "name": "MarkDuplicates",
                "outputs": [
                    {
                        "name": "metrics_file",
                        "type": "txt"
                    },
                    {
                        "name": "outFile",
                        "type": "bam"
                    }
                ],
                "position": {
                    "left": 1163.1000061035156,
                    "top": 211.4666748046875
                },
                "post_job_actions": {
                    "RenameDatasetActionmetrics_file": {
                        "action_arguments": {
                            "newname": "MarkDuplicates metrics"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "metrics_file"
                    },
                    "RenameDatasetActionoutFile": {
                        "action_arguments": {
                            "newname": "BAM filtered rmDup"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "outFile"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/3.1.1.0",
                "tool_shed_repository": {
                    "changeset_revision": "3f254c5ced1d",
                    "name": "picard",
                    "owner": "devteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"assume_sorted\": true, \"barcode_tag\": \"\", \"comments\": [], \"duplicate_scoring_strategy\": \"SUM_OF_BASE_QUALITIES\", \"inputFile\": {\"__class__\": \"ConnectedValue\"}, \"optical_duplicate_pixel_distance\": \"100\", \"read_name_regex\": \"\", \"remove_duplicates\": true, \"validation_stringency\": \"LENIENT\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "3.1.1.0",
                "type": "tool",
                "uuid": "d0a9998c-18a9-4579-8d33-f0897e1ceaeb",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "MarkDuplicates metrics",
                        "output_name": "metrics_file",
                        "uuid": "144745aa-8898-45e6-a328-53e2518202b9"
                    },
                    {
                        "label": "BAM filtered rmDup",
                        "output_name": "outFile",
                        "uuid": "5f4d5cc5-c2f2-40f3-b941-df5dd7347d25"
                    }
                ]
            },
            "9": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/9.3+galaxy1",
                "errors": null,
                "id": 9,
                "input_connections": {
                    "infile": {
                        "id": 7,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": "reads in chrM/MT for multiQC",
                "name": "Text reformatting",
                "outputs": [
                    {
                        "name": "outfile",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 1190.1499938964844,
                    "top": 618.5833129882812
                },
                "post_job_actions": {
                    "HideDatasetActionoutfile": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "outfile"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/9.3+galaxy1",
                "tool_shed_repository": {
                    "changeset_revision": "86755160afbf",
                    "name": "text_processing",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"code\": \" ($1==\\\"chrM\\\" || $1 == \\\"MT\\\"){print $1, $3}($1!=\\\"chrM\\\" && $1!=\\\"MT\\\"){SUM+=$3}END{print \\\"others\\\", SUM} \", \"infile\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "9.3+galaxy1",
                "type": "tool",
                "uuid": "9ae38aa6-511d-4ab4-b055-7a1dae65649f",
                "when": null,
                "workflow_outputs": []
            },
            "10": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_bamtobed/2.31.1+galaxy0",
                "errors": null,
                "id": 10,
                "input_connections": {
                    "input": {
                        "id": 8,
                        "output_name": "outFile"
                    }
                },
                "inputs": [],
                "label": "convert BAM to BED to improve peak calling",
                "name": "bedtools BAM to BED",
                "outputs": [
                    {
                        "name": "output",
                        "type": "bed"
                    }
                ],
                "position": {
                    "left": 1458.7166595458984,
                    "top": 193.58331298828125
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    },
                    "RenameDatasetActionoutput": {
                        "action_arguments": {
                            "newname": "BED filtered rmDup"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_bamtobed/2.31.1+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "64e2edfe7a2c",
                    "name": "bedtools",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"__job_resource\": {\"__current_case__\": 0, \"__job_resource__select\": \"no\"}, \"ed_score\": false, \"input\": {\"__class__\": \"ConnectedValue\"}, \"option\": \"\", \"split\": false, \"tag\": \"\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "2.31.1+galaxy0",
                "type": "tool",
                "uuid": "12ca18f2-222b-4e9c-8ae0-b5772cd51bd7",
                "when": null,
                "workflow_outputs": []
            },
            "11": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/pe_histogram/pe_histogram/1.0.1",
                "errors": null,
                "id": 11,
                "input_connections": {
                    "input_bam": {
                        "id": 8,
                        "output_name": "outFile"
                    }
                },
                "inputs": [],
                "label": "Compute fragment length histogram",
                "name": "Paired-end histogram",
                "outputs": [
                    {
                        "name": "output1",
                        "type": "png"
                    },
                    {
                        "name": "output2",
                        "type": "tabular"
                    }
                ],
                "position": {
                    "left": 1478.1666717529297,
                    "top": 559.88330078125
                },
                "post_job_actions": {
                    "HideDatasetActionoutput2": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output2"
                    },
                    "RenameDatasetActionoutput1": {
                        "action_arguments": {
                            "newname": "histogram of fragment length"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output1"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/pe_histogram/pe_histogram/1.0.1",
                "tool_shed_repository": {
                    "changeset_revision": "bd1416eea1f0",
                    "name": "pe_histogram",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"input_bam\": {\"__class__\": \"ConnectedValue\"}, \"lower_limit\": null, \"upper_limit\": \"500\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "1.0.1",
                "type": "tool",
                "uuid": "cc486ad2-0f48-4636-98b5-ea5fad9b75b3",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "histogram of fragment length",
                        "output_name": "output1",
                        "uuid": "06437eef-c6fa-49f1-81fb-c48a21b87f57"
                    }
                ]
            },
            "12": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.20+galaxy3",
                "errors": null,
                "id": 12,
                "input_connections": {
                    "input": {
                        "id": 8,
                        "output_name": "outFile"
                    }
                },
                "inputs": [],
                "label": "number of reads",
                "name": "Samtools view",
                "outputs": [
                    {
                        "name": "outputcnt",
                        "type": "tabular"
                    }
                ],
                "position": {
                    "left": 1960.1157004761121,
                    "top": 545.8157628477595
                },
                "post_job_actions": {
                    "HideDatasetActionoutputcnt": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "outputcnt"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.20+galaxy3",
                "tool_shed_repository": {
                    "changeset_revision": "32dc5f781059",
                    "name": "samtools_view",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"addref_cond\": {\"addref_select\": \"no\", \"__current_case__\": 0}, \"input\": {\"__class__\": \"ConnectedValue\"}, \"mode\": {\"outtype\": \"all_reads\", \"__current_case__\": 0, \"output_options\": {\"reads_report_type\": \"count\", \"__current_case__\": 1}}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "1.20+galaxy3",
                "type": "tool",
                "uuid": "2999f836-c74f-47ed-b1ad-81f43349fe11",
                "when": null,
                "workflow_outputs": []
            },
            "13": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.2.9.1+galaxy0",
                "errors": null,
                "id": 13,
                "input_connections": {
                    "effective_genome_size_options|gsize": {
                        "id": 2,
                        "output_name": "output"
                    },
                    "treatment|input_treatment_file": {
                        "id": 10,
                        "output_name": "output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool MACS2 callpeak",
                        "name": "effective_genome_size_options"
                    },
                    {
                        "description": "runtime parameter for tool MACS2 callpeak",
                        "name": "treatment"
                    }
                ],
                "label": "Call Peak with MACS2",
                "name": "MACS2 callpeak",
                "outputs": [
                    {
                        "name": "output_tabular",
                        "type": "tabular"
                    },
                    {
                        "name": "output_narrowpeaks",
                        "type": "bed"
                    },
                    {
                        "name": "output_summits",
                        "type": "bed"
                    },
                    {
                        "name": "output_treat_pileup",
                        "type": "bedgraph"
                    },
                    {
                        "name": "output_control_lambda",
                        "type": "bedgraph"
                    },
                    {
                        "name": "output_extra_files",
                        "type": "html"
                    }
                ],
                "position": {
                    "left": 1741.2333374023438,
                    "top": 0
                },
                "post_job_actions": {
                    "HideDatasetActionoutput_control_lambda": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output_control_lambda"
                    },
                    "HideDatasetActionoutput_extra_files": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output_extra_files"
                    },
                    "HideDatasetActionoutput_summits": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output_summits"
                    },
                    "HideDatasetActionoutput_tabular": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output_tabular"
                    },
                    "HideDatasetActionoutput_treat_pileup": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output_treat_pileup"
                    },
                    "RenameDatasetActionoutput_control_lambda": {
                        "action_arguments": {
                            "newname": "MACS2 control coverage"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output_control_lambda"
                    },
                    "RenameDatasetActionoutput_narrowpeaks": {
                        "action_arguments": {
                            "newname": "MACS2 narrowPeak"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output_narrowpeaks"
                    },
                    "RenameDatasetActionoutput_summits": {
                        "action_arguments": {
                            "newname": "MACS2 summits"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output_summits"
                    },
                    "RenameDatasetActionoutput_tabular": {
                        "action_arguments": {
                            "newname": "MACS2 peaks xls"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output_tabular"
                    },
                    "RenameDatasetActionoutput_treat_pileup": {
                        "action_arguments": {
                            "newname": "MACS2 treatment coverage"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output_treat_pileup"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.2.9.1+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "86e2413cf3f8",
                    "name": "macs2",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"advanced_options\": {\"to_large\": false, \"nolambda\": false, \"spmr\": false, \"ratio\": null, \"slocal\": null, \"llocal\": null, \"broad_options\": {\"broad_options_selector\": \"nobroad\", \"__current_case__\": 1, \"call_summits\": true}, \"keep_dup_options\": {\"keep_dup_options_selector\": \"all\", \"__current_case__\": 2}, \"d_min\": \"20\", \"buffer_size\": \"100000\"}, \"control\": {\"c_select\": \"No\", \"__current_case__\": 1}, \"cutoff_options\": {\"cutoff_options_selector\": \"qvalue\", \"__current_case__\": 1, \"qvalue\": \"0.05\"}, \"effective_genome_size_options\": {\"effective_genome_size_options_selector\": \"user_defined\", \"__current_case__\": 4, \"gsize\": {\"__class__\": \"ConnectedValue\"}}, \"format\": \"BED\", \"nomodel_type\": {\"nomodel_type_selector\": \"nomodel\", \"__current_case__\": 1, \"extsize\": \"200\", \"shift\": \"-100\"}, \"outputs\": [\"peaks_tabular\", \"summits\", \"bdg\", \"html\"], \"treatment\": {\"t_multi_select\": \"No\", \"__current_case__\": 0, \"input_treatment_file\": {\"__class__\": \"ConnectedValue\"}}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "2.2.9.1+galaxy0",
                "type": "tool",
                "uuid": "57386f5d-96bb-4684-97dc-3b2228189c01",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "MACS2 narrowPeak",
                        "output_name": "output_narrowpeaks",
                        "uuid": "02d92607-381e-41b0-b0ed-b0f89bc02967"
                    }
                ]
            },
            "14": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/9.3+galaxy1",
                "errors": null,
                "id": 14,
                "input_connections": {
                    "infile": {
                        "id": 11,
                        "output_name": "output2"
                    }
                },
                "inputs": [],
                "label": "remove comments lines",
                "name": "Search in textfiles",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 1780,
                    "top": 701.4833374023438
                },
                "post_job_actions": {},
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/9.3+galaxy1",
                "tool_shed_repository": {
                    "changeset_revision": "86755160afbf",
                    "name": "text_processing",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"case_sensitive\": \"-i\", \"color\": \"NOCOLOR\", \"infile\": {\"__class__\": \"ConnectedValue\"}, \"invert\": \"-v\", \"lines_after\": \"0\", \"lines_before\": \"0\", \"regex_type\": \"-P\", \"url_paste\": \"^#\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "9.3+galaxy1",
                "type": "tool",
                "uuid": "c06960f8-9d4e-483e-8f07-12976f8b802a",
                "when": null,
                "workflow_outputs": []
            },
            "15": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.1",
                "errors": null,
                "id": 15,
                "input_connections": {
                    "input": {
                        "id": 12,
                        "output_name": "outputcnt"
                    }
                },
                "inputs": [],
                "label": "compute 1/million reads",
                "name": "Compute",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 1681.741700059967,
                    "top": 1407.1751610966817
                },
                "post_job_actions": {
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.1",
                "tool_shed_repository": {
                    "changeset_revision": "aff5135563c6",
                    "name": "column_maker",
                    "owner": "devteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"avoid_scientific_notation\": true, \"error_handling\": {\"auto_col_types\": true, \"fail_on_non_existent_columns\": true, \"non_computable\": {\"action\": \"--fail-on-non-computable\", \"__current_case__\": 0}}, \"input\": {\"__class__\": \"ConnectedValue\"}, \"ops\": {\"header_lines_select\": \"no\", \"__current_case__\": 0, \"expressions\": [{\"__index__\": 0, \"cond\": \"1000000/c1\", \"add_column\": {\"mode\": \"R\", \"__current_case__\": 2, \"pos\": \"1\"}}]}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "2.1",
                "type": "tool",
                "uuid": "ec62cddf-fb04-4185-b9f4-709de2ce0202",
                "when": null,
                "workflow_outputs": []
            },
            "16": {
                "annotation": "",
                "content_id": "wig_to_bigWig",
                "errors": null,
                "id": 16,
                "input_connections": {
                    "input1": {
                        "id": 13,
                        "output_name": "output_treat_pileup"
                    }
                },
                "inputs": [],
                "label": "Bigwig from MACS2 (no norm)",
                "name": "Wig/BedGraph-to-bigWig",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "bigwig"
                    }
                ],
                "position": {
                    "left": 1444.2833251953125,
                    "top": 1510.0499877929688
                },
                "post_job_actions": {
                    "RenameDatasetActionout_file1": {
                        "action_arguments": {
                            "newname": "Coverage from MACS2 (bigwig)"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "wig_to_bigWig",
                "tool_state": "{\"input1\": {\"__class__\": \"ConnectedValue\"}, \"settings\": {\"settingsType\": \"preset\", \"__current_case__\": 0}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "1.1.1",
                "type": "tool",
                "uuid": "4eea632c-ec31-43e7-88d2-79895b764a06",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "Coverage from MACS2 (bigwig)",
                        "output_name": "out_file1",
                        "uuid": "5ffc5c02-8669-49b2-82a1-682ec3122d39"
                    }
                ]
            },
            "17": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_slopbed/2.31.1+galaxy0",
                "errors": null,
                "id": 17,
                "input_connections": {
                    "genome_file_opts|genome": {
                        "id": 1,
                        "output_name": "output"
                    },
                    "inputA": {
                        "id": 13,
                        "output_name": "output_summits"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool bedtools SlopBed",
                        "name": "genome_file_opts"
                    }
                ],
                "label": "get summits +/-500kb",
                "name": "bedtools SlopBed",
                "outputs": [
                    {
                        "name": "output",
                        "type": "bed"
                    }
                ],
                "position": {
                    "left": 2186.5,
                    "top": 206.29998779296875
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    },
                    "RenameDatasetActionoutput": {
                        "action_arguments": {
                            "newname": "1kb around each summit"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_slopbed/2.31.1+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "64e2edfe7a2c",
                    "name": "bedtools",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"addition\": {\"addition_select\": \"b\", \"__current_case__\": 0, \"b\": \"500\"}, \"genome_file_opts\": {\"genome_file_opts_selector\": \"loc\", \"__current_case__\": 0, \"genome\": {\"__class__\": \"ConnectedValue\"}}, \"header\": false, \"inputA\": {\"__class__\": \"ConnectedValue\"}, \"pct\": false, \"strand\": false, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "2.31.1+galaxy0",
                "type": "tool",
                "uuid": "d1c672ca-ee55-4e48-9d97-75552050534a",
                "when": null,
                "workflow_outputs": []
            },
            "18": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/9.3+galaxy1",
                "errors": null,
                "id": 18,
                "input_connections": {
                    "infile": {
                        "id": 13,
                        "output_name": "output_tabular"
                    }
                },
                "inputs": [],
                "label": "summary of MACS2",
                "name": "Search in textfiles",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 2198.433349609375,
                    "top": 79.64999389648438
                },
                "post_job_actions": {
                    "ChangeDatatypeActionoutput": {
                        "action_arguments": {
                            "newtype": "txt"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "output"
                    },
                    "RenameDatasetActionoutput": {
                        "action_arguments": {
                            "newname": "MACS2 report"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/9.3+galaxy1",
                "tool_shed_repository": {
                    "changeset_revision": "86755160afbf",
                    "name": "text_processing",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"case_sensitive\": \"-i\", \"color\": \"NOCOLOR\", \"infile\": {\"__class__\": \"ConnectedValue\"}, \"invert\": \"\", \"lines_after\": \"0\", \"lines_before\": \"0\", \"regex_type\": \"-P\", \"url_paste\": \"^#\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "9.3+galaxy1",
                "type": "tool",
                "uuid": "a12ee458-2fe0-4d1e-8df9-c8fc76d7b277",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "MACS2 report",
                        "output_name": "output",
                        "uuid": "2c50d266-785f-4a9d-ba31-f9fe66b703c7"
                    }
                ]
            },
            "19": {
                "annotation": "",
                "content_id": "param_value_from_file",
                "errors": null,
                "id": 19,
                "input_connections": {
                    "input1": {
                        "id": 15,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": "Convert 1/million reads to parameter",
                "name": "Parse parameter value",
                "outputs": [
                    {
                        "name": "text_param",
                        "type": "expression.json"
                    }
                ],
                "position": {
                    "left": 1927.9064759856594,
                    "top": 1388.3825581400483
                },
                "post_job_actions": {
                    "HideDatasetActiontext_param": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "text_param"
                    }
                },
                "tool_id": "param_value_from_file",
                "tool_state": "{\"input1\": {\"__class__\": \"ConnectedValue\"}, \"param_type\": \"text\", \"remove_newlines\": true, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "0.1.0",
                "type": "tool",
                "uuid": "7afe5b18-2555-4f24-a1e2-348341631008",
                "when": null,
                "workflow_outputs": []
            },
            "20": {
                "annotation": "",
                "content_id": "__APPLY_RULES__",
                "errors": null,
                "id": 20,
                "input_connections": {
                    "input": {
                        "id": 16,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": "Isolate each bigwig do normalize not average",
                "name": "Apply rules",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 2134.4445922218906,
                    "top": 1595.328936224611
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__APPLY_RULES__",
                "tool_state": "{\"input\": {\"__class__\": \"ConnectedValue\"}, \"rules\": {\"mapping\": [{\"collapsible_value\": {\"__class__\": \"RuntimeValue\"}, \"columns\": [0, 1], \"connectable\": true, \"editing\": false, \"is_workflow\": false, \"type\": \"list_identifiers\"}], \"rules\": [{\"collapsible_value\": {\"__class__\": \"RuntimeValue\"}, \"connectable\": true, \"error\": null, \"is_workflow\": false, \"type\": \"add_column_metadata\", \"value\": \"identifier0\", \"warn\": null}, {\"collapsible_value\": {\"__class__\": \"RuntimeValue\"}, \"connectable\": true, \"error\": null, \"is_workflow\": false, \"type\": \"add_column_metadata\", \"value\": \"identifier0\", \"warn\": null}]}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "1.1.0",
                "type": "tool",
                "uuid": "05ca058f-88e4-4e7c-9e93-66e25043883d",
                "when": null,
                "workflow_outputs": []
            },
            "21": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_mergebed/2.31.1",
                "errors": null,
                "id": 21,
                "input_connections": {
                    "input": {
                        "id": 17,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": "Merge summits +/-500kb",
                "name": "bedtools MergeBED",
                "outputs": [
                    {
                        "name": "output",
                        "type": "bed"
                    }
                ],
                "position": {
                    "left": 2501.5999755859375,
                    "top": 273.75
                },
                "post_job_actions": {
                    "RenameDatasetActionoutput": {
                        "action_arguments": {
                            "newname": "Summits +-500bp (merged)"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_mergebed/2.31.1",
                "tool_shed_repository": {
                    "changeset_revision": "64e2edfe7a2c",
                    "name": "bedtools",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"c_and_o_argument_repeat\": [], \"distance\": \"0\", \"header\": false, \"input\": {\"__class__\": \"ConnectedValue\"}, \"strand\": \"\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "2.31.1",
                "type": "tool",
                "uuid": "a74b6905-51b8-4c39-bc8c-3267b1f0a7a5",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "1kb around summits",
                        "output_name": "output",
                        "uuid": "94021253-18e5-4969-9dec-ec901bcc9a3b"
                    }
                ]
            },
            "22": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bigwig_average/deeptools_bigwig_average/3.5.4+galaxy0",
                "errors": null,
                "id": 22,
                "input_connections": {
                    "advancedOpt|binSize": {
                        "id": 3,
                        "output_name": "output"
                    },
                    "advancedOpt|scaleFactors": {
                        "id": 19,
                        "output_name": "text_param"
                    },
                    "bigwigs": {
                        "id": 20,
                        "output_name": "output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool bigwigAverage",
                        "name": "advancedOpt"
                    },
                    {
                        "description": "runtime parameter for tool bigwigAverage",
                        "name": "advancedOpt"
                    },
                    {
                        "description": "runtime parameter for tool bigwigAverage",
                        "name": "advancedOpt"
                    }
                ],
                "label": "normalize by million reads",
                "name": "bigwigAverage",
                "outputs": [
                    {
                        "name": "outFileName",
                        "type": "bigwig"
                    }
                ],
                "position": {
                    "left": 2394.696221186954,
                    "top": 1367.5056983565069
                },
                "post_job_actions": {
                    "RenameDatasetActionoutFileName": {
                        "action_arguments": {
                            "newname": "bigwig normalized per million reads"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "outFileName"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bigwig_average/deeptools_bigwig_average/3.5.4+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "4a53856a5b85",
                    "name": "deeptools_bigwig_average",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"advancedOpt\": {\"showAdvancedOpt\": \"yes\", \"__current_case__\": 1, \"binSize\": {\"__class__\": \"ConnectedValue\"}, \"skipNAs\": false, \"scaleFactors\": {\"__class__\": \"ConnectedValue\"}, \"blackListFileName\": {\"__class__\": \"RuntimeValue\"}}, \"bigwigs\": {\"__class__\": \"ConnectedValue\"}, \"outFileFormat\": \"bigwig\", \"region\": \"\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "3.5.4+galaxy0",
                "type": "tool",
                "uuid": "fa2633cf-af38-43eb-8c9f-b8b656d6a631",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "bigwig_norm",
                        "output_name": "outFileName",
                        "uuid": "42fb26ba-7428-43cf-8668-e865b67c12bc"
                    }
                ]
            },
            "23": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_coveragebed/2.31.1+galaxy0",
                "errors": null,
                "id": 23,
                "input_connections": {
                    "inputA": {
                        "id": 21,
                        "output_name": "output"
                    },
                    "reduce_or_iterate|inputB": {
                        "id": 8,
                        "output_name": "outFile"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool bedtools Compute both the depth and breadth of coverage",
                        "name": "reduce_or_iterate"
                    }
                ],
                "label": "Compute coverage on summits +/-500kb",
                "name": "bedtools Compute both the depth and breadth of coverage",
                "outputs": [
                    {
                        "name": "output",
                        "type": "bed"
                    }
                ],
                "position": {
                    "left": 2734.11669921875,
                    "top": 534.88330078125
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    },
                    "RenameDatasetActionoutput": {
                        "action_arguments": {
                            "newname": "coverage on MACS2 peaks"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_coveragebed/2.31.1+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "64e2edfe7a2c",
                    "name": "bedtools",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"a_or_b\": false, \"d\": false, \"hist\": false, \"inputA\": {\"__class__\": \"ConnectedValue\"}, \"mean\": false, \"overlap_a\": null, \"overlap_b\": null, \"reciprocal_overlap\": false, \"reduce_or_iterate\": {\"reduce_or_iterate_selector\": \"iterate\", \"__current_case__\": 0, \"inputB\": {\"__class__\": \"ConnectedValue\"}}, \"sorted\": false, \"split\": false, \"strandedness\": false, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "2.31.1+galaxy0",
                "type": "tool",
                "uuid": "f3681ac7-e1ba-4442-971f-8353389c5265",
                "when": null,
                "workflow_outputs": []
            },
            "24": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/9.3+galaxy1",
                "errors": null,
                "id": 24,
                "input_connections": {
                    "infile": {
                        "id": 23,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": "number of reads in peaks",
                "name": "Text reformatting",
                "outputs": [
                    {
                        "name": "outfile",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 3097.2166748046875,
                    "top": 460.11669921875
                },
                "post_job_actions": {
                    "ChangeDatatypeActionoutfile": {
                        "action_arguments": {
                            "newtype": "tabular"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "outfile"
                    },
                    "RenameDatasetActionoutfile": {
                        "action_arguments": {
                            "newname": "Nb of reads in summits +-500bp"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "outfile"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/9.3+galaxy1",
                "tool_shed_repository": {
                    "changeset_revision": "86755160afbf",
                    "name": "text_processing",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"code\": \"{S=S+$4}END{print S}\", \"infile\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "9.3+galaxy1",
                "type": "tool",
                "uuid": "f65b3936-595c-4ddb-88bc-2cc41e514e38",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "Nb of reads in summits +-500bp",
                        "output_name": "outfile",
                        "uuid": "ba96198b-0b36-4b3c-a7bf-664d765eff3a"
                    }
                ]
            },
            "25": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.1",
                "errors": null,
                "id": 25,
                "input_connections": {
                    "input": {
                        "id": 24,
                        "output_name": "outfile"
                    }
                },
                "inputs": [],
                "label": "compute 1/million reads in peaks",
                "name": "Compute",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 1660.7476485833522,
                    "top": 1675.7739064754614
                },
                "post_job_actions": {
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.1",
                "tool_shed_repository": {
                    "changeset_revision": "aff5135563c6",
                    "name": "column_maker",
                    "owner": "devteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"avoid_scientific_notation\": true, \"error_handling\": {\"auto_col_types\": true, \"fail_on_non_existent_columns\": true, \"non_computable\": {\"action\": \"--fail-on-non-computable\", \"__current_case__\": 0}}, \"input\": {\"__class__\": \"ConnectedValue\"}, \"ops\": {\"header_lines_select\": \"no\", \"__current_case__\": 0, \"expressions\": [{\"__index__\": 0, \"cond\": \"1000000/c1\", \"add_column\": {\"mode\": \"R\", \"__current_case__\": 2, \"pos\": \"1\"}}]}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "2.1",
                "type": "tool",
                "uuid": "5f55e258-a4fe-4b51-ab9b-2a6f0f22d910",
                "when": null,
                "workflow_outputs": []
            },
            "26": {
                "annotation": "",
                "content_id": "cat1",
                "errors": null,
                "id": 26,
                "input_connections": {
                    "input1": {
                        "id": 24,
                        "output_name": "outfile"
                    },
                    "queries_0|input2": {
                        "id": 12,
                        "output_name": "outputcnt"
                    }
                },
                "inputs": [],
                "label": "Combine number of reads in peaks with total number of reads",
                "name": "Concatenate datasets",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 3026.25,
                    "top": 727.7666625976562
                },
                "post_job_actions": {
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "cat1",
                "tool_state": "{\"input1\": {\"__class__\": \"ConnectedValue\"}, \"queries\": [{\"__index__\": 0, \"input2\": {\"__class__\": \"ConnectedValue\"}}], \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "1.0.0",
                "type": "tool",
                "uuid": "ae286273-3247-4a8f-b296-33a679fbaf7d",
                "when": null,
                "workflow_outputs": []
            },
            "27": {
                "annotation": "",
                "content_id": "param_value_from_file",
                "errors": null,
                "id": 27,
                "input_connections": {
                    "input1": {
                        "id": 25,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": "Convert 1/million reads in peaks to parameter",
                "name": "Parse parameter value",
                "outputs": [
                    {
                        "name": "text_param",
                        "type": "expression.json"
                    }
                ],
                "position": {
                    "left": 1922.9030306495047,
                    "top": 1685.3491762772487
                },
                "post_job_actions": {
                    "HideDatasetActiontext_param": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "text_param"
                    }
                },
                "tool_id": "param_value_from_file",
                "tool_state": "{\"input1\": {\"__class__\": \"ConnectedValue\"}, \"param_type\": \"text\", \"remove_newlines\": true, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "0.1.0",
                "type": "tool",
                "uuid": "f0eb1323-041b-4e29-9f07-de15427c267d",
                "when": null,
                "workflow_outputs": []
            },
            "28": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/9.3+galaxy1",
                "errors": null,
                "id": 28,
                "input_connections": {
                    "infile": {
                        "id": 26,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": "reads in peaks multiQC",
                "name": "Text reformatting",
                "outputs": [
                    {
                        "name": "outfile",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 2870.2166748046875,
                    "top": 944.800048828125
                },
                "post_job_actions": {
                    "HideDatasetActionoutfile": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "outfile"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/9.3+galaxy1",
                "tool_shed_repository": {
                    "changeset_revision": "86755160afbf",
                    "name": "text_processing",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"code\": \" NR==1{print \\\"in peaks\\\",$1;inp=$1}NR==2{print \\\"outside peaks\\\",$1 - inp}\", \"infile\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "9.3+galaxy1",
                "type": "tool",
                "uuid": "7fe2bb35-31b5-4da0-83cf-38bb4af2848e",
                "when": null,
                "workflow_outputs": []
            },
            "29": {
                "annotation": "Isolate each bigwig do normalize not average",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bigwig_average/deeptools_bigwig_average/3.5.4+galaxy0",
                "errors": null,
                "id": 29,
                "input_connections": {
                    "advancedOpt|binSize": {
                        "id": 3,
                        "output_name": "output"
                    },
                    "advancedOpt|scaleFactors": {
                        "id": 27,
                        "output_name": "text_param"
                    },
                    "bigwigs": {
                        "id": 20,
                        "output_name": "output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool bigwigAverage",
                        "name": "advancedOpt"
                    },
                    {
                        "description": "runtime parameter for tool bigwigAverage",
                        "name": "advancedOpt"
                    },
                    {
                        "description": "runtime parameter for tool bigwigAverage",
                        "name": "advancedOpt"
                    }
                ],
                "label": "normalize by million reads in peaks",
                "name": "bigwigAverage",
                "outputs": [
                    {
                        "name": "outFileName",
                        "type": "bigwig"
                    }
                ],
                "position": {
                    "left": 2402.456534423419,
                    "top": 1734.6798994525739
                },
                "post_job_actions": {
                    "RenameDatasetActionoutFileName": {
                        "action_arguments": {
                            "newname": "bigwig normalized per million reads in peaks"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "outFileName"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bigwig_average/deeptools_bigwig_average/3.5.4+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "4a53856a5b85",
                    "name": "deeptools_bigwig_average",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"advancedOpt\": {\"showAdvancedOpt\": \"yes\", \"__current_case__\": 1, \"binSize\": {\"__class__\": \"ConnectedValue\"}, \"skipNAs\": false, \"scaleFactors\": {\"__class__\": \"ConnectedValue\"}, \"blackListFileName\": {\"__class__\": \"RuntimeValue\"}}, \"bigwigs\": {\"__class__\": \"ConnectedValue\"}, \"outFileFormat\": \"bigwig\", \"region\": \"\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "3.5.4+galaxy0",
                "type": "tool",
                "uuid": "8eab7f49-605b-462a-9806-da0c795117f3",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "bigwig_norm2",
                        "output_name": "outFileName",
                        "uuid": "60031333-7419-4121-a0c7-e235b70a5cfc"
                    }
                ]
            },
            "30": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.24.1+galaxy0",
                "errors": null,
                "id": 30,
                "input_connections": {
                    "results_0|software_cond|input": {
                        "id": 4,
                        "output_name": "report"
                    },
                    "results_1|software_cond|input": {
                        "id": 5,
                        "output_name": "mapping_stats"
                    },
                    "results_2|software_cond|input": {
                        "id": 9,
                        "output_name": "outfile"
                    },
                    "results_3|software_cond|output_0|input": {
                        "id": 8,
                        "output_name": "metrics_file"
                    },
                    "results_4|software_cond|input": {
                        "id": 14,
                        "output_name": "output"
                    },
                    "results_5|software_cond|input": {
                        "id": 13,
                        "output_name": "output_tabular"
                    },
                    "results_6|software_cond|input": {
                        "id": 28,
                        "output_name": "outfile"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "MultiQC",
                "outputs": [
                    {
                        "name": "plots",
                        "type": "input"
                    },
                    {
                        "name": "html_report",
                        "type": "html"
                    },
                    {
                        "name": "stats",
                        "type": "tabular"
                    }
                ],
                "position": {
                    "left": 2612.75,
                    "top": 1012.6666259765625
                },
                "post_job_actions": {
                    "HideDatasetActionplots": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "plots"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.24.1+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "f7e2f1eb3a16",
                    "name": "multiqc",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"comment\": \"\", \"export\": true, \"flat\": false, \"results\": [{\"__index__\": 0, \"software_cond\": {\"software\": \"cutadapt\", \"__current_case__\": 5, \"input\": {\"__class__\": \"ConnectedValue\"}}}, {\"__index__\": 1, \"software_cond\": {\"software\": \"bowtie2\", \"__current_case__\": 3, \"input\": {\"__class__\": \"ConnectedValue\"}}}, {\"__index__\": 2, \"software_cond\": {\"software\": \"custom_content\", \"__current_case__\": 32, \"plot_type\": \"bargraph\", \"section_name\": \"chrM\", \"title\": \"reads mapping on chrM\", \"description\": \"\", \"xlab\": \"\", \"ylab\": \"\", \"input\": {\"__class__\": \"ConnectedValue\"}}}, {\"__index__\": 3, \"software_cond\": {\"software\": \"picard\", \"__current_case__\": 17, \"output\": [{\"__index__\": 0, \"type\": \"markdups\", \"input\": {\"__class__\": \"ConnectedValue\"}}]}}, {\"__index__\": 4, \"software_cond\": {\"software\": \"custom_content\", \"__current_case__\": 32, \"plot_type\": \"linegraph\", \"section_name\": \"Fragment size\", \"title\": \"Fragment size distribution\", \"description\": \"\", \"xlab\": \"\", \"ylab\": \"\", \"input\": {\"__class__\": \"ConnectedValue\"}}}, {\"__index__\": 5, \"software_cond\": {\"software\": \"macs2\", \"__current_case__\": 16, \"input\": {\"__class__\": \"ConnectedValue\"}}}, {\"__index__\": 6, \"software_cond\": {\"software\": \"custom_content\", \"__current_case__\": 32, \"plot_type\": \"bargraph\", \"section_name\": \"Reads in peaks\", \"title\": \"Number of reads in peaks\", \"description\": \"Number of reads falling 500bp from a summit\", \"xlab\": \"\", \"ylab\": \"\", \"input\": {\"__class__\": \"ConnectedValue\"}}}], \"saveLog\": \"false\", \"title\": \"\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "1.24.1+galaxy0",
                "type": "tool",
                "uuid": "112d720f-c747-4c92-985f-ebdb52086cc9",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "MultiQC webpage",
                        "output_name": "html_report",
                        "uuid": "c22aafb2-d9f2-43c3-a6c4-cfe4a3166c07"
                    },
                    {
                        "label": "MultiQC on input dataset(s): Stats",
                        "output_name": "stats",
                        "uuid": "6071150d-48db-4cf8-bfed-2cbdb2635856"
                    }
                ]
            }
        },
        "tags": [
            "ATACseq"
        ],
        "uuid": "747f2432-7493-44b8-a5ee-82d104407cad",
        "version": 1
    },
    "readme": "# ATAC-seq Analysis: Chromatin Accessibility Profiling\n\nThis workflow is highly concordant with the corresponding training material.\nYou can have more information about ATAC-seq analysis in the [slides](https://training.galaxyproject.org/training-material/topics/epigenetics/tutorials/atac-seq/slides.html) and the [tutorial](https://training.galaxyproject.org/training-material/topics/epigenetics/tutorials/atac-seq/tutorial.html).\n\n## Inputs dataset\n\n- The workflow needs a single input which is a list of dataset pairs of fastqsanger.\n\n## Inputs values\n\n- reference_genome: this field will be adapted to the genomes available for bowtie2 and the genomes available for bedtools slopbed (dbkeys table)\n- effective_genome_size: this is used by macs2 and may be entered manually (indications are provided for heavily used genomes)\n- bin_size: this is used when normalization of coverage is performed. Large values will allow to have smaller output files but with less resolution while small values will increase computation time and size of output files to produce more resolutive bigwigs.\n\n## Processing\n\n- The workflow will remove nextera adapters and low quality bases and filter out any read smaller than 15bp.\n- The filtered reads are mapped with bowtie2 allowing dovetail and fragment length up to 1kb.\n- The BAM is filtered to keep only MAPQ30, concordant pairs and pairs outside of the mitochondria.\n- The PCR duplicates are removed with Picard (only from version 0.8).\n- The BAM is converted to BED to enable macs2 to take both pairs into account.\n- The peaks are called with macs2 which at the same time generates a coverage file.\n- The coverage file is converted to bigwig\n- The amount of reads 500bp from summits and the total number of reads are computed.\n- Two normalizations are computed:\n  - By million reads\n  - By million reads in peaks (500bp from summits)\n- Other QC are performed:\n  - A histogram with fragment length is computed.\n  - The evaluation of percentage of reads to chrM or MT is computed.\n- A multiQC is run to have an overview of the QC.\n\n### Warning\n\n- The `reference_genome` parameter value is used to select references in bowtie2 and bedtools slopbed. Only references that are present in bowtie2 **and** bedtools slopbed are selectable. If your favorite reference genome is not available ask your administrator to make sure that each bowtie2 reference has a corresponding len file for use in bedtools slopbed.\n",
    "changelog": "# Changelog\n\n## [1.0] - 2024-11-28\n\n### Manual update\n\nUse the options like written in the README: in all previous versions, bowtie2 was running with `--very-sensitive` option but without allowing dovetail and without fragment length up to 1kb. Bowtie2 has been adjusted and is now running with these options: allow dovetail and fragment length up to 1kb.\n\n## [0.17] - 2024-09-23\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.9+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.9+galaxy1`\n- `toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.15.1+galaxy2` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.20+galaxy3`\n- `toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.0` was updated to `toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.1`\n- `toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy1` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.24.1+galaxy0`\n\n### Manual update\n- Add a step to remove comments lines from histogram to be compatible with new multiQC version\n\n## [0.16] - 2024-07-15\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.8+galaxy1` was updated to `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.9+galaxy0`\n\n## [0.15] - 2024-05-27\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.8+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.8+galaxy1`\n- `toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.3+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.3+galaxy1`\n- `toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_bamtobed/2.30.0+galaxy2` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_bamtobed/2.31.1+galaxy0`\n- `toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_slopbed/2.30.0+galaxy1` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_slopbed/2.31.1+galaxy0`\n- `toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_mergebed/2.30.0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_mergebed/2.31.1`\n- `toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_coveragebed/2.30.0+galaxy1` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_coveragebed/2.31.1+galaxy0`\n\n## [0.14] - 2024-04-22\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.7+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.8+galaxy0`\n\n## [0.13] - 2024-04-08\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/9.3+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/9.3+galaxy1`\n- `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/9.3+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/9.3+galaxy1`\n\n## [0.12] - 2024-03-25\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.6+galaxy1` was updated to `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.7+galaxy0`\n\n## [0.11] - 2024-03-18\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.5.2+galaxy1` was updated to `toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.5.2+galaxy2`\n\n## [0.10] - 2024-03-14\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.4+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.6+galaxy1`\n- `toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.0+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.3+galaxy0`\n- `toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.4` was updated to `toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.5`\n- `toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.4` was updated to `toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/3.1.1.0`\n- `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/1.1.2` was updated to `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/9.3+galaxy0`\n- `toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.15.1+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.15.1+galaxy2`\n- `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/1.1.1` was updated to `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_grep_tool/9.3+galaxy0`\n\n## [0.9] - 2023-10-23\n\nFix the normalization factor. It was coverage per reads and per reads in peaks instead of per million reads and per million reads in peaks.\n\n## [0.8] - 2023-10-19\n\nFix the remove duplicate step!\nIn all previous versions, due to an error, PCR duplicates were not removed.\n\n## [0.7] - 2023-10-17\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.2.7.1+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.2.9.1+galaxy0`\n\n## [0.6] - 2023-09-27\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bigwig_average/deeptools_bigwig_average/3.5.2+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bigwig_average/deeptools_bigwig_average/3.5.4+galaxy0`\n\n## [0.5.1] - 2023-09-22\n\nFix bug in normalize profiles when used with multiple samples (in 0.5.0 it is averaging samples instead of normalizing each sample).\n\n## [0.5] - 2023-03-17\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.3` was updated to `toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.4`\n- `toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_coveragebed/2.30.0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_coveragebed/2.30.0+galaxy1`\n- `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.0+galaxy1` was updated to `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.4+galaxy0`\n\n### Manual update\n- add normalization steps for coverage\n\n## [0.4] - 2023-01-16\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.5.1+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.5.2+galaxy1`\n\n## [0.3] - 2022-12-17\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy1`\n\n## [0.2] - 2022-11-28\n\n### Automatic update\n- `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.0+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/4.0+galaxy1`\n- `toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.4.5+galaxy1` was updated to `toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.0+galaxy0`\n\n## [0.1] - 2022-10-12\nFirst release.\n",
    "diagrams": "# Workflow diagrams\n\n## ATAC-seq Analysis: Chromatin Accessibility Profiling\n\n```mermaid\ngraph LR\n0[\"\u2139\ufe0f PE fastq input\"]@{ shape: docs }\n1[\"\u2139\ufe0f reference_genome\"]@{ shape: lean-l }\n2[\"\u2139\ufe0f effective_genome_size\"]@{ shape: lean-l }\n3[\"\u2139\ufe0f bin_size\"]@{ shape: lean-l }\n4[\"Cutadapt (remove adapter + bad quality bases)\"]@{ shape: process }\n0 --> 4\n5[\"Bowtie2 map on reference\"]@{ shape: process }\n4 --> 5\n1 --> 5\n6[\"filter MAPQ30 concordant pairs and not mitochondrial pairs\"]@{ shape: process }\n5 --> 6\n7[\"Get number of reads per chromosome\"]@{ shape: process }\n5 --> 7\n8[\"remove PCR duplicates\"]@{ shape: process }\n6 --> 8\n9[\"reads in chrM/MT for multiQC\"]@{ shape: process }\n7 --> 9\n10[\"convert BAM to BED to improve peak calling\"]@{ shape: process }\n8 --> 10\n11[\"Compute fragment length histogram\"]@{ shape: process }\n8 --> 11\n12[\"number of reads\"]@{ shape: process }\n8 --> 12\n13[\"Call Peak with MACS2\"]@{ shape: process }\n2 --> 13\n10 --> 13\n14[\"remove comments lines\"]@{ shape: process }\n11 --> 14\n15[\"compute 1/million reads\"]@{ shape: process }\n12 --> 15\n16[\"Bigwig from MACS2 (no norm)\"]@{ shape: process }\n13 --> 16\n17[\"get summits +/-500kb\"]@{ shape: process }\n1 --> 17\n13 --> 17\n18[\"summary of MACS2\"]@{ shape: process }\n13 --> 18\n19[\"Convert 1/million reads to parameter\"]@{ shape: process }\n15 --> 19\n20[\"Isolate each bigwig do normalize not average\"]@{ shape: process }\n16 --> 20\n21[\"Merge summits +/-500kb\"]@{ shape: process }\n17 --> 21\n22[\"normalize by million reads\"]@{ shape: process }\n3 --> 22\n19 --> 22\n20 --> 22\n23[\"Compute coverage on summits +/-500kb\"]@{ shape: process }\n21 --> 23\n8 --> 23\n24[\"number of reads in peaks\"]@{ shape: process }\n23 --> 24\n25[\"compute 1/million reads in peaks\"]@{ shape: process }\n24 --> 25\n26[\"Combine number of reads in peaks with total number of reads\"]@{ shape: process }\n24 --> 26\n12 --> 26\n27[\"Convert 1/million reads in peaks to parameter\"]@{ shape: process }\n25 --> 27\n28[\"reads in peaks multiQC\"]@{ shape: process }\n26 --> 28\n29[\"normalize by million reads in peaks\"]@{ shape: process }\n3 --> 29\n27 --> 29\n20 --> 29\n30[\"MultiQC\"]@{ shape: process }\n4 --> 30\n5 --> 30\n9 --> 30\n8 --> 30\n14 --> 30\n13 --> 30\n28 --> 30\n```\n",
    "updated": "2024-11-28T00:00:00",
    "trsID": "#workflow/github.com/iwc-workflows/atacseq/main",
    "iwcID": "atacseq-main",
    "dockstore_id": 19836,
    "categories": [],
    "collections": [
        "Epigenetics"
    ],
    "doi": "10.5281/zenodo.15078779",
    "tests": [
        {
            "doc": "Test outline for ATACseq",
            "job": {
                "PE fastq input": {
                    "class": "Collection",
                    "collection_type": "list:paired",
                    "elements": [
                        {
                            "class": "Collection",
                            "type": "paired",
                            "identifier": "SRR891268_chr22_enriched",
                            "elements": [
                                {
                                    "identifier": "forward",
                                    "class": "File",
                                    "location": "https://zenodo.org/record/3862793/files/SRR891268_chr22_enriched_R1.fastq.gz",
                                    "filetype": "fastqsanger"
                                },
                                {
                                    "identifier": "reverse",
                                    "class": "File",
                                    "location": "https://zenodo.org/record/3862793/files/SRR891268_chr22_enriched_R2.fastq.gz",
                                    "filetype": "fastqsanger"
                                }
                            ]
                        }
                    ]
                },
                "reference_genome": "hg19",
                "effective_genome_size": 2700000000,
                "bin_size": 1000
            },
            "outputs": {
                "mapping stats": {
                    "element_tests": {
                        "SRR891268_chr22_enriched": {
                            "asserts": [
                                {
                                    "that": "has_text",
                                    "text": "7282 (2.59%) aligned concordantly 0 times"
                                },
                                {
                                    "that": "has_text",
                                    "text": "121059 (43.09%) aligned concordantly exactly 1 time"
                                },
                                {
                                    "that": "has_text",
                                    "text": "152623 (54.32%) aligned concordantly >1 times"
                                }
                            ]
                        }
                    }
                },
                "MarkDuplicates metrics": {
                    "element_tests": {
                        "SRR891268_chr22_enriched": {
                            "asserts": {
                                "has_text": {
                                    "text": "0.02"
                                }
                            }
                        }
                    }
                },
                "BAM filtered rmDup": {
                    "element_tests": {
                        "SRR891268_chr22_enriched": {
                            "asserts": {
                                "has_size": {
                                    "value": 15810403,
                                    "delta": 1000000
                                }
                            }
                        }
                    }
                },
                "histogram of fragment length": {
                    "element_tests": {
                        "SRR891268_chr22_enriched": {
                            "asserts": {
                                "has_size": {
                                    "value": 47718,
                                    "delta": 4000
                                }
                            }
                        }
                    }
                },
                "MACS2 narrowPeak": {
                    "element_tests": {
                        "SRR891268_chr22_enriched": {
                            "asserts": {
                                "has_n_lines": {
                                    "n": 236
                                }
                            }
                        }
                    }
                },
                "MACS2 report": {
                    "element_tests": {
                        "SRR891268_chr22_enriched": {
                            "asserts": [
                                {
                                    "that": "has_text",
                                    "text": "# tag size is determined as 47 bps"
                                },
                                {
                                    "that": "has_text",
                                    "text": "# total tags in treatment: 262080"
                                }
                            ]
                        }
                    }
                },
                "Coverage from MACS2 (bigwig)": {
                    "element_tests": {
                        "SRR891268_chr22_enriched": {
                            "asserts": {
                                "has_size": {
                                    "value": 2892925,
                                    "delta": 200000
                                }
                            }
                        }
                    }
                },
                "1kb around summits": {
                    "element_tests": {
                        "SRR891268_chr22_enriched": {
                            "asserts": {
                                "has_n_lines": {
                                    "n": 217
                                }
                            }
                        }
                    }
                },
                "Nb of reads in summits +-500bp": {
                    "element_tests": {
                        "SRR891268_chr22_enriched": {
                            "asserts": {
                                "has_line": {
                                    "line": "9548"
                                }
                            }
                        }
                    }
                },
                "bigwig_norm": {
                    "element_tests": {
                        "SRR891268_chr22_enriched": {
                            "asserts": {
                                "has_size": {
                                    "value": 1253177,
                                    "delta": 100000
                                }
                            }
                        }
                    }
                },
                "bigwig_norm2": {
                    "element_tests": {
                        "SRR891268_chr22_enriched": {
                            "asserts": {
                                "has_size": {
                                    "value": 1248419,
                                    "delta": 100000
                                }
                            }
                        }
                    }
                },
                "MultiQC on input dataset(s): Stats": {
                    "asserts": {
                        "has_line": {
                            "line": "Sample\tMACS2_mqc_generalstats_macs2_d\tMACS2_mqc_generalstats_macs2_peak_count\tPicard: Mark Duplicates_mqc_generalstats_picard_mark_duplicates_PERCENT_DUPLICATION\tBowtie 2 / HiSAT2_mqc_generalstats_bowtie_2_hisat2_overall_alignment_rate\tCutadapt_mqc_generalstats_cutadapt_percent_trimmed"
                        },
                        "has_text_matching": {
                            "expression": "SRR891268_chr22_enriched\t200.0\t236\t2.7[0-9]*\t98.[0-9]*\t4.7[0-9]*"
                        }
                    }
                },
                "MultiQC webpage": {
                    "asserts": [
                        {
                            "that": "has_text",
                            "text": "<a href=\"#cutadapt_filtered_reads\" class=\"nav-l2\">Filtered Reads</a>"
                        },
                        {
                            "that": "has_text",
                            "text": "<td>% Aligned</td>"
                        },
                        {
                            "that": "has_text",
                            "text": "<td>% BP Trimmed</td>"
                        }
                    ]
                }
            }
        }
    ]
}