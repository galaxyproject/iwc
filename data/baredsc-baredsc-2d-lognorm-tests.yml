- doc: Test outline for baredSC_2d
  job:
    Gene name for x axis: 0.5_0_0_0.5_x
    Gene name for y axis: 0.5_0_0_0.5_y
    Maximum number of Gaussians to study: '4'
    Tabular with raw expression values:
      class: File
      filetype: tabular
      location: https://raw.githubusercontent.com/galaxyproject/iwc/main/workflows/scRNAseq/baredsc/test-data/nih3t3_generated_2d_2.txt
    compute p-value: 'true'
    maximum value in logNorm for x-axis: '2.5'
    maximum value in logNorm for y-axis: '2.5'
  outputs:
    baredsc_neff:
      element_tests:
        split_file_000000.tabular:
          asserts:
            has_line_matching:
              expression: '[1-2]?[0-9][0-9][0-9].[0-9]*'
            has_n_lines:
              n: 1
        split_file_000001.tabular:
          asserts:
            has_line_matching:
              expression: '[1-2]?[0-9][0-9][0-9].[0-9]*'
            has_n_lines:
              n: 1
        split_file_000002.tabular:
          asserts:
            has_line_matching:
              expression: '[1-2]?[0-9][0-9][0-9].[0-9]*'
            has_n_lines:
              n: 1
        split_file_000003.tabular:
          asserts:
            has_line_matching:
              expression: '[1-2]?[0-9][0-9][0-9].[0-9]*'
            has_n_lines:
              n: 1
    baredsc_numpy:
      element_tests:
        split_file_000000.tabular:
          asserts:
            has_size:
              delta: 100000
              value: 1654994
        split_file_000001.tabular:
          asserts:
            has_size:
              delta: 200000
              value: 2650966
        split_file_000002.tabular:
          asserts:
            has_size:
              delta: 3000000
              value: 39060170
        split_file_000003.tabular:
          asserts:
            has_size:
              delta: 5000000
              value: 49913268
    baredsc_qc_plots:
      element_tests:
        split_file_000000.tabular:
          element_tests:
            convergence:
              asserts:
                has_size:
                  delta: 2000
                  value: 24300
            corner:
              asserts:
                has_size:
                  delta: 30000
                  value: 300500
            p:
              asserts:
                has_size:
                  delta: 10000
                  value: 98200
        split_file_000001.tabular:
          element_tests:
            convergence:
              asserts:
                has_size:
                  delta: 2000
                  value: 28600
            corner:
              asserts:
                has_size:
                  delta: 200000
                  value: 2000000
            p:
              asserts:
                has_size:
                  delta: 20000
                  value: 203100
        split_file_000002.tabular:
          element_tests:
            convergence:
              asserts:
                has_size:
                  delta: 3000
                  value: 30200
            corner:
              asserts:
                has_size:
                  delta: 500000
                  value: 5100000
            p:
              asserts:
                has_size:
                  delta: 20000
                  value: 269500
        split_file_000003.tabular:
          element_tests:
            convergence:
              asserts:
                has_size:
                  delta: 3000
                  value: 31500
            corner:
              asserts:
                has_size:
                  delta: 900000
                  value: 9400000
            p:
              asserts:
                has_size:
                  delta: 30000
                  value: 373300
    combined_other_outputs:
      element_tests:
        corr:
          asserts:
            has_n_lines:
              n: 2
            has_text:
              text: "mean\tmedian\tlow\thigh\tpval\terror"
            has_text_matching:
              expression: 0.89[0-9]*
        individuals:
          asserts:
            has_size:
              delta: 5000
              value: 54400
        median:
          asserts:
            has_size:
              delta: 3000
              value: 37100
    combined_pdf2d:
      asserts:
        has_n_lines:
          n: 26
        has_text:
          text: "xy\t0.05\t0.15"
    combined_pdf2d_flat:
      asserts:
        has_line:
          line: "x\ty\tlow\tmean\thigh\tmedian"
        has_n_lines:
          n: 626
        has_text:
          text: "0.05\t0.05"
    combined_plot:
      compare: sim_size
      delta_frac: 0.1
      path: test-data/combined_2d_plot.png
