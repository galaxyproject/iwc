{
    "name": "main",
    "subclass": "Galaxy",
    "publish": true,
    "primaryDescriptorPath": "/influenza-consensus-and-subtyping.ga",
    "testParameterFiles": [
        "/influenza-consensus-and-subtyping-test.yml"
    ],
    "authors": [
        {
            "name": "Viktoria Isabel Schwarz",
            "orcid": "0000-0001-6897-1215"
        },
        {
            "name": "Wolfgang Maier",
            "orcid": "0000-0002-9464-6640"
        },
        {
            "name": "Aaron Kolbecher",
            "orcid": "0009-0000-8844-2812"
        },
        {
            "name": "Saim Momin",
            "orcid": "0009-0003-9935-828X"
        }
    ],
    "definition": {
        "a_galaxy_workflow": "true",
        "annotation": "This workflow performs subtyping and consensus sequence generation for batches of Illumina PE sequenced Influenza A isolates.",
        "comments": [
            {
                "child_steps": [
                    21,
                    23,
                    24,
                    26,
                    28,
                    30
                ],
                "color": "orange",
                "data": {
                    "title": "Generate subtyping report from VAPOR output"
                },
                "id": 3,
                "position": [
                    2242.2,
                    1290.6
                ],
                "size": [
                    1271,
                    463
                ],
                "type": "frame"
            },
            {
                "child_steps": [
                    2,
                    17,
                    18,
                    16,
                    19
                ],
                "color": "blue",
                "data": {
                    "title": "Run VAPOR"
                },
                "id": 1,
                "position": [
                    1335.4,
                    705.2
                ],
                "size": [
                    868,
                    405
                ],
                "type": "frame"
            },
            {
                "child_steps": [
                    13,
                    3,
                    4,
                    6,
                    7,
                    8,
                    9,
                    10,
                    11,
                    12,
                    14,
                    15
                ],
                "color": "lime",
                "data": {
                    "title": "Set up data structure part 1 - prepare inputs for samples x segments VAPOR runs"
                },
                "id": 0,
                "position": [
                    277.9,
                    52.2
                ],
                "size": [
                    995.1,
                    1185.7
                ],
                "type": "frame"
            },
            {
                "child_steps": [
                    52,
                    54,
                    55
                ],
                "color": "turquoise",
                "data": {
                    "title": "Compare samples segment-wise"
                },
                "id": 6,
                "position": [
                    5316.1,
                    0.0
                ],
                "size": [
                    620.9,
                    1213.5
                ],
                "type": "frame"
            },
            {
                "child_steps": [
                    42,
                    44,
                    46,
                    47,
                    40,
                    49,
                    50
                ],
                "color": "red",
                "data": {
                    "title": "Get segments suitable for MSA (at least 2 samples have data for the segment) and tree building (data from at least 3 samples)"
                },
                "id": 5,
                "position": [
                    4052.2,
                    1201.1
                ],
                "size": [
                    981.8,
                    404
                ],
                "type": "frame"
            },
            {
                "child_steps": [
                    29,
                    22,
                    25,
                    27,
                    20
                ],
                "color": "lime",
                "data": {
                    "title": "Compile hybrid reference genome and map reads to it"
                },
                "id": 2,
                "position": [
                    2333.4,
                    169.6
                ],
                "size": [
                    656,
                    1090
                ],
                "type": "frame"
            },
            {
                "child_steps": [
                    31,
                    33,
                    34,
                    35,
                    36,
                    37,
                    38,
                    39,
                    41,
                    43,
                    45,
                    48,
                    32
                ],
                "color": "turquoise",
                "data": {
                    "title": "Build per-sample x per-segment consensus sequences"
                },
                "id": 4,
                "position": [
                    3012,
                    372.70000000000005
                ],
                "size": [
                    1740,
                    707
                ],
                "type": "frame"
            }
        ],
        "creator": [
            {
                "class": "Person",
                "identifier": "https://orcid.org/0000-0002-9464-6640",
                "name": "Wolfgang Maier"
            },
            {
                "class": "Person",
                "identifier": "https://orcid.org/0000-0001-6897-1215",
                "name": "Viktoria Isabel Schwarz"
            },
            {
                "class": "Person",
                "identifier": "https://orcid.org/0009-0000-8844-2812",
                "name": "Aaron Kolbecher"
            },
            {
                "class": "Person",
                "identifier": "https://orcid.org/0009-0003-9935-828X",
                "name": "Saim Momin"
            }
        ],
        "format-version": "0.1",
        "help": "## Input datasets\n\n- **Sequenced paired-end data**: a list of pairs of sequencing datasets, one fw-/rv-reads pair per sequenced isolate\n- **References per segment collection**: this must be provided as a list of FASTA datasets, one for each Influenza genome segment to analyze. Each of these datasets should contain all reference sequences of the corresponding segment that you wish to use in the analysis.\n\n  **NOTE 1**: For subtyping to work correctly *all* FASTA sequence title lines in the input need to follow the scheme (note the use of both `|` and `/`):\n\n  `>[segment]|[influenza type]/[host]/[region]/[internal reference number]/[collection year]|subtype|[accession number]`\n\n  where `[host]` can be omitted for samples obtained from human patients.\n\n  Examples:\n\n  - `>NS|A/California/07/2009|H1N1|NC_026432.1` (for the NS segment sequence of a H1N1 sample obtained from a human patient in California in 2009)\n  - `>NA|A/chicken/Zimbabwe/AI4935/2017|H5N8|MF973227.1` (for the NA segment sequence of a H5N8 sample obtained from chicken in Zimbabwe in 2017)\n\n  **NOTE 2**: Sequences containing the ambiguity symbol N will be ignored by the workflow entirely.\n\n  **NOTE 3**: Datasets in this collection must not use colons (`:`) as part of their names.\n\n  **NOTE 4**: A well-formatted collection of Influenza A reference sequences suitable for most analysis needs is linked from the \"Data resources\" section of the page: https://virology.usegalaxy.eu/published/page?id=a04ab8d6ecb698fa. The underlying per-segment FASTA files to build the collection are deposited at https://doi.org/10.5281/zenodo.15364147.\n\n## Outputs:\n\n- **successful VAPOR runs - closest references**: a nested collection listing, for each sample and segment, the up to 500 best matching reference sequences according to VAPOR; inspect this collection if you are curious how many good matches to your data there were in the reference collection; useful for debugging, for example, if generated consensus sequences contain unresolved bases (Ns); missing segments or samples in this collection indicate that VAPOR failed to identify any matches for the respective item\n- **Subtyping results**: a table listing one sample and its detected subtype (with respect to the HA and NA segments) per row; missing subtype information for HA, NA or both segments is indicated by H?, N? and H?N?, respectively, in the corresponding sample line.\n- **Hybrid reference genomes used for mapping**: collection of compiled reference genomes (in FASTA format, one per sample) that served as input for bwa-mem; each reference genome consists of the genome segments from the reference collections that best matched the corresponding sample's sequencing data\n- **fastp reports**: QC and read trimming and filtering results from fastp\n- **Final read mapping results**: bwa-mem mapping results in BAM format post-processed with samtools view\n- **QC reports for mapping results**: a collection of reports of QC metrics for the \"Final read mapping results\" generated with Qualimap\n- **Per-sample consensus sequences**: a nested collection of consensus sequences organized first by sample, then by segment\n- **Per-segment consensus sequences with samples combined**: a collection of the same consensus sequences organized by segment; each collection element is a multi-sequence FASTA dataset with the segment-specific sequences of all samples\n- **Multiple sequence alignments per segment**: a collection of multiple sequence alignments generated with MAFFT from each of the \"Per-segment consensus sequences with samples combined\" above; generated only for segments for which at least two samples yielded a consensus sequence\n- **Snipit plots per segment**: a collection of SNP plots across samples generated with Snipit; one plot per segment; generated only for segments for which at least two samples yielded a consensus sequence; the first input sample will be used as the reference in the plot\n- **IQ-Tree per-segment ML tree**, **IQ-Tree per-segment ML distance matrix** and **IQ-Tree per-segment report**: collections of IQ-Tree ML trees, distance matrices and reports; each collection has one element per segment; generated  only for segments for which at least three samples yielded a consensus sequence\n\n## Related training material\n\nhttps://gxy.io/GTN:T00308 guides you through a simplified, manual analysis that still includes the key steps of this workflow.",
        "license": "AGPL-3.0-or-later",
        "release": "0.3",
        "name": "Influenza A isolate subtyping and consensus sequence generation",
        "readme": "# Subtyping and consensus sequence generation for batches of Influenza A isolates\n\nThis workflow performs subtyping (with respect to the HA and NA genes) and consensus sequence generation for batches of Illumina PE sequenced Influenza isolates. It overcomes Influenza genome variability by compiling the best possible reference for read mapping from a collection of reference sequences for each viral genome segment. The workflow has been tested for Influenza A isolates only but should also work with other types if a suitable collection of per-segment reference sequences (see \"Input datasets\" in the Help section) is provided.\n\nIt uses:\n- **VAPOR** for identifying, from a collection of reference sequences of each of the eight viral genome segments, the individual segment sequences that match the sequencing data for each sample most closely\n- **fastp** for sequenced reads pre-processing,\n- **bwa mem** for mapping the preprocessed reads to a reference compiled from the best-matching segment sequences identified by *VAPOR*\n- **ivar consensus** for generating consensus sequences from the mapped reads data\n- **MAFFT** for generating multiple sequence alignments from the consensus sequences of the samples in a batch\n- **Snipit** and **IQ-Tree** for visualizing differences and analyzing relationships between sequences from a batch\n\nThe workflow provides a subtyping report, the consensus sequences arranged by gene segment or by sample, quality control at the level of sequenced reads and of mapping results, and batch-level visualization and phylogenetic insight.",
        "report": {
            "markdown": "\n# Workflow Execution Report\n\n## Workflow Inputs\n```galaxy\ninvocation_inputs()\n```\n\n## Workflow Outputs\n```galaxy\ninvocation_outputs()\n```\n\n## Workflow\n```galaxy\nworkflow_display()\n```\n"
        },
        "steps": {
            "0": {
                "annotation": "A collection of influenza A reference sequences organized by segment",
                "content_id": null,
                "errors": null,
                "id": 0,
                "input_connections": {},
                "inputs": [
                    {
                        "description": "A collection of influenza A reference sequences organized by segment",
                        "name": "References per segment collection"
                    }
                ],
                "label": "References per segment collection",
                "name": "Input dataset collection",
                "outputs": [],
                "position": {
                    "left": 0,
                    "top": 524.3884793788038
                },
                "tool_id": null,
                "tool_state": "{\"optional\": false, \"tag\": \"\", \"collection_type\": \"list\", \"fields\": null, \"column_definitions\": null}",
                "tool_version": null,
                "type": "data_collection_input",
                "uuid": "833ff6bd-4f37-4064-9552-fc7981228644",
                "when": null,
                "workflow_outputs": []
            },
            "1": {
                "annotation": "Paired collection of forward and reverse reads of the sequenced isolate",
                "content_id": null,
                "errors": null,
                "id": 1,
                "input_connections": {},
                "inputs": [
                    {
                        "description": "Paired collection of forward and reverse reads of the sequenced isolate",
                        "name": "Sequenced paired-end data"
                    }
                ],
                "label": "Sequenced paired-end data",
                "name": "Input dataset collection",
                "outputs": [],
                "position": {
                    "left": 13.533355712890625,
                    "top": 1214.4550687342723
                },
                "tool_id": null,
                "tool_state": "{\"optional\": false, \"tag\": \"\", \"collection_type\": \"list:paired\", \"fields\": null, \"column_definitions\": null}",
                "tool_version": null,
                "type": "data_collection_input",
                "uuid": "6624892a-691a-4b53-b1ca-9c05882fca69",
                "when": null,
                "workflow_outputs": []
            },
            "2": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_text_file_with_recurring_lines/9.5+galaxy3",
                "errors": null,
                "id": 2,
                "input_connections": {},
                "inputs": [],
                "label": null,
                "name": "Create text file",
                "outputs": [
                    {
                        "name": "outfile",
                        "type": "txt"
                    }
                ],
                "position": {
                    "left": 1352.2557050782264,
                    "top": 986.9048541278397
                },
                "post_job_actions": {
                    "ChangeDatatypeActionoutfile": {
                        "action_arguments": {
                            "newtype": "tabular"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "outfile"
                    },
                    "HideDatasetActionoutfile": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "outfile"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_text_file_with_recurring_lines/9.5+galaxy3",
                "tool_shed_repository": {
                    "changeset_revision": "ab83aa685821",
                    "name": "text_processing",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"token_set\": [{\"__index__\": 0, \"line\": null, \"repeat_select\": {\"repeat_select_opts\": \"user\", \"__current_case__\": 0, \"times\": \"1\"}}], \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "9.5+galaxy3",
                "type": "tool",
                "uuid": "2909b887-ffb5-464a-b6db-e753aa90d033",
                "when": null,
                "workflow_outputs": []
            },
            "3": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2",
                "errors": null,
                "id": 3,
                "input_connections": {
                    "input_collection": {
                        "id": 0,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Extract element identifiers",
                "outputs": [
                    {
                        "name": "output",
                        "type": "txt"
                    }
                ],
                "position": {
                    "left": 297.61448006562847,
                    "top": 143.49471816528907
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2",
                "tool_shed_repository": {
                    "changeset_revision": "d3c07d270a50",
                    "name": "collection_element_identifiers",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"input_collection\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "0.0.2",
                "type": "tool",
                "uuid": "67d5225f-ee1d-4666-9d94-dc2c204f0b2c",
                "when": null,
                "workflow_outputs": []
            },
            "4": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2",
                "errors": null,
                "id": 4,
                "input_connections": {
                    "input_collection": {
                        "id": 1,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Extract element identifiers",
                "outputs": [
                    {
                        "name": "output",
                        "type": "txt"
                    }
                ],
                "position": {
                    "left": 346.01450447969086,
                    "top": 680.294705958258
                },
                "post_job_actions": {
                    "ChangeDatatypeActionoutput": {
                        "action_arguments": {
                            "newtype": "tabular"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "output"
                    },
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2",
                "tool_shed_repository": {
                    "changeset_revision": "d3c07d270a50",
                    "name": "collection_element_identifiers",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"input_collection\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "0.0.2",
                "type": "tool",
                "uuid": "53791ad0-0fe4-4aaf-a5a2-e8bf18256911",
                "when": null,
                "workflow_outputs": []
            },
            "5": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/1.1.0+galaxy0",
                "errors": null,
                "id": 5,
                "input_connections": {
                    "single_paired|paired_input": {
                        "id": 1,
                        "output_name": "output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool fastp",
                        "name": "single_paired"
                    }
                ],
                "label": null,
                "name": "fastp",
                "outputs": [
                    {
                        "name": "output_paired_coll",
                        "type": "input"
                    },
                    {
                        "name": "report_html",
                        "type": "html"
                    }
                ],
                "position": {
                    "left": 369.15820847000106,
                    "top": 1394.3466385710403
                },
                "post_job_actions": {
                    "RenameDatasetActionoutput_paired_coll": {
                        "action_arguments": {
                            "newname": "fastp-processed data"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output_paired_coll"
                    },
                    "RenameDatasetActionreport_html": {
                        "action_arguments": {
                            "newname": "fastp report"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "report_html"
                    },
                    "TagDatasetActionreport_html": {
                        "action_arguments": {
                            "tags": "\ud83d\udd0d"
                        },
                        "action_type": "TagDatasetAction",
                        "output_name": "report_html"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/1.1.0+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "ff33957bf802",
                    "name": "fastp",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"duplicated_reads\": {\"handling_options\": {\"eval_dups\": \"--dont_eval_duplication\", \"__current_case__\": 0}}, \"filter_options\": {\"quality_filtering_options\": {\"disable_quality_filtering\": false, \"qualified_quality_phred\": null, \"unqualified_percent_limit\": null, \"n_base_limit\": null}, \"length_filtering_options\": {\"disable_length_filtering\": false, \"length_required\": \"30\", \"length_limit\": null}, \"low_complexity_filter\": {\"enable_low_complexity_filter\": false, \"complexity_threshold\": null}}, \"output_options\": {\"report_html\": true, \"report_json\": false}, \"overrepresented_sequence_analysis\": {\"overrepresentation_analysis\": false, \"overrepresentation_sampling\": null}, \"read_mod_options\": {\"polyg_tail_trimming\": {\"trimming_select\": \"\", \"__current_case__\": 1, \"poly_g_min_len\": null}, \"polyx_tail_trimming\": {\"polyx_trimming_select\": \"\", \"__current_case__\": 1}, \"umi_processing\": {\"umi\": false, \"umi_loc\": \"\", \"umi_len\": null, \"umi_prefix\": \"\"}, \"cutting_by_quality_options\": {\"cut_front_select\": {\"cut_front\": \"\", \"__current_case__\": 1}, \"cut_tail_select\": {\"cut_tail\": \"\", \"__current_case__\": 1}, \"cut_right_select\": {\"cut_right\": \"\", \"__current_case__\": 1}}, \"base_correction_options\": {\"correction\": false}}, \"single_paired\": {\"single_paired_selector\": \"paired_collection\", \"__current_case__\": 1, \"paired_input\": {\"__class__\": \"ConnectedValue\"}, \"merge_reads\": {\"merge\": \"\", \"__current_case__\": 1}, \"adapter_trimming_options\": {\"disable_adapter_trimming\": false, \"adapter_sequence1\": \"\", \"adapter_sequence2\": \"\", \"detect_adapter_for_pe\": true}, \"global_trimming_options\": {\"trim_front1\": null, \"trim_tail1\": null, \"trim_front2\": null, \"trim_tail2\": null}}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_version": "1.1.0+galaxy0",
                "type": "tool",
                "uuid": "f7f9bf2c-0087-4731-9e61-c8cde95acbf0",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "fastp reports",
                        "output_name": "report_html",
                        "uuid": "8419d1d0-2f8f-4122-a2a9-fe06ebdf18d7"
                    },
                    {
                        "label": "fastp-processed paired collection",
                        "output_name": "output_paired_coll",
                        "uuid": "896eacce-9ba8-459d-88c3-3a1ca0df0f8e"
                    }
                ]
            },
            "6": {
                "annotation": "",
                "content_id": "wc_gnu",
                "errors": null,
                "id": 6,
                "input_connections": {
                    "input1": {
                        "id": 3,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Line/Word/Character count",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "tabular"
                    }
                ],
                "position": {
                    "left": 516.5811548703159,
                    "top": 102.09475478638285
                },
                "post_job_actions": {
                    "ChangeDatatypeActionout_file1": {
                        "action_arguments": {
                            "newtype": "txt"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "out_file1"
                    },
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "wc_gnu",
                "tool_state": "{\"include_header\": false, \"input1\": {\"__class__\": \"ConnectedValue\"}, \"options\": [\"lines\"], \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.0",
                "type": "tool",
                "uuid": "2343d0db-2bf7-414a-abf7-de995edfb341",
                "when": null,
                "workflow_outputs": []
            },
            "7": {
                "annotation": "",
                "content_id": "wc_gnu",
                "errors": null,
                "id": 7,
                "input_connections": {
                    "input1": {
                        "id": 4,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Line/Word/Character count",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "tabular"
                    }
                ],
                "position": {
                    "left": 340.24778084687836,
                    "top": 480.9613929699765
                },
                "post_job_actions": {
                    "ChangeDatatypeActionout_file1": {
                        "action_arguments": {
                            "newtype": "txt"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "out_file1"
                    },
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "wc_gnu",
                "tool_state": "{\"include_header\": false, \"input1\": {\"__class__\": \"ConnectedValue\"}, \"options\": [\"lines\"], \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.0",
                "type": "tool",
                "uuid": "649e39a8-84ed-4bea-8d0c-411684873da8",
                "when": null,
                "workflow_outputs": []
            },
            "8": {
                "annotation": "",
                "content_id": "__UNZIP_COLLECTION__",
                "errors": null,
                "id": 8,
                "input_connections": {
                    "input": {
                        "id": 5,
                        "output_name": "output_paired_coll"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Unzip collection",
                "outputs": [
                    {
                        "name": "forward",
                        "type": "input"
                    },
                    {
                        "name": "reverse",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 570.4211204300047,
                    "top": 1006.0567546184654
                },
                "post_job_actions": {
                    "HideDatasetActionforward": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "forward"
                    },
                    "HideDatasetActionreverse": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "reverse"
                    }
                },
                "tool_id": "__UNZIP_COLLECTION__",
                "tool_state": "{\"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.0",
                "type": "tool",
                "uuid": "b50ad9e4-2661-49c0-9baf-9685579f2d2b",
                "when": null,
                "workflow_outputs": []
            },
            "9": {
                "annotation": "",
                "content_id": "param_value_from_file",
                "errors": null,
                "id": 9,
                "input_connections": {
                    "input1": {
                        "id": 6,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Parse parameter value",
                "outputs": [
                    {
                        "name": "integer_param",
                        "type": "expression.json"
                    }
                ],
                "position": {
                    "left": 741.3145533078166,
                    "top": 91.9613929699766
                },
                "post_job_actions": {
                    "HideDatasetActioninteger_param": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "integer_param"
                    }
                },
                "tool_id": "param_value_from_file",
                "tool_state": "{\"input1\": {\"__class__\": \"ConnectedValue\"}, \"param_type\": \"integer\", \"remove_newlines\": true, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "0.1.0",
                "type": "tool",
                "uuid": "8e5475c0-b4d3-44eb-9bb9-3c812e438aa4",
                "when": null,
                "workflow_outputs": []
            },
            "10": {
                "annotation": "",
                "content_id": "param_value_from_file",
                "errors": null,
                "id": 10,
                "input_connections": {
                    "input1": {
                        "id": 7,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Parse parameter value",
                "outputs": [
                    {
                        "name": "integer_param",
                        "type": "expression.json"
                    }
                ],
                "position": {
                    "left": 558.1811304562534,
                    "top": 388.89468154419524
                },
                "post_job_actions": {
                    "HideDatasetActioninteger_param": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "integer_param"
                    }
                },
                "tool_id": "param_value_from_file",
                "tool_state": "{\"input1\": {\"__class__\": \"ConnectedValue\"}, \"param_type\": \"integer\", \"remove_newlines\": true, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "0.1.0",
                "type": "tool",
                "uuid": "9b944139-77f6-4bfb-bd89-8c18fc4f2a27",
                "when": null,
                "workflow_outputs": []
            },
            "11": {
                "annotation": "",
                "content_id": "__DUPLICATE_FILE_TO_COLLECTION__",
                "errors": null,
                "id": 11,
                "input_connections": {
                    "input": {
                        "id": 8,
                        "output_name": "forward"
                    },
                    "number": {
                        "id": 9,
                        "output_name": "integer_param"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Duplicate file to collection",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 1018.6478052609414,
                    "top": 916.8280311535705
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__DUPLICATE_FILE_TO_COLLECTION__",
                "tool_state": "{\"element_identifier\": \"segment\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"number\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.0",
                "type": "tool",
                "uuid": "a10c04fc-4b62-4c08-a23f-4bb35da5d860",
                "when": null,
                "workflow_outputs": []
            },
            "12": {
                "annotation": "",
                "content_id": "__DUPLICATE_FILE_TO_COLLECTION__",
                "errors": null,
                "id": 12,
                "input_connections": {
                    "input": {
                        "id": 8,
                        "output_name": "reverse"
                    },
                    "number": {
                        "id": 9,
                        "output_name": "integer_param"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Duplicate file to collection",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 1019.2144556515664,
                    "top": 1073.6614051770075
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__DUPLICATE_FILE_TO_COLLECTION__",
                "tool_state": "{\"element_identifier\": \"segment\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"number\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.0",
                "type": "tool",
                "uuid": "6ce2cc5c-6a98-4c74-936f-2125bfaae539",
                "when": null,
                "workflow_outputs": []
            },
            "13": {
                "annotation": "",
                "content_id": "__DUPLICATE_FILE_TO_COLLECTION__",
                "errors": null,
                "id": 13,
                "input_connections": {
                    "input": {
                        "id": 0,
                        "output_name": "output"
                    },
                    "number": {
                        "id": 10,
                        "output_name": "integer_param"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Duplicate file to collection",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 776.9811792843791,
                    "top": 285.99471816528916
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__DUPLICATE_FILE_TO_COLLECTION__",
                "tool_state": "{\"element_identifier\": \"seq\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"number\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.0",
                "type": "tool",
                "uuid": "b4259136-c6f9-4a4a-86a5-429847c70433",
                "when": null,
                "workflow_outputs": []
            },
            "14": {
                "annotation": "",
                "content_id": "__APPLY_RULES__",
                "errors": null,
                "id": 14,
                "input_connections": {
                    "input": {
                        "id": 13,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Apply rules",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 1021.9478540890664,
                    "top": 344.86135634888274
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__APPLY_RULES__",
                "tool_state": "{\"input\": {\"__class__\": \"ConnectedValue\"}, \"rules\": {\"mapping\": [{\"columns\": [1, 0], \"editing\": false, \"type\": \"list_identifiers\"}], \"rules\": [{\"error\": null, \"type\": \"add_column_metadata\", \"value\": \"identifier0\", \"warn\": null}, {\"error\": null, \"type\": \"add_column_metadata\", \"value\": \"identifier1\", \"warn\": null}]}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.1.0",
                "type": "tool",
                "uuid": "2d3daf2b-dc32-423b-8cfd-aab426076931",
                "when": null,
                "workflow_outputs": []
            },
            "15": {
                "annotation": "",
                "content_id": "__RELABEL_FROM_FILE__",
                "errors": null,
                "id": 15,
                "input_connections": {
                    "how|labels": {
                        "id": 4,
                        "output_name": "output"
                    },
                    "input": {
                        "id": 14,
                        "output_name": "output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool Relabel identifiers",
                        "name": "how"
                    }
                ],
                "label": null,
                "name": "Relabel identifiers",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 1046.6811304562546,
                    "top": 562.3946815441955
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__RELABEL_FROM_FILE__",
                "tool_state": "{\"how\": {\"how_select\": \"txt\", \"__current_case__\": 0, \"labels\": {\"__class__\": \"ConnectedValue\"}, \"strict\": true}, \"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.1.0",
                "type": "tool",
                "uuid": "96359349-f458-4ba7-ba71-c370fb967c4f",
                "when": null,
                "workflow_outputs": []
            },
            "16": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/vapor/vapor/1.0.3+galaxy0",
                "errors": null,
                "id": 16,
                "input_connections": {
                    "fasta_file": {
                        "id": 15,
                        "output_name": "output"
                    },
                    "fastq_input|fastq1": {
                        "id": 11,
                        "output_name": "output"
                    },
                    "fastq_input|fastq2": {
                        "id": 12,
                        "output_name": "output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool VAPOR",
                        "name": "fastq_input"
                    },
                    {
                        "description": "runtime parameter for tool VAPOR",
                        "name": "fastq_input"
                    }
                ],
                "label": null,
                "name": "VAPOR",
                "outputs": [
                    {
                        "name": "output_scores",
                        "type": "tabular"
                    }
                ],
                "position": {
                    "left": 1355.8575241127958,
                    "top": 754.4319318470165
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output_scores"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/vapor/vapor/1.0.3+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "21e09ba992b8",
                    "name": "vapor",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"fasta_file\": {\"__class__\": \"ConnectedValue\"}, \"fastq_input\": {\"fastq_input_selector\": \"paired\", \"__current_case__\": 1, \"fastq1\": {\"__class__\": \"ConnectedValue\"}, \"fastq2\": {\"__class__\": \"ConnectedValue\"}}, \"opt\": {\"kmer_length\": \"21\", \"threshold\": \"0.1\", \"min_kmer_cov\": \"5\", \"min_kmer_prop\": \"0.1\", \"top_seed_frac\": \"1.0\"}, \"output_type\": \"scores\", \"return_best_n\": \"500\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.3+galaxy0",
                "type": "tool",
                "uuid": "0c77b8db-e942-41e9-af13-137b5bb9afa3",
                "when": null,
                "workflow_outputs": []
            },
            "17": {
                "annotation": "",
                "content_id": "__FILTER_FAILED_DATASETS__",
                "errors": null,
                "id": 17,
                "input_connections": {
                    "input": {
                        "id": 16,
                        "output_name": "output_scores"
                    },
                    "replacement": {
                        "id": 2,
                        "output_name": "outfile"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Filter failed datasets",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 1619.6599847765308,
                    "top": 747.3152038511867
                },
                "post_job_actions": {
                    "RenameDatasetActionoutput": {
                        "action_arguments": {
                            "newname": "successful VAPOR runs - closest references"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output"
                    },
                    "TagDatasetActionoutput": {
                        "action_arguments": {
                            "tags": "\ud83d\udd0d"
                        },
                        "action_type": "TagDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__FILTER_FAILED_DATASETS__",
                "tool_state": "{\"input\": {\"__class__\": \"ConnectedValue\"}, \"replacement\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.1.0",
                "type": "tool",
                "uuid": "b0ccb093-c5c3-45f4-ad41-b8d2e0f1e101",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "successful VAPOR runs - closest references",
                        "output_name": "output",
                        "uuid": "246cdfd3-52d0-4d6f-8c63-90d148402487"
                    }
                ]
            },
            "18": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy3",
                "errors": null,
                "id": 18,
                "input_connections": {
                    "infile": {
                        "id": 17,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Replace",
                "outputs": [
                    {
                        "name": "outfile",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 1957.9057098301143,
                    "top": 765.3032418279653
                },
                "post_job_actions": {
                    "HideDatasetActionoutfile": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "outfile"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy3",
                "tool_shed_repository": {
                    "changeset_revision": "ab83aa685821",
                    "name": "text_processing",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"find_and_replace\": [{\"__index__\": 0, \"find_pattern\": \"^.+\\\\t>(.+)$\", \"replace_pattern\": \"$1\", \"is_regex\": true, \"global\": false, \"caseinsensitive\": false, \"wholewords\": false, \"skip_first_line\": false, \"searchwhere\": {\"searchwhere_select\": \"line\", \"__current_case__\": 0}}], \"infile\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "9.5+galaxy3",
                "type": "tool",
                "uuid": "c640f2b3-27dd-442a-9898-55ecf26238b2",
                "when": null,
                "workflow_outputs": []
            },
            "19": {
                "annotation": "",
                "content_id": "Show beginning1",
                "errors": null,
                "id": 19,
                "input_connections": {
                    "input": {
                        "id": 18,
                        "output_name": "outfile"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Select first",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 1956.9896768135857,
                    "top": 928.1109050351128
                },
                "post_job_actions": {},
                "tool_id": "Show beginning1",
                "tool_state": "{\"header\": false, \"input\": {\"__class__\": \"ConnectedValue\"}, \"lineNum\": \"1\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.2",
                "type": "tool",
                "uuid": "10056d50-865e-4d85-aa5d-f6fe4962c55f",
                "when": null,
                "workflow_outputs": []
            },
            "20": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/seqtk/seqtk_subseq/1.5+galaxy0",
                "errors": null,
                "id": 20,
                "input_connections": {
                    "in_file": {
                        "id": 15,
                        "output_name": "output"
                    },
                    "source|name_list": {
                        "id": 19,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool seqtk_subseq",
                        "name": "source"
                    }
                ],
                "label": null,
                "name": "seqtk_subseq",
                "outputs": [
                    {
                        "name": "default",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 2353.4655564317927,
                    "top": 209.50486922687932
                },
                "post_job_actions": {},
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/seqtk/seqtk_subseq/1.5+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "8511b6d85fc7",
                    "name": "seqtk",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"in_file\": {\"__class__\": \"ConnectedValue\"}, \"l\": \"0\", \"source\": {\"type\": \"name\", \"__current_case__\": 1, \"name_list\": {\"__class__\": \"ConnectedValue\"}}, \"t\": false, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.5+galaxy0",
                "type": "tool",
                "uuid": "f4cfffcd-2ffc-4865-9b36-6c47de96ef29",
                "when": null,
                "workflow_outputs": []
            },
            "21": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0",
                "errors": null,
                "id": 21,
                "input_connections": {
                    "input_list": {
                        "id": 19,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Collapse Collection",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 2262.2116199708744,
                    "top": 1330.523998175536
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0",
                "tool_shed_repository": {
                    "changeset_revision": "90981f86000f",
                    "name": "collapse_collections",
                    "owner": "nml",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"filename\": {\"add_name\": false, \"__current_case__\": 1}, \"input_list\": {\"__class__\": \"ConnectedValue\"}, \"one_header\": false, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "5.1.0",
                "type": "tool",
                "uuid": "a39722d7-3f4c-47cd-884f-8298324cceb1",
                "when": null,
                "workflow_outputs": []
            },
            "22": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0",
                "errors": null,
                "id": 22,
                "input_connections": {
                    "input_list": {
                        "id": 20,
                        "output_name": "default"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Collapse Collection",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 2440.8394171088758,
                    "top": 445.4645175903975
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    },
                    "RenameDatasetActionoutput": {
                        "action_arguments": {
                            "newname": "Top scoring segments combined"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0",
                "tool_shed_repository": {
                    "changeset_revision": "90981f86000f",
                    "name": "collapse_collections",
                    "owner": "nml",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"filename\": {\"add_name\": false, \"__current_case__\": 1}, \"input_list\": {\"__class__\": \"ConnectedValue\"}, \"one_header\": false, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "5.1.0",
                "type": "tool",
                "uuid": "f2b17dc8-8d6a-406a-be29-9c76ab00197f",
                "when": null,
                "workflow_outputs": []
            },
            "23": {
                "annotation": "",
                "content_id": "Grep1",
                "errors": null,
                "id": 23,
                "input_connections": {
                    "input": {
                        "id": 21,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Select",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 2564.7892895756813,
                    "top": 1363.515740654497
                },
                "post_job_actions": {
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "Grep1",
                "tool_state": "{\"input\": {\"__class__\": \"ConnectedValue\"}, \"invert\": \"\", \"keep_header\": false, \"pattern\": \"^HA.+\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.4",
                "type": "tool",
                "uuid": "cec2eb0b-4f51-4f3d-93c6-6e0e19b57415",
                "when": null,
                "workflow_outputs": []
            },
            "24": {
                "annotation": "",
                "content_id": "Grep1",
                "errors": null,
                "id": 24,
                "input_connections": {
                    "input": {
                        "id": 21,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Select",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 2560.485072598442,
                    "top": 1467.8706677278808
                },
                "post_job_actions": {
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "Grep1",
                "tool_state": "{\"input\": {\"__class__\": \"ConnectedValue\"}, \"invert\": \"\", \"keep_header\": false, \"pattern\": \"^NA.+\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.4",
                "type": "tool",
                "uuid": "85bfc235-4e53-45d9-816e-59a55991202a",
                "when": null,
                "workflow_outputs": []
            },
            "25": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy3",
                "errors": null,
                "id": 25,
                "input_connections": {
                    "infile": {
                        "id": 22,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Replace",
                "outputs": [
                    {
                        "name": "outfile",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 2465.5867685530047,
                    "top": 729.858383002329
                },
                "post_job_actions": {
                    "RenameDatasetActionoutfile": {
                        "action_arguments": {
                            "newname": "Hybrid reference genomes used for mapping"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "outfile"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy3",
                "tool_shed_repository": {
                    "changeset_revision": "ab83aa685821",
                    "name": "text_processing",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"find_and_replace\": [{\"__index__\": 0, \"find_pattern\": \">([^|]+).+$\", \"replace_pattern\": \">$1\", \"is_regex\": true, \"global\": false, \"caseinsensitive\": false, \"wholewords\": false, \"skip_first_line\": false, \"searchwhere\": {\"searchwhere_select\": \"line\", \"__current_case__\": 0}}], \"infile\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "9.5+galaxy3",
                "type": "tool",
                "uuid": "f011dfe0-b80a-4326-9689-dded3c33fca3",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "Hybrid reference genomes used for mapping",
                        "output_name": "outfile",
                        "uuid": "2cf026c7-3cca-4af6-b4c9-e46ef78de9ae"
                    }
                ]
            },
            "26": {
                "annotation": "",
                "content_id": "Paste1",
                "errors": null,
                "id": 26,
                "input_connections": {
                    "input1": {
                        "id": 23,
                        "output_name": "out_file1"
                    },
                    "input2": {
                        "id": 24,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Paste",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 2813.218308275525,
                    "top": 1429.0484834830888
                },
                "post_job_actions": {
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "Paste1",
                "tool_state": "{\"delimiter\": \"T\", \"input1\": {\"__class__\": \"ConnectedValue\"}, \"input2\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.0",
                "type": "tool",
                "uuid": "43c046b8-f80b-4e7f-b344-bcf628c133fb",
                "when": null,
                "workflow_outputs": []
            },
            "27": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.19",
                "errors": null,
                "id": 27,
                "input_connections": {
                    "fastq_input|fastq_input1": {
                        "id": 5,
                        "output_name": "output_paired_coll"
                    },
                    "reference_source|ref_file": {
                        "id": 25,
                        "output_name": "outfile"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool Map with BWA-MEM",
                        "name": "fastq_input"
                    },
                    {
                        "description": "runtime parameter for tool Map with BWA-MEM",
                        "name": "reference_source"
                    }
                ],
                "label": null,
                "name": "Map with BWA-MEM",
                "outputs": [
                    {
                        "name": "bam_output",
                        "type": "bam"
                    }
                ],
                "position": {
                    "left": 2462.1525237613378,
                    "top": 1013.5452578543651
                },
                "post_job_actions": {
                    "HideDatasetActionbam_output": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "bam_output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.19",
                "tool_shed_repository": {
                    "changeset_revision": "1dfc975b48d5",
                    "name": "bwa",
                    "owner": "devteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"analysis_type\": {\"analysis_type_selector\": \"illumina\", \"__current_case__\": 0}, \"fastq_input\": {\"fastq_input_selector\": \"paired_collection\", \"__current_case__\": 2, \"fastq_input1\": {\"__class__\": \"ConnectedValue\"}, \"iset_stats\": null}, \"output_sort\": \"coordinate\", \"reference_source\": {\"reference_source_selector\": \"history\", \"__current_case__\": 1, \"ref_file\": {\"__class__\": \"ConnectedValue\"}, \"index_a\": \"auto\"}, \"rg\": {\"rg_selector\": \"set\", \"__current_case__\": 1, \"read_group_id_conditional\": {\"do_auto_name\": true, \"__current_case__\": 0}, \"read_group_sm_conditional\": {\"do_auto_name\": true, \"__current_case__\": 0}, \"PL\": \"ILLUMINA\", \"read_group_lb_conditional\": {\"do_auto_name\": false, \"__current_case__\": 1, \"LB\": null}, \"CN\": null, \"DS\": null, \"DT\": null, \"FO\": null, \"KS\": null, \"PG\": null, \"PI\": null, \"PU\": null}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "0.7.19",
                "type": "tool",
                "uuid": "8b25de57-8d74-48de-8b01-755b5cd59d97",
                "when": null,
                "workflow_outputs": []
            },
            "28": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0",
                "errors": null,
                "id": 28,
                "input_connections": {
                    "input_list": {
                        "id": 26,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Collapse Collection",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 3027.640671556775,
                    "top": 1566.3150850455888
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0",
                "tool_shed_repository": {
                    "changeset_revision": "90981f86000f",
                    "name": "collapse_collections",
                    "owner": "nml",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"filename\": {\"add_name\": true, \"__current_case__\": 0, \"place_name\": \"same_multiple\"}, \"input_list\": {\"__class__\": \"ConnectedValue\"}, \"one_header\": false, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "5.1.0",
                "type": "tool",
                "uuid": "064cc95e-f750-4f60-809d-c6cb66cee933",
                "when": null,
                "workflow_outputs": []
            },
            "29": {
                "annotation": "bwa mem will fail if no reference for any segment got suggested by vapor, i.e. the reference genome is empty. In that case, we need to skip further analysis of the sample.",
                "content_id": "__FILTER_FAILED_DATASETS__",
                "errors": null,
                "id": 29,
                "input_connections": {
                    "input": {
                        "id": 27,
                        "output_name": "bam_output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool Filter failed datasets",
                        "name": "replacement"
                    }
                ],
                "label": null,
                "name": "Filter failed datasets",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 2734.0170035198607,
                    "top": 943.209915909526
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    },
                    "RenameDatasetActionoutput": {
                        "action_arguments": {
                            "newname": "BWA-MEM FilterFailed"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__FILTER_FAILED_DATASETS__",
                "tool_state": "{\"input\": {\"__class__\": \"ConnectedValue\"}, \"replacement\": {\"__class__\": \"RuntimeValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.1.0",
                "type": "tool",
                "uuid": "52ce1caf-2663-429a-a96a-7ac6a8668b5c",
                "when": null,
                "workflow_outputs": []
            },
            "30": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy3",
                "errors": null,
                "id": 30,
                "input_connections": {
                    "infile": {
                        "id": 28,
                        "output_name": "output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool Replace",
                        "name": "infile"
                    }
                ],
                "label": null,
                "name": "Replace",
                "outputs": [
                    {
                        "name": "outfile",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 3277.531222862771,
                    "top": 1570.6453453380393
                },
                "post_job_actions": {
                    "HideDatasetActionoutfile": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "outfile"
                    },
                    "RenameDatasetActionoutfile": {
                        "action_arguments": {
                            "newname": "Subtyping Results"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "outfile"
                    },
                    "TagDatasetActionoutfile": {
                        "action_arguments": {
                            "tags": "\u2b50"
                        },
                        "action_type": "TagDatasetAction",
                        "output_name": "outfile"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy3",
                "tool_shed_repository": {
                    "changeset_revision": "ab83aa685821",
                    "name": "text_processing",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"find_and_replace\": [{\"__index__\": 0, \"find_pattern\": \"^([^\\\\t]+)\\\\t$\", \"replace_pattern\": \"$1\\\\tH?N?\", \"is_regex\": false, \"global\": false, \"caseinsensitive\": false, \"wholewords\": false, \"skip_first_line\": false, \"searchwhere\": {\"searchwhere_select\": \"line\", \"__current_case__\": 0}}, {\"__index__\": 1, \"find_pattern\": \"^(.+\\\\t)(\\\\t.*)$\", \"replace_pattern\": \"$1H?$2\", \"is_regex\": true, \"global\": false, \"caseinsensitive\": false, \"wholewords\": false, \"skip_first_line\": false, \"searchwhere\": {\"searchwhere_select\": \"line\", \"__current_case__\": 0}}, {\"__index__\": 2, \"find_pattern\": \"^(.+\\\\t)$\", \"replace_pattern\": \"$1N?\", \"is_regex\": true, \"global\": false, \"caseinsensitive\": false, \"wholewords\": false, \"skip_first_line\": false, \"searchwhere\": {\"searchwhere_select\": \"line\", \"__current_case__\": 0}}, {\"__index__\": 3, \"find_pattern\": \"^(.+\\\\t)HA.+\\\\|.*(H\\\\d{1,2})N\\\\d{1,2}\\\\|[^|]+(\\\\t.+)$\", \"replace_pattern\": \"$1$2$3\", \"is_regex\": true, \"global\": false, \"caseinsensitive\": false, \"wholewords\": false, \"skip_first_line\": false, \"searchwhere\": {\"searchwhere_select\": \"line\", \"__current_case__\": 0}}, {\"__index__\": 4, \"find_pattern\": \"(.+\\\\t)(.+\\\\t)NA.+\\\\|.*H\\\\d{1,2}(N\\\\d{1,2})\\\\|.+$\", \"replace_pattern\": \"$1$2$3\", \"is_regex\": true, \"global\": false, \"caseinsensitive\": false, \"wholewords\": false, \"skip_first_line\": false, \"searchwhere\": {\"searchwhere_select\": \"line\", \"__current_case__\": 0}}, {\"__index__\": 5, \"find_pattern\": \"^(.+\\\\t)(.+)\\\\t(.+)$\", \"replace_pattern\": \"$1$2$3\", \"is_regex\": true, \"global\": false, \"caseinsensitive\": false, \"wholewords\": false, \"skip_first_line\": false, \"searchwhere\": {\"searchwhere_select\": \"line\", \"__current_case__\": 0}}], \"infile\": {\"__class__\": \"RuntimeValue\"}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "9.5+galaxy3",
                "type": "tool",
                "uuid": "df63a615-c395-4a83-af8d-b157e24d6ed9",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "Subtyping results",
                        "output_name": "outfile",
                        "uuid": "c17f65f8-5bd2-410e-8a94-14540b04b3a0"
                    }
                ]
            },
            "31": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.22+galaxy1",
                "errors": null,
                "id": 31,
                "input_connections": {
                    "input": {
                        "id": 29,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Samtools view",
                "outputs": [
                    {
                        "name": "outputsam",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 3068.774304798154,
                    "top": 434.09306773765326
                },
                "post_job_actions": {
                    "RenameDatasetActionoutputsam": {
                        "action_arguments": {
                            "newname": "Final read mapping results"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "outputsam"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.22+galaxy1",
                "tool_shed_repository": {
                    "changeset_revision": "5ec526530725",
                    "name": "samtools_view",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"addref_cond\": {\"addref_select\": \"no\", \"__current_case__\": 0}, \"input\": {\"__class__\": \"ConnectedValue\"}, \"mode\": {\"outtype\": \"selected_reads\", \"__current_case__\": 1, \"filter_config\": {\"cond_region\": {\"select_region\": \"no\", \"__current_case__\": 0}, \"cond_rg\": {\"select_rg\": \"no\", \"__current_case__\": 0}, \"cond_expr\": {\"select_expr\": \"no\", \"__current_case__\": 0}, \"quality\": \"20\", \"library\": \"\", \"cigarcons\": null, \"inclusive_filter\": [\"1\", \"2\"], \"exclusive_filter\": null, \"exclusive_filter_all\": null, \"tag\": \"\", \"qname_file\": {\"__class__\": \"RuntimeValue\"}}, \"subsample_config\": {\"subsampling_mode\": {\"select_subsample\": \"fraction\", \"__current_case__\": 0, \"factor\": \"1.0\", \"seed\": null}}, \"output_options\": {\"reads_report_type\": \"retained\", \"__current_case__\": 0, \"complementary_output\": false, \"adv_output\": {\"readtags\": [], \"collapsecigar\": false}, \"output_format\": {\"oformat\": \"bam\", \"__current_case__\": 2}}}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.22+galaxy1",
                "type": "tool",
                "uuid": "b3181791-d5a0-4cd5-a013-4aa8480197fe",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "Final read mapping_results",
                        "output_name": "outputsam",
                        "uuid": "aad0e121-6056-455f-84d8-790a80d349c3"
                    }
                ]
            },
            "32": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/bamtools_split_ref/bamtools_split_ref/2.5.2+galaxy2",
                "errors": null,
                "id": 32,
                "input_connections": {
                    "input_bam": {
                        "id": 31,
                        "output_name": "outputsam"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Split BAM by reference",
                "outputs": [
                    {
                        "name": "output_bams",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 3078.9409307747164,
                    "top": 691.488888355329
                },
                "post_job_actions": {},
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/bamtools_split_ref/bamtools_split_ref/2.5.2+galaxy2",
                "tool_shed_repository": {
                    "changeset_revision": "9b8feb118f9e",
                    "name": "bamtools_split_ref",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"input_bam\": {\"__class__\": \"ConnectedValue\"}, \"refs\": null, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "2.5.2+galaxy2",
                "type": "tool",
                "uuid": "a8f839cd-2513-4d6b-bbf3-d64e701392f9",
                "when": null,
                "workflow_outputs": []
            },
            "33": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/qualimap_bamqc/qualimap_bamqc/2.3+galaxy0",
                "errors": null,
                "id": 33,
                "input_connections": {
                    "input1": {
                        "id": 31,
                        "output_name": "outputsam"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "QualiMap BamQC",
                "outputs": [
                    {
                        "name": "raw_data",
                        "type": "input"
                    },
                    {
                        "name": "output_html",
                        "type": "html"
                    }
                ],
                "position": {
                    "left": 3343.357587268856,
                    "top": 423.6139036141181
                },
                "post_job_actions": {
                    "HideDatasetActionraw_data": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "raw_data"
                    },
                    "RenameDatasetActionoutput_html": {
                        "action_arguments": {
                            "newname": "QC reports for mapping results"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output_html"
                    },
                    "TagDatasetActionoutput_html": {
                        "action_arguments": {
                            "tags": "\ud83d\udd0d"
                        },
                        "action_type": "TagDatasetAction",
                        "output_name": "output_html"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/qualimap_bamqc/qualimap_bamqc/2.3+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "30a201c9c310",
                    "name": "qualimap_bamqc",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"duplicate_skipping\": null, \"input1\": {\"__class__\": \"ConnectedValue\"}, \"per_base_coverage\": false, \"plot_specific\": {\"n_bins\": \"40\", \"paint_chromosome_limits\": true, \"genome_gc_distr\": null, \"homopolymer_size\": \"3\"}, \"stats_regions\": {\"region_select\": \"all\", \"__current_case__\": 0}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "2.3+galaxy0",
                "type": "tool",
                "uuid": "d0f0b152-9e71-4072-b1e2-118608095de7",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "QC reports for mapping results",
                        "output_name": "output_html",
                        "uuid": "c0e4866b-da41-4ec0-93e6-24071b8c2de1"
                    }
                ]
            },
            "34": {
                "annotation": "",
                "content_id": "__APPLY_RULES__",
                "errors": null,
                "id": 34,
                "input_connections": {
                    "input": {
                        "id": 32,
                        "output_name": "output_bams"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Apply rules",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 3187.1284536629,
                    "top": 916.5305448494696
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__APPLY_RULES__",
                "tool_state": "{\"input\": {\"__class__\": \"ConnectedValue\"}, \"rules\": {\"mapping\": [{\"columns\": [1, 0], \"editing\": false, \"type\": \"list_identifiers\"}], \"rules\": [{\"error\": null, \"type\": \"add_column_metadata\", \"value\": \"identifier0\", \"warn\": null}, {\"error\": null, \"type\": \"add_column_metadata\", \"value\": \"identifier1\", \"warn\": null}]}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.1.0",
                "type": "tool",
                "uuid": "57141fce-c4f0-4480-b461-572852f84686",
                "when": null,
                "workflow_outputs": []
            },
            "35": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2",
                "errors": null,
                "id": 35,
                "input_connections": {
                    "input_collection": {
                        "id": 34,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Extract element identifiers",
                "outputs": [
                    {
                        "name": "output",
                        "type": "txt"
                    }
                ],
                "position": {
                    "left": 3363.024259021786,
                    "top": 649.3847394905829
                },
                "post_job_actions": {
                    "ChangeDatatypeActionoutput": {
                        "action_arguments": {
                            "newtype": "tabular"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "output"
                    },
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2",
                "tool_shed_repository": {
                    "changeset_revision": "d3c07d270a50",
                    "name": "collection_element_identifiers",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"input_collection\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "0.0.2",
                "type": "tool",
                "uuid": "26b43ad3-b27a-45a8-8957-92592c8d2772",
                "when": null,
                "workflow_outputs": []
            },
            "36": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2",
                "errors": null,
                "id": 36,
                "input_connections": {
                    "input_collection": {
                        "id": 35,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Extract element identifiers",
                "outputs": [
                    {
                        "name": "output",
                        "type": "txt"
                    }
                ],
                "position": {
                    "left": 3579.524274280575,
                    "top": 643.8430906258368
                },
                "post_job_actions": {
                    "ChangeDatatypeActionoutput": {
                        "action_arguments": {
                            "newtype": "tabular"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "output"
                    },
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2",
                "tool_shed_repository": {
                    "changeset_revision": "d3c07d270a50",
                    "name": "collection_element_identifiers",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"input_collection\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "0.0.2",
                "type": "tool",
                "uuid": "3728390a-ddc4-4cde-8d6d-3aea2cd16081",
                "when": null,
                "workflow_outputs": []
            },
            "37": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy3",
                "errors": null,
                "id": 37,
                "input_connections": {
                    "infile": {
                        "id": 36,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Replace",
                "outputs": [
                    {
                        "name": "outfile",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 3626.6930070882854,
                    "top": 833.7262933241751
                },
                "post_job_actions": {
                    "HideDatasetActionoutfile": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "outfile"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy3",
                "tool_shed_repository": {
                    "changeset_revision": "ab83aa685821",
                    "name": "text_processing",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"find_and_replace\": [{\"__index__\": 0, \"find_pattern\": \"^(Final read mapping results: (.+))$\", \"replace_pattern\": \"$1\\\\t$2\", \"is_regex\": true, \"global\": true, \"caseinsensitive\": false, \"wholewords\": false, \"skip_first_line\": false, \"searchwhere\": {\"searchwhere_select\": \"line\", \"__current_case__\": 0}}], \"infile\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "9.5+galaxy3",
                "type": "tool",
                "uuid": "92170405-5eaa-4636-a91f-bcda49889533",
                "when": null,
                "workflow_outputs": []
            },
            "38": {
                "annotation": "",
                "content_id": "__RELABEL_FROM_FILE__",
                "errors": null,
                "id": 38,
                "input_connections": {
                    "how|labels": {
                        "id": 37,
                        "output_name": "outfile"
                    },
                    "input": {
                        "id": 34,
                        "output_name": "output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool Relabel identifiers",
                        "name": "how"
                    }
                ],
                "label": null,
                "name": "Relabel identifiers",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 3875.3784612922937,
                    "top": 924.6972013436102
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__RELABEL_FROM_FILE__",
                "tool_state": "{\"how\": {\"how_select\": \"tabular\", \"__current_case__\": 1, \"labels\": {\"__class__\": \"ConnectedValue\"}, \"strict\": false}, \"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.1.0",
                "type": "tool",
                "uuid": "d068847a-e4e4-4d0b-ab17-6e136cb54383",
                "when": null,
                "workflow_outputs": []
            },
            "39": {
                "annotation": "",
                "content_id": "__APPLY_RULES__",
                "errors": null,
                "id": 39,
                "input_connections": {
                    "input": {
                        "id": 38,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Apply rules",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 3937.3777009916394,
                    "top": 681.4287429502001
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__APPLY_RULES__",
                "tool_state": "{\"input\": {\"__class__\": \"ConnectedValue\"}, \"rules\": {\"mapping\": [{\"columns\": [1, 0], \"editing\": false, \"type\": \"list_identifiers\"}], \"rules\": [{\"error\": null, \"type\": \"add_column_metadata\", \"value\": \"identifier0\", \"warn\": null}, {\"error\": null, \"type\": \"add_column_metadata\", \"value\": \"identifier1\", \"warn\": null}]}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.1.0",
                "type": "tool",
                "uuid": "378fc0b7-f2b4-405c-b541-a8f946bc12c2",
                "when": null,
                "workflow_outputs": []
            },
            "40": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2",
                "errors": null,
                "id": 40,
                "input_connections": {
                    "input_collection": {
                        "id": 38,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Extract element identifiers",
                "outputs": [
                    {
                        "name": "output",
                        "type": "txt"
                    }
                ],
                "position": {
                    "left": 4072.005730612003,
                    "top": 1240.996387426384
                },
                "post_job_actions": {},
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2",
                "tool_shed_repository": {
                    "changeset_revision": "d3c07d270a50",
                    "name": "collection_element_identifiers",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"input_collection\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "0.0.2",
                "type": "tool",
                "uuid": "0bde584b-029f-426f-a13b-a3a7a5f858e1",
                "when": null,
                "workflow_outputs": []
            },
            "41": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/ivar_consensus/ivar_consensus/1.4.4+galaxy0",
                "errors": null,
                "id": 41,
                "input_connections": {
                    "input_bam": {
                        "id": 39,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "ivar consensus",
                "outputs": [
                    {
                        "name": "consensus",
                        "type": "fasta"
                    }
                ],
                "position": {
                    "left": 4127.353274885074,
                    "top": 455.24646533512174
                },
                "post_job_actions": {
                    "RenameDatasetActionconsensus": {
                        "action_arguments": {
                            "newname": "Per-sample consensus sequences"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "consensus"
                    },
                    "TagDatasetActionconsensus": {
                        "action_arguments": {
                            "tags": "\u2b50"
                        },
                        "action_type": "TagDatasetAction",
                        "output_name": "consensus"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/ivar_consensus/ivar_consensus/1.4.4+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "1c5448133894",
                    "name": "ivar_consensus",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"depth_action\": \"-n N\", \"input_bam\": {\"__class__\": \"ConnectedValue\"}, \"min_depth\": \"10\", \"min_freq\": \"0.7\", \"min_indel_freq\": \"0.8\", \"min_qual\": \"20\", \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.4.4+galaxy0",
                "type": "tool",
                "uuid": "14efb3a9-2866-4f5d-8c08-7d7ec0c8e09d",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "Per-sample consensus sequences",
                        "output_name": "consensus",
                        "uuid": "9ab002c0-75a1-4bc9-b109-792018bfe86d"
                    }
                ]
            },
            "42": {
                "annotation": "",
                "content_id": "wc_gnu",
                "errors": null,
                "id": 42,
                "input_connections": {
                    "input1": {
                        "id": 40,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Line/Word/Character count",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "tabular"
                    }
                ],
                "position": {
                    "left": 4114.045561972776,
                    "top": 1445.44912981794
                },
                "post_job_actions": {
                    "ChangeDatatypeActionout_file1": {
                        "action_arguments": {
                            "newtype": "txt"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "out_file1"
                    },
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "wc_gnu",
                "tool_state": "{\"include_header\": false, \"input1\": {\"__class__\": \"ConnectedValue\"}, \"options\": [\"lines\"], \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.0",
                "type": "tool",
                "uuid": "b608ce7a-1d76-49d1-8dac-4f7bba69a1df",
                "when": null,
                "workflow_outputs": []
            },
            "43": {
                "annotation": "",
                "content_id": "__APPLY_RULES__",
                "errors": null,
                "id": 43,
                "input_connections": {
                    "input": {
                        "id": 41,
                        "output_name": "consensus"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Apply rules",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 4251.276982179164,
                    "top": 716.7169268139082
                },
                "post_job_actions": {
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    },
                    "RenameDatasetActionoutput": {
                        "action_arguments": {
                            "newname": "Per-segment consensus sequences"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "__APPLY_RULES__",
                "tool_state": "{\"input\": {\"__class__\": \"ConnectedValue\"}, \"rules\": {\"mapping\": [{\"columns\": [1, 0], \"editing\": false, \"type\": \"list_identifiers\"}], \"rules\": [{\"error\": null, \"type\": \"add_column_metadata\", \"value\": \"identifier0\", \"warn\": null}, {\"error\": null, \"type\": \"add_column_metadata\", \"value\": \"identifier1\", \"warn\": null}]}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.1.0",
                "type": "tool",
                "uuid": "41bac28e-e62c-44a5-8578-1cefedceb298",
                "when": null,
                "workflow_outputs": []
            },
            "44": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0",
                "errors": null,
                "id": 44,
                "input_connections": {
                    "input_list": {
                        "id": 42,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Collapse Collection",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 4342.154984343346,
                    "top": 1427.5635516054872
                },
                "post_job_actions": {
                    "ChangeDatatypeActionoutput": {
                        "action_arguments": {
                            "newtype": "tabular"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "output"
                    },
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0",
                "tool_shed_repository": {
                    "changeset_revision": "90981f86000f",
                    "name": "collapse_collections",
                    "owner": "nml",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"filename\": {\"add_name\": true, \"__current_case__\": 0, \"place_name\": \"same_multiple\"}, \"input_list\": {\"__class__\": \"ConnectedValue\"}, \"one_header\": false, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "5.1.0",
                "type": "tool",
                "uuid": "e9f9fadd-2829-4d8a-883b-4eab2359c367",
                "when": null,
                "workflow_outputs": []
            },
            "45": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0",
                "errors": null,
                "id": 45,
                "input_connections": {
                    "input_list": {
                        "id": 43,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Collapse Collection",
                "outputs": [
                    {
                        "name": "output",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 4420.8515838362855,
                    "top": 476.44090678447685
                },
                "post_job_actions": {
                    "ChangeDatatypeActionoutput": {
                        "action_arguments": {
                            "newtype": "txt"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "output"
                    },
                    "HideDatasetActionoutput": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0",
                "tool_shed_repository": {
                    "changeset_revision": "90981f86000f",
                    "name": "collapse_collections",
                    "owner": "nml",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"filename\": {\"add_name\": true, \"__current_case__\": 0, \"place_name\": \"same_once\"}, \"input_list\": {\"__class__\": \"ConnectedValue\"}, \"one_header\": false, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "5.1.0",
                "type": "tool",
                "uuid": "284353ae-b549-4295-b8da-1032340404db",
                "when": null,
                "workflow_outputs": []
            },
            "46": {
                "annotation": "",
                "content_id": "Filter1",
                "errors": null,
                "id": 46,
                "input_connections": {
                    "input": {
                        "id": 44,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Filter",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 4572.005730612002,
                    "top": 1273.8322083219064
                },
                "post_job_actions": {
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "Filter1",
                "tool_state": "{\"cond\": \"c2 > 1\", \"header_lines\": \"0\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.1.1",
                "type": "tool",
                "uuid": "3ffb9dd8-fc94-434b-a711-be08ab3a1422",
                "when": null,
                "workflow_outputs": []
            },
            "47": {
                "annotation": "",
                "content_id": "Filter1",
                "errors": null,
                "id": 47,
                "input_connections": {
                    "input": {
                        "id": 44,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Filter",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 4580.960954492599,
                    "top": 1491.742656083099
                },
                "post_job_actions": {
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "Filter1",
                "tool_state": "{\"cond\": \"c2 > 2\", \"header_lines\": \"0\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.1.1",
                "type": "tool",
                "uuid": "72bcbf67-c851-4832-afe6-de54fbabfb8b",
                "when": null,
                "workflow_outputs": []
            },
            "48": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy3",
                "errors": null,
                "id": 48,
                "input_connections": {
                    "infile": {
                        "id": 45,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Replace",
                "outputs": [
                    {
                        "name": "outfile",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 4541.3117554943765,
                    "top": 696.5745600843425
                },
                "post_job_actions": {
                    "ChangeDatatypeActionoutfile": {
                        "action_arguments": {
                            "newtype": "fasta"
                        },
                        "action_type": "ChangeDatatypeAction",
                        "output_name": "outfile"
                    },
                    "RenameDatasetActionoutfile": {
                        "action_arguments": {
                            "newname": "Per-segment consensus sequences with samples combined"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "outfile"
                    },
                    "TagDatasetActionoutfile": {
                        "action_arguments": {
                            "tags": "\u2b50"
                        },
                        "action_type": "TagDatasetAction",
                        "output_name": "outfile"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy3",
                "tool_shed_repository": {
                    "changeset_revision": "ab83aa685821",
                    "name": "text_processing",
                    "owner": "bgruening",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"find_and_replace\": [{\"__index__\": 0, \"find_pattern\": \"^(.+)\\\\t>Consensus_(.+)_threshold.+\", \"replace_pattern\": \">$1|$2\", \"is_regex\": true, \"global\": false, \"caseinsensitive\": false, \"wholewords\": false, \"skip_first_line\": false, \"searchwhere\": {\"searchwhere_select\": \"line\", \"__current_case__\": 0}}], \"infile\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "9.5+galaxy3",
                "type": "tool",
                "uuid": "d7d950b0-b500-4e46-8f9e-75824998d74d",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "Per-segment consensus sequences with samples combined",
                        "output_name": "outfile",
                        "uuid": "3fd532fe-a2cb-40f4-869c-836c6fb4502e"
                    }
                ]
            },
            "49": {
                "annotation": "",
                "content_id": "Cut1",
                "errors": null,
                "id": 49,
                "input_connections": {
                    "input": {
                        "id": 46,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Cut",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "tabular"
                    }
                ],
                "position": {
                    "left": 4813.796775388122,
                    "top": 1261.8919098144443
                },
                "post_job_actions": {
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "Cut1",
                "tool_state": "{\"columnList\": \"c1\", \"delimiter\": \"T\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.2",
                "type": "tool",
                "uuid": "dcf2c8c0-701e-4436-a011-d2a11a3daa60",
                "when": null,
                "workflow_outputs": []
            },
            "50": {
                "annotation": "",
                "content_id": "Cut1",
                "errors": null,
                "id": 50,
                "input_connections": {
                    "input": {
                        "id": 47,
                        "output_name": "out_file1"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Cut",
                "outputs": [
                    {
                        "name": "out_file1",
                        "type": "tabular"
                    }
                ],
                "position": {
                    "left": 4803.349014194091,
                    "top": 1461.8919098144424
                },
                "post_job_actions": {
                    "HideDatasetActionout_file1": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "out_file1"
                    }
                },
                "tool_id": "Cut1",
                "tool_state": "{\"columnList\": \"c1\", \"delimiter\": \"T\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.2",
                "type": "tool",
                "uuid": "19a6fb39-8450-4522-9506-1e949d4d77ae",
                "when": null,
                "workflow_outputs": []
            },
            "51": {
                "annotation": "",
                "content_id": "__FILTER_FROM_FILE__",
                "errors": null,
                "id": 51,
                "input_connections": {
                    "how|filter_source": {
                        "id": 49,
                        "output_name": "out_file1"
                    },
                    "input": {
                        "id": 48,
                        "output_name": "outfile"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool Filter collection",
                        "name": "how"
                    }
                ],
                "label": null,
                "name": "Filter collection",
                "outputs": [
                    {
                        "name": "output_filtered",
                        "type": "input"
                    },
                    {
                        "name": "output_discarded",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 5087.767899855204,
                    "top": 862.8855279177892
                },
                "post_job_actions": {
                    "HideDatasetActionoutput_discarded": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output_discarded"
                    }
                },
                "tool_id": "__FILTER_FROM_FILE__",
                "tool_state": "{\"how\": {\"how_filter\": \"remove_if_absent\", \"__current_case__\": 0, \"filter_source\": {\"__class__\": \"ConnectedValue\"}}, \"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.0",
                "type": "tool",
                "uuid": "5f95ec61-9d83-4286-a899-3a9efc66ad72",
                "when": null,
                "workflow_outputs": []
            },
            "52": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/rnateam/mafft/rbc_mafft/7.526+galaxy2",
                "errors": null,
                "id": 52,
                "input_connections": {
                    "input|batches_0|inputs": {
                        "id": 51,
                        "output_name": "output_filtered"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "MAFFT",
                "outputs": [
                    {
                        "name": "outputAlignment",
                        "type": "fasta"
                    }
                ],
                "position": {
                    "left": 5336.105019345205,
                    "top": 887.6095739506145
                },
                "post_job_actions": {
                    "RenameDatasetActionoutputAlignment": {
                        "action_arguments": {
                            "newname": "Multiple sequence alignments per segment"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "outputAlignment"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/rnateam/mafft/rbc_mafft/7.526+galaxy2",
                "tool_shed_repository": {
                    "changeset_revision": "0a507f4bd19a",
                    "name": "mafft",
                    "owner": "rnateam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"anysymbol\": false, \"datatype_selection\": {\"datatype\": \"--nuc\", \"__current_case__\": 1, \"scoring_matrix\": {\"type\": \"--kimura\", \"__current_case__\": 0, \"coefficient\": \"200\"}, \"fmodel\": false, \"gap_costs\": {\"use_defaults\": \"yes\", \"__current_case__\": 0}}, \"flavour\": {\"type\": \"mafft-fftns\", \"__current_case__\": 2}, \"input\": {\"mapping\": \"implicit\", \"__current_case__\": 0, \"batches\": [{\"__index__\": 0, \"inputs\": {\"__class__\": \"ConnectedValue\"}}]}, \"outputFormat\": \"\", \"reorder\": false, \"seed\": {\"__class__\": \"RuntimeValue\"}, \"treeout\": false, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "7.526+galaxy2",
                "type": "tool",
                "uuid": "455f3576-0bd8-4ce4-8447-a332cb3afa15",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "Multiple sequence alignments per segment",
                        "output_name": "outputAlignment",
                        "uuid": "8096c238-9150-4e22-b22b-23e54548aae7"
                    }
                ]
            },
            "53": {
                "annotation": "",
                "content_id": "__FILTER_FROM_FILE__",
                "errors": null,
                "id": 53,
                "input_connections": {
                    "how|filter_source": {
                        "id": 50,
                        "output_name": "out_file1"
                    },
                    "input": {
                        "id": 52,
                        "output_name": "outputAlignment"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool Filter collection",
                        "name": "how"
                    }
                ],
                "label": null,
                "name": "Filter collection",
                "outputs": [
                    {
                        "name": "output_filtered",
                        "type": "input"
                    },
                    {
                        "name": "output_discarded",
                        "type": "input"
                    }
                ],
                "position": {
                    "left": 5326.454941166758,
                    "top": 1243.1380655006487
                },
                "post_job_actions": {
                    "HideDatasetActionoutput_discarded": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "output_discarded"
                    }
                },
                "tool_id": "__FILTER_FROM_FILE__",
                "tool_state": "{\"how\": {\"how_filter\": \"remove_if_absent\", \"__current_case__\": 0, \"filter_source\": {\"__class__\": \"ConnectedValue\"}}, \"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.0.0",
                "type": "tool",
                "uuid": "c3e5b24f-84bd-4959-b7b8-d23a6cd62132",
                "when": null,
                "workflow_outputs": []
            },
            "54": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/snipit/snipit/1.7+galaxy0",
                "errors": null,
                "id": 54,
                "input_connections": {
                    "alignment": {
                        "id": 52,
                        "output_name": "outputAlignment"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "snipit",
                "outputs": [
                    {
                        "name": "snp_plot",
                        "type": "png"
                    }
                ],
                "position": {
                    "left": 5716.709440365246,
                    "top": 1037.3764131123842
                },
                "post_job_actions": {
                    "RenameDatasetActionsnp_plot": {
                        "action_arguments": {
                            "newname": "Snipit plots per segment"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "snp_plot"
                    },
                    "TagDatasetActionsnp_plot": {
                        "action_arguments": {
                            "tags": "\u2b50"
                        },
                        "action_type": "TagDatasetAction",
                        "output_name": "snp_plot"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/snipit/snipit/1.7+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "290071465e6e",
                    "name": "snipit",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"alignment\": {\"__class__\": \"ConnectedValue\"}, \"dims\": {\"width\": \"0.0\", \"height\": \"0.0\", \"size_option\": \"\"}, \"mode\": {\"sequence_type\": \"nt\", \"__current_case__\": 0, \"ref\": {\"select\": \"first\", \"__current_case__\": 0}, \"colouring\": {\"palette\": \"classic\", \"__current_case__\": 1}}, \"plot\": {\"format\": \"png\", \"__current_case__\": 2, \"transparent_background\": false}, \"pos_restrict\": {\"show_indels\": false, \"ambig_mode\": \"snps\", \"include_positions\": [], \"exclude_positions\": []}, \"style\": {\"labels\": {\"choose\": \"\", \"__current_case__\": 0}, \"position_labels\": true, \"sort\": {\"order\": \"--sort-by-mutation-number\", \"__current_case__\": 2, \"high_to_low\": false}, \"flip_vertical\": false}, \"write_snps\": false, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "1.7+galaxy0",
                "type": "tool",
                "uuid": "97024266-6fe4-4a95-9029-6bac3669abaa",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "Snipit plots per segment",
                        "output_name": "snp_plot",
                        "uuid": "eece53fd-563d-46a8-8a54-70036f67fd4a"
                    }
                ]
            },
            "55": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/iuc/iqtree/iqtree/2.4.0+galaxy1",
                "errors": null,
                "id": 55,
                "input_connections": {
                    "general_options|s": {
                        "id": 53,
                        "output_name": "output_filtered"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool IQ-TREE",
                        "name": "general_options"
                    },
                    {
                        "description": "runtime parameter for tool IQ-TREE",
                        "name": "general_options"
                    },
                    {
                        "description": "runtime parameter for tool IQ-TREE",
                        "name": "likelihood_mapping"
                    }
                ],
                "label": null,
                "name": "IQ-TREE",
                "outputs": [
                    {
                        "name": "bionj",
                        "type": "nhx"
                    },
                    {
                        "name": "treefile",
                        "type": "nhx"
                    },
                    {
                        "name": "mldist",
                        "type": "mldist"
                    },
                    {
                        "name": "splits",
                        "type": "nex"
                    },
                    {
                        "name": "iqtree",
                        "type": "iqtree"
                    }
                ],
                "position": {
                    "left": 5717.004921688955,
                    "top": 39.909622778740165
                },
                "post_job_actions": {
                    "HideDatasetActionbionj": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "bionj"
                    },
                    "HideDatasetActionsplits": {
                        "action_arguments": {},
                        "action_type": "HideDatasetAction",
                        "output_name": "splits"
                    },
                    "RenameDatasetActioniqtree": {
                        "action_arguments": {
                            "newname": "IQ-Tree per-segment report"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "iqtree"
                    },
                    "RenameDatasetActionmldist": {
                        "action_arguments": {
                            "newname": "IQ-Tree per-segment ML distance matrix"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "mldist"
                    },
                    "RenameDatasetActiontreefile": {
                        "action_arguments": {
                            "newname": "IQ-Tree per-segment ML tree"
                        },
                        "action_type": "RenameDatasetAction",
                        "output_name": "treefile"
                    },
                    "TagDatasetActioniqtree": {
                        "action_arguments": {
                            "tags": "\u2b50"
                        },
                        "action_type": "TagDatasetAction",
                        "output_name": "iqtree"
                    },
                    "TagDatasetActionmldist": {
                        "action_arguments": {
                            "tags": "\u2b50"
                        },
                        "action_type": "TagDatasetAction",
                        "output_name": "mldist"
                    }
                },
                "tool_id": "toolshed.g2.bx.psu.edu/repos/iuc/iqtree/iqtree/2.4.0+galaxy1",
                "tool_shed_repository": {
                    "changeset_revision": "18a61a9c1601",
                    "name": "iqtree",
                    "owner": "iuc",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"bootstrap_parameters\": {\"ultrafast_bootstrap\": {\"ufboot\": null, \"ufjack\": null, \"jack_prop\": null, \"boot_trees\": false, \"wbtl\": false, \"nmax\": \"1000\", \"bcor\": \"0.99\", \"nstep\": \"100\", \"beps\": \"0.5\", \"sampling\": null, \"bnni\": false}, \"nonparametric_bootstrap\": {\"boot\": null, \"jack\": null, \"jack_prop\": null, \"bcon\": null, \"bonly\": null, \"tbe\": false}}, \"general_options\": {\"s\": {\"__class__\": \"ConnectedValue\"}, \"o\": null, \"short_alignments\": false, \"seqtype\": \"DNA\", \"t\": {\"__class__\": \"RuntimeValue\"}, \"seed\": null, \"keep_ident\": false, \"epsilon\": null, \"safe\": false}, \"likelihood_mapping\": {\"lmap\": null, \"lmclust\": {\"__class__\": \"RuntimeValue\"}, \"quartetlh\": false}, \"miscellaneous_options\": {\"fconst\": null, \"blmin\": null, \"blmax\": null}, \"modelling_parameters\": {\"automatic_model\": {\"cond_model\": {\"opt_custommodel\": \"true\", \"__current_case__\": 0, \"m\": null}, \"merge_strategy\": {\"merge\": \"none\", \"__current_case__\": 0}, \"mset\": null, \"msub\": \"nuclear\", \"mfreq\": null, \"mrate\": null, \"cmin\": \"2\", \"cmax\": \"10\", \"merit\": \"AIC\", \"mtree\": false, \"madd\": null, \"mdef\": {\"__class__\": \"RuntimeValue\"}, \"modelomatic\": false}, \"specifying_substitution\": {\"mix_opt\": false}, \"rate_heterogeneity\": {\"alpha_min\": null, \"gamma_median\": false, \"i\": null, \"opt_gamma_inv\": false, \"rate\": false, \"mlrate\": false}, \"partition_model\": {\"model_selection\": {\"model\": \"none\", \"__current_case__\": 0}}, \"site_specific_frequency\": {\"tree_freq\": {\"__class__\": \"RuntimeValue\"}, \"site_freq\": null, \"freq_max\": false}}, \"time_tree\": {\"date_source\": {\"select_source\": \"none\", \"__current_case__\": 0}, \"date_tip\": null, \"date_root\": null, \"date_ci\": null, \"clock_sd\": null, \"date_no_outgroup\": false, \"date_outlier\": null, \"date_options\": null}, \"tree_parameters\": {\"tree_search\": {\"n\": null, \"ninit\": \"100\", \"ntop\": \"20\", \"nbest\": \"5\", \"nstop\": \"100\", \"radius\": \"6\", \"perturb\": \"0.5\", \"allnni\": false, \"tree_fix\": false, \"g\": {\"__class__\": \"RuntimeValue\"}, \"fast\": false, \"polytomy\": false, \"treels\": false, \"show_lh\": false, \"terrace\": false}, \"single_branch\": {\"alrt\": null, \"abayes\": false, \"lbp\": null}, \"tree_topology\": {\"trees\": {\"__class__\": \"RuntimeValue\"}, \"test\": null, \"test_weight\": false, \"test_au\": false}, \"constructing_consensus\": {\"contree\": false, \"connet\": false, \"sup_min\": \"0.0\", \"burnin\": null, \"support\": {\"__class__\": \"RuntimeValue\"}, \"suptag\": null}, \"computing_robinson_foulds\": {\"tree_dist_all\": false, \"tree_dist\": {\"__class__\": \"RuntimeValue\"}, \"tree_dist2\": {\"__class__\": \"RuntimeValue\"}}, \"generating_random\": {\"r\": null, \"rand\": null, \"branch_min\": null, \"branch_mean\": null, \"branch_max\": null}, \"ancestral_state\": {\"ancestral\": false, \"asr_min\": null}, \"symmetry_test\": {\"symtest\": false, \"symtest_remove_bad\": false, \"symtest_remove_good\": false, \"symtest_type\": null, \"symtest_pval\": null, \"symtest_keep_zero\": false}, \"concordance_factor\": {\"gcf\": {\"__class__\": \"RuntimeValue\"}, \"df_tree\": false, \"scf\": null, \"cf_verbose\": false, \"cf_quartet\": false}}, \"__page__\": 0, \"__rerun_remap_job_id__\": null}",
                "tool_uuid": null,
                "tool_version": "2.4.0+galaxy1",
                "type": "tool",
                "uuid": "e7955eb4-bbeb-4572-9f15-d7c3a33b7e02",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "IQ-Tree per-segment report",
                        "output_name": "iqtree",
                        "uuid": "2768bd7f-fb74-444d-bfa6-090d4dbca22a"
                    },
                    {
                        "label": "IQ-Tree per-segment ML distance matrix",
                        "output_name": "mldist",
                        "uuid": "347a2034-e19b-45d1-9e0c-fc45cac59f32"
                    },
                    {
                        "label": "IQ-Tree per-segment ML tree",
                        "output_name": "treefile",
                        "uuid": "9a4a039a-1899-41d8-92cf-758be2211523"
                    }
                ]
            }
        },
        "tags": [
            "AIV",
            "virology"
        ],
        "uuid": "82ea5fad-0a20-4cf5-beb0-23f81c7795e7"
    },
    "workflow_job_input": {
        "References per segment collection": {
            "class": "Collection",
            "collection_type": "list",
            "elements": [
                {
                    "class": "File",
                    "identifier": "todo_element_name",
                    "path": "todo_test_data_path.ext"
                }
            ]
        },
        "Sequenced paired-end data": {
            "class": "Collection",
            "collection_type": "list",
            "elements": [
                {
                    "class": "File",
                    "identifier": "todo_element_name",
                    "path": "todo_test_data_path.ext"
                }
            ]
        }
    },
    "readme": "# Subtyping and consensus sequence generation for batches of Influenza A isolates\n\nThis workflow performs subtyping (with respect to the HA and NA genes) and consensus sequence generation for batches of Illumina PE sequenced Influenza isolates. It overcomes Influenza genome variability by compiling the best possible reference for read mapping from a collection of reference sequences for each viral genome segment. The workflow has been tested for Influenza A isolates only but should also work with other types if a suitable collection of per-segment reference sequences (see \"Input datasets\" below) is provided.\n\nIt uses:\n- **VAPOR** for identifying, from a collection of reference sequences of each of the eight viral genome segments, the individual segment sequences that match the sequencing data for each sample most closely\n- **fastp** for sequenced reads pre-processing,\n- **bwa mem** for mapping the preprocessed reads to a reference compiled from the best-matching segment sequences identified by *VAPOR*\n- **ivar consensus** for generating consensus sequences from the mapped reads data\n- **MAFFT** for generating multiple sequence alignments from the consensus sequences of the samples in a batch\n- **Snipit** and **IQ-Tree** for visualizing differences and analyzing relationships between sequences from a batch\n\nThe workflow provides a subtyping report, the consensus sequences arranged by gene segment or by sample, quality control at the level of sequenced reads and of mapping results, and batch-level visualization and phylogenetic insight.\n\n## Input datasets\n\n- **Sequenced paired-end data**: a list of pairs of sequencing datasets, one fw-/rv-reads pair per sequenced isolate\n- **References per segment collection**: this must be provided as a list of FASTA datasets, one for each Influenza genome segment to analyze. Each of these datasets should contain all reference sequences of the corresponding segment that you wish to use in the analysis.\n\n  **NOTE 1**: For subtyping to work correctly *all* FASTA sequence title lines in the input need to follow the scheme (note the use of both `|` and `/`):\n\n  `>[segment]|[influenza type]/[host]/[region]/[internal reference number]/[collection year]|subtype|[accession number]`\n\n  where `[host]` can be omitted for samples obtained from human patients.\n\n  Examples:\n\n  - `>NS|A/California/07/2009|H1N1|NC_026432.1` (for the NS segment sequence of a H1N1 sample obtained from a human patient in California in 2009)\n  - `>NA|A/chicken/Zimbabwe/AI4935/2017|H5N8|MF973227.1` (for the NA segment sequence of a H5N8 sample obtained from chicken in Zimbabwe in 2017)\n\n  **NOTE 2**: Sequences containing the ambiguity symbol N will be ignored by the workflow entirely.\n\n  **NOTE 3**: Datasets in this collection must not use colons (`:`) as part of their names.\n\n  **NOTE 4**: A well-formatted collection of Influenza A reference sequences suitable for most analysis needs is linked from the \"Data resources\" section of the page: https://virology.usegalaxy.eu/published/page?id=a04ab8d6ecb698fa. The underlying per-segment FASTA files to build the collection are deposited at https://doi.org/10.5281/zenodo.15364147.\n\n## Outputs:\n\n- **successful VAPOR runs - closest references**: a nested collection listing, for each sample and segment, the up to 500 best matching reference sequences according to VAPOR; inspect this collection if you are curious how many good matches to your data there were in the reference collection; useful for debugging, for example, if generated consensus sequences contain unresolved bases (Ns); missing segments or samples in this collection indicate that VAPOR failed to identify any matches for the respective item\n- **Subtyping results**: a table listing one sample and its detected subtype (with respect to the HA and NA segments) per row; missing subtype information for HA, NA or both segments is indicated by H?, N? and H?N?, respectively, in the corresponding sample line.\n- **Hybrid reference genomes used for mapping**: collection of compiled reference genomes (in FASTA format, one per sample) that served as input for bwa-mem; each reference genome consists of the genome segments from the reference collections that best matched the corresponding sample's sequencing data\n- **fastp reports**: QC and read trimming and filtering results from fastp\n- **Final read mapping results**: bwa-mem mapping results in BAM format post-processed with samtools view\n- **QC reports for mapping results**: a collection of reports of QC metrics for the \"Final read mapping results\" generated with Qualimap\n- **Per-sample consensus sequences**: a nested collection of consensus sequences organized first by sample, then by segment\n- **Per-segment consensus sequences with samples combined**: a collection of the same consensus sequences organized by segment; each collection element is a multi-sequence FASTA dataset with the segment-specific sequences of all samples\n- **Multiple sequence alignments per segment**: a collection of multiple sequence alignments generated with MAFFT from each of the \"Per-segment consensus sequences with samples combined\" above; generated only for segments for which at least two samples yielded a consensus sequence\n- **Snipit plots per segment**: a collection of SNP plots across samples generated with Snipit; one plot per segment; generated only for segments for which at least two samples yielded a consensus sequence; the first input sample will be used as the reference in the plot\n- **IQ-Tree per-segment ML tree**, **IQ-Tree per-segment ML distance matrix** and **IQ-Tree per-segment report**: collections of IQ-Tree ML trees, distance matrices and reports; each collection has one element per segment; generated  only for segments for which at least three samples yielded a consensus sequence\n\n## Related training material\n\nhttps://gxy.io/GTN:T00308 guides you through a simplified, manual analysis that still includes the key steps of this workflow.\n",
    "changelog": "# Changelog\n\n## [0.3] - 2026-02-09\n\n### Changed\n\n- Simplified the entire logic for handling samples for which reference selection\n  with VAPOR fails either entirely or for individual segments. The change\n  reduces the number of steps in this workflow considerably without affecting\n  functionality.\n\n  Note: This simplification requires the replacement dataset option added to the\n  \"Filter failed datasets\" tool in version 1.1.0, which first shipped\n  with Galaxy 25.0.\n\n  Thanks Simon Bray for adding the tool option!\n\n### Updated tools\n\n- `toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.24.1+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/1.1.0+galaxy0`.\n\n  With this tool update fastp gets executed with the --dont_eval_duplication\n  option, i.e. the fastp report will no longer contain the duplicate estimate\n  for the raw reads.\n  An estimate of duplicated reads based on mapping results is still available\n  as part of the \"QC reports for mapping results\" workflow output.\n\n- `toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.20+galaxy3` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.22+galaxy1`.\n- `toolshed.g2.bx.psu.edu/repos/iuc/vapor/vapor/1.0.2+galaxy3` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/vapor/vapor/1.0.3+galaxy0`.\n- `toolshed.g2.bx.psu.edu/repos/iuc/seqtk/seqtk_subseq/1.4+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/seqtk/seqtk_subseq/1.5+galaxy0`.\n- `toolshed.g2.bx.psu.edu/repos/rnateam/mafft/rbc_mafft/7.526+galaxy1` was updated to `toolshed.g2.bx.psu.edu/repos/rnateam/mafft/rbc_mafft/7.526+galaxy2`.\n- `toolshed.g2.bx.psu.edu/repos/iuc/snipit/snipit/1.6+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/snipit/snipit/1.7+galaxy0`.\n- `toolshed.g2.bx.psu.edu/repos/iuc/iqtree/iqtree/2.4.0+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/iqtree/iqtree/2.4.0+galaxy1`.\n- `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_text_file_with_recurring_lines/9.5+galaxy1` was updated to `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_text_file_with_recurring_lines/9.5+galaxy3`.\n- `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy3`.\n\n## [0.2] - 2025-05-02\n\n### Changed\n\nAaron Kolbecher, in the course of his Master thesis, discovered several\nedge-cases in which the previous version of the workflow would fail. The\ncorresponding fixes listed below make the workflow much more robust and ready\nfor use in high-throughput scenarios.\n\n- Added processing logic for handling diverse VAPOR failures.\n\n  Note: As a limitation of the new logic elements in the \"References per segment\"\n  collection can no longer contain colons (`:`) in their identifiers.\n\n- Improved subtyping report to handle cases of undetermined HA and/or NA subtypes.\n\n  The subtyping report will now contain H? and/or N? for unresolved subtypes.\n\n- Added logic for skipping multiple-sequence alignment of a genome segment if a\n  consensus sequence for that segment could be generated for only a single\n  sample (instead of causing a MAFFT error).\n\n- Added logic for skipping phylogenetic analysis with IQ-Tree for segments for\n  which fewer than three samples yielded a consensus sequence (instead of\n  causing an IQ-Tree error).\n\n  Note: IQ-Tree can still fail if a consensus sequence consists of Ns only.\n\n- No longer assume eight genome segments, but autodetect the number of segments\n  from the reference collection.\n\n  This makes it simpler to adapt the workflow to influenza species with seven\n  instead of eight segments, and makes it usable with partial reference\n  collections, for example if the purpose is to generate consensus sequences\n  only for certain segments of interest.\n\n- Added Aaron as a co-author of the workflow.\n\n- Changed license to AGPL-3.0-or-later.\n\n### Updated tools\n\n- `toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.23.4+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.24.1+galaxy0`.\n- `toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.18` was updated to `toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.19`.\n- `toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.15.1+galaxy2` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/samtools_view/samtools_view/1.20+galaxy3`.\n- `toolshed.g2.bx.psu.edu/repos/iuc/qualimap_bamqc/qualimap_bamqc/2.2.2d+galaxy3` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/qualimap_bamqc/qualimap_bamqc/2.3+galaxy0`.\n- `toolshed.g2.bx.psu.edu/repos/iuc/ivar_consensus/ivar_consensus/1.4.3+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/ivar_consensus/ivar_consensus/1.4.4+galaxy0`.\n- `toolshed.g2.bx.psu.edu/repos/rnateam/mafft/rbc_mafft/7.520+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/rnateam/mafft/rbc_mafft/7.526+galaxy1`.\n- `toolshed.g2.bx.psu.edu/repos/iuc/snipit/snipit/1.2+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/snipit/snipit/1.6+galaxy0`.\n- `toolshed.g2.bx.psu.edu/repos/iuc/iqtree/iqtree/2.3.3+galaxy0` was updated to `toolshed.g2.bx.psu.edu/repos/iuc/iqtree/iqtree/2.4.0+galaxy0`.\n- `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.3+galaxy1` was updated to `toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/9.5+galaxy0`.\n\n## [0.1] - 2025-01-09\n\nFirst release.\n",
    "diagrams": "# Workflow diagrams\n\n## Influenza A isolate subtyping and consensus sequence generation\n\n```mermaid\ngraph LR\n0[\"\u2139\ufe0f References per segment collection\"]@{ shape: docs }\n1[\"\u2139\ufe0f Sequenced paired-end data\"]@{ shape: docs }\n2[\"Create text file\"]@{ shape: process }\n3[\"Extract element identifiers\"]@{ shape: process }\n0 --> 3\n4[\"Extract element identifiers\"]@{ shape: process }\n1 --> 4\n5[\"fastp\"]@{ shape: process }\n1 --> 5\n6[\"Line/Word/Character count\"]@{ shape: process }\n3 --> 6\n7[\"Line/Word/Character count\"]@{ shape: process }\n4 --> 7\n8[\"Unzip collection\"]@{ shape: process }\n5 --> 8\n9[\"Parse parameter value\"]@{ shape: process }\n6 --> 9\n10[\"Parse parameter value\"]@{ shape: process }\n7 --> 10\n11[\"Duplicate file to collection\"]@{ shape: process }\n8 --> 11\n9 --> 11\n12[\"Duplicate file to collection\"]@{ shape: process }\n8 --> 12\n9 --> 12\n13[\"Duplicate file to collection\"]@{ shape: process }\n0 --> 13\n10 --> 13\n14[\"Apply rules\"]@{ shape: process }\n13 --> 14\n15[\"Relabel identifiers\"]@{ shape: process }\n4 --> 15\n14 --> 15\n16[\"VAPOR\"]@{ shape: process }\n15 --> 16\n11 --> 16\n12 --> 16\n17[\"Filter failed datasets\"]@{ shape: process }\n16 --> 17\n2 --> 17\n18[\"Replace\"]@{ shape: process }\n17 --> 18\n19[\"Select first\"]@{ shape: process }\n18 --> 19\n20[\"seqtk_subseq\"]@{ shape: process }\n15 --> 20\n19 --> 20\n21[\"Collapse Collection\"]@{ shape: process }\n19 --> 21\n22[\"Collapse Collection\"]@{ shape: process }\n20 --> 22\n23[\"Select\"]@{ shape: process }\n21 --> 23\n24[\"Select\"]@{ shape: process }\n21 --> 24\n25[\"Replace\"]@{ shape: process }\n22 --> 25\n26[\"Paste\"]@{ shape: process }\n23 --> 26\n24 --> 26\n27[\"Map with BWA-MEM\"]@{ shape: process }\n5 --> 27\n25 --> 27\n28[\"Collapse Collection\"]@{ shape: process }\n26 --> 28\n29[\"Filter failed datasets\"]@{ shape: process }\n27 --> 29\n30[\"Replace\"]@{ shape: process }\n28 --> 30\n31[\"Samtools view\"]@{ shape: process }\n29 --> 31\n32[\"Split BAM by reference\"]@{ shape: process }\n31 --> 32\n33[\"QualiMap BamQC\"]@{ shape: process }\n31 --> 33\n34[\"Apply rules\"]@{ shape: process }\n32 --> 34\n35[\"Extract element identifiers\"]@{ shape: process }\n34 --> 35\n36[\"Extract element identifiers\"]@{ shape: process }\n35 --> 36\n37[\"Replace\"]@{ shape: process }\n36 --> 37\n38[\"Relabel identifiers\"]@{ shape: process }\n37 --> 38\n34 --> 38\n39[\"Apply rules\"]@{ shape: process }\n38 --> 39\n40[\"Extract element identifiers\"]@{ shape: process }\n38 --> 40\n41[\"ivar consensus\"]@{ shape: process }\n39 --> 41\n42[\"Line/Word/Character count\"]@{ shape: process }\n40 --> 42\n43[\"Apply rules\"]@{ shape: process }\n41 --> 43\n44[\"Collapse Collection\"]@{ shape: process }\n42 --> 44\n45[\"Collapse Collection\"]@{ shape: process }\n43 --> 45\n46[\"Filter\"]@{ shape: process }\n44 --> 46\n47[\"Filter\"]@{ shape: process }\n44 --> 47\n48[\"Replace\"]@{ shape: process }\n45 --> 48\n49[\"Cut\"]@{ shape: process }\n46 --> 49\n50[\"Cut\"]@{ shape: process }\n47 --> 50\n51[\"Filter collection\"]@{ shape: process }\n49 --> 51\n48 --> 51\n52[\"MAFFT\"]@{ shape: process }\n51 --> 52\n53[\"Filter collection\"]@{ shape: process }\n50 --> 53\n52 --> 53\n54[\"snipit\"]@{ shape: process }\n52 --> 54\n55[\"IQ-TREE\"]@{ shape: process }\n53 --> 55\n```\n",
    "diagram_svg": "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1150 660\" role=\"img\" aria-label=\"Influenza A Consensus and Subtyping workflow diagram\">\n  <title>Influenza A Isolate Subtyping and Consensus Sequence Generation</title>\n  <desc>Pipeline for Influenza A analysis: fastp trimming, VAPOR-based reference selection and subtyping, BWA-MEM alignment to hybrid references, per-segment consensus with ivar, MAFFT alignment, snipit visualization, and IQ-TREE phylogenetics.</desc>\n\n  <defs>\n    <pattern id=\"grid\" width=\"20\" height=\"20\" patternUnits=\"userSpaceOnUse\">\n      <path d=\"M 20 0 L 0 0 0 20\" fill=\"none\" stroke=\"#c5d5e4\" stroke-width=\"0.5\"/>\n    </pattern>\n    <pattern id=\"grid-major\" width=\"100\" height=\"100\" patternUnits=\"userSpaceOnUse\">\n      <rect width=\"100\" height=\"100\" fill=\"url(#grid)\"/>\n      <path d=\"M 100 0 L 0 0 0 100\" fill=\"none\" stroke=\"#b0c4d8\" stroke-width=\"1\"/>\n    </pattern>\n    <style>\n      .connection { stroke: #25537b; stroke-width: 4; fill: none; stroke-linecap: round; }\n      .connection-qc { stroke: #25537b; stroke-width: 3; fill: none; stroke-linecap: round; stroke-dasharray: 5 3; }\n      .connection-secondary { stroke: #25537b; stroke-width: 3; fill: none; stroke-linecap: round; }\n      .node-card { filter: drop-shadow(1px 2px 3px rgba(0,0,0,0.15)); }\n    </style>\n  </defs>\n\n  <!-- Background -->\n  <rect width=\"1150\" height=\"660\" fill=\"#f8f9fa\"/>\n  <rect width=\"1150\" height=\"660\" fill=\"url(#grid-major)\"/>\n\n  <!-- Title bar -->\n  <rect x=\"0\" y=\"0\" width=\"1150\" height=\"45\" fill=\"#25537b\"/>\n  <text x=\"20\" y=\"28\" font-family=\"system-ui, sans-serif\" font-size=\"16\" font-weight=\"600\" fill=\"white\">Influenza A: Isolate Subtyping and Consensus Sequence Generation</text>\n\n  <!-- CONNECTIONS -->\n\n  <!-- References -> VAPOR -->\n  <path class=\"connection\" d=\"M 180 115 C 230 115, 240 135, 280 135\"/>\n  <!-- PE Reads -> fastp -->\n  <path class=\"connection\" d=\"M 180 235 C 230 235, 240 245, 280 245\"/>\n  <!-- fastp -> VAPOR -->\n  <path class=\"connection\" d=\"M 440 245 C 460 245, 260 155, 280 155\"/>\n  <!-- VAPOR -> Build hybrid ref -->\n  <path class=\"connection\" d=\"M 440 145 C 475 145, 470 145, 500 145\"/>\n  <!-- Build hybrid ref -> BWA-MEM -->\n  <path class=\"connection\" d=\"M 660 145 C 695 145, 690 155, 720 155\"/>\n  <!-- fastp -> BWA-MEM (reads) -->\n  <path class=\"connection\" d=\"M 440 245 C 500 245, 690 175, 720 175\"/>\n\n  <!-- BWA-MEM -> Samtools filter -->\n  <path class=\"connection\" d=\"M 880 165 C 910 165, 905 165, 930 165\"/>\n\n  <!-- Samtools filter -> Split by ref -->\n  <path class=\"connection\" d=\"M 930 210 C 920 260, 280 350, 310 370\"/>\n  <!-- Split by ref -> ivar consensus -->\n  <path class=\"connection\" d=\"M 470 370 C 510 370, 500 370, 540 370\"/>\n  <!-- ivar consensus -> MAFFT -->\n  <path class=\"connection\" d=\"M 700 370 C 740 370, 730 370, 760 370\"/>\n  <!-- MAFFT -> snipit -->\n  <path class=\"connection\" d=\"M 920 370 C 950 370, 945 340, 970 340\"/>\n  <!-- MAFFT -> IQ-TREE -->\n  <path class=\"connection\" d=\"M 920 390 C 950 390, 945 410, 970 410\"/>\n\n  <!-- QC connections -->\n  <path class=\"connection-qc\" d=\"M 810 210 C 810 340, 600 470, 560 485\"/>\n  <path class=\"connection-qc\" d=\"M 1000 210 C 1000 360, 620 470, 590 485\"/>\n\n  <!-- VAPOR -> Subtyping results (output) -->\n  <path class=\"connection\" d=\"M 440 110 C 460 100, 490 85, 510 80\"/>\n\n  <!-- NODES -->\n\n  <!-- INPUT: References -->\n  <g class=\"node-card\" transform=\"translate(30, 70)\">\n    <rect width=\"150\" height=\"90\" rx=\"4\" fill=\"white\" stroke=\"#ffd700\" stroke-width=\"1.5\"/>\n    <rect width=\"150\" height=\"28\" rx=\"4\" fill=\"#ffd700\"/>\n    <rect x=\"0\" y=\"24\" width=\"150\" height=\"4\" fill=\"#ffd700\"/>\n    <text x=\"10\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" fill=\"rgba(44,49,67,0.6)\">1:</text>\n    <text x=\"26\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"#2C3143\">References</text>\n    <text x=\"75\" y=\"55\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Per-segment refs</text>\n    <text x=\"75\" y=\"72\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">Collection of FASTA</text>\n    <circle cx=\"150\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#ffd700\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- INPUT: PE Reads -->\n  <g class=\"node-card\" transform=\"translate(30, 190)\">\n    <rect width=\"150\" height=\"90\" rx=\"4\" fill=\"white\" stroke=\"#ffd700\" stroke-width=\"1.5\"/>\n    <rect width=\"150\" height=\"28\" rx=\"4\" fill=\"#ffd700\"/>\n    <rect x=\"0\" y=\"24\" width=\"150\" height=\"4\" fill=\"#ffd700\"/>\n    <text x=\"10\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" fill=\"rgba(44,49,67,0.6)\">2:</text>\n    <text x=\"26\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"#2C3143\">PE Reads</text>\n    <text x=\"75\" y=\"55\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Paired-end reads</text>\n    <text x=\"75\" y=\"72\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">list:paired collection</text>\n    <circle cx=\"150\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#ffd700\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- PROCESSING: fastp -->\n  <g class=\"node-card\" transform=\"translate(280, 200)\">\n    <rect width=\"160\" height=\"90\" rx=\"4\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1\"/>\n    <rect width=\"160\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"24\" width=\"160\" height=\"4\" fill=\"#25537b\"/>\n    <text x=\"10\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" fill=\"rgba(255,255,255,0.7)\">3:</text>\n    <text x=\"26\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\">fastp</text>\n    <text x=\"80\" y=\"55\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Quality trimming</text>\n    <text x=\"80\" y=\"72\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">Adapter removal</text>\n    <circle cx=\"0\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n    <circle cx=\"160\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- PROCESSING: VAPOR -->\n  <g class=\"node-card\" transform=\"translate(280, 90)\">\n    <rect width=\"160\" height=\"90\" rx=\"4\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1\"/>\n    <rect width=\"160\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"24\" width=\"160\" height=\"4\" fill=\"#25537b\"/>\n    <text x=\"10\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" fill=\"rgba(255,255,255,0.7)\">4:</text>\n    <text x=\"26\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\">VAPOR</text>\n    <text x=\"80\" y=\"55\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Reference selection</text>\n    <text x=\"80\" y=\"72\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">Closest match per seg</text>\n    <circle cx=\"0\" cy=\"35\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n    <circle cx=\"0\" cy=\"65\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n    <circle cx=\"160\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- PROCESSING: Build hybrid reference -->\n  <g class=\"node-card\" transform=\"translate(500, 100)\">\n    <rect width=\"160\" height=\"90\" rx=\"4\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1\"/>\n    <rect width=\"160\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"24\" width=\"160\" height=\"4\" fill=\"#25537b\"/>\n    <text x=\"10\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" fill=\"rgba(255,255,255,0.7)\">5:</text>\n    <text x=\"26\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\">Hybrid Reference</text>\n    <text x=\"80\" y=\"55\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Build per-sample</text>\n    <text x=\"80\" y=\"72\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">Multi-segment ref</text>\n    <circle cx=\"0\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n    <circle cx=\"160\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- OUTPUT: Subtyping results -->\n  <g class=\"node-card\" transform=\"translate(510, 55)\">\n    <rect width=\"130\" height=\"50\" rx=\"4\" fill=\"white\" stroke=\"#f97316\" stroke-width=\"1.5\"/>\n    <rect width=\"130\" height=\"22\" rx=\"4\" fill=\"#f97316\"/>\n    <rect x=\"0\" y=\"18\" width=\"130\" height=\"4\" fill=\"#f97316\"/>\n    <text x=\"65\" y=\"15\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" font-weight=\"600\" fill=\"white\">Subtyping</text>\n    <text x=\"65\" y=\"38\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">HA/NA classification</text>\n    <circle cx=\"0\" cy=\"25\" r=\"5\" fill=\"white\" stroke=\"#f97316\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- PROCESSING: BWA-MEM -->\n  <g class=\"node-card\" transform=\"translate(720, 120)\">\n    <rect width=\"160\" height=\"90\" rx=\"4\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1\"/>\n    <rect width=\"160\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"24\" width=\"160\" height=\"4\" fill=\"#25537b\"/>\n    <text x=\"10\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" fill=\"rgba(255,255,255,0.7)\">6:</text>\n    <text x=\"26\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\">BWA-MEM</text>\n    <text x=\"80\" y=\"55\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Read alignment</text>\n    <text x=\"80\" y=\"72\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">To hybrid reference</text>\n    <circle cx=\"0\" cy=\"35\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n    <circle cx=\"0\" cy=\"55\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n    <circle cx=\"160\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n    <circle cx=\"90\" cy=\"90\" r=\"5\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1.5\"/>\n  </g>\n\n  <!-- PROCESSING: Samtools filter -->\n  <g class=\"node-card\" transform=\"translate(930, 120)\">\n    <rect width=\"160\" height=\"90\" rx=\"4\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1\"/>\n    <rect width=\"160\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"24\" width=\"160\" height=\"4\" fill=\"#25537b\"/>\n    <text x=\"10\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" fill=\"rgba(255,255,255,0.7)\">7:</text>\n    <text x=\"26\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\">Filter + Split</text>\n    <text x=\"80\" y=\"55\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Samtools filter</text>\n    <text x=\"80\" y=\"72\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">Split by segment</text>\n    <circle cx=\"0\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n    <circle cx=\"80\" cy=\"90\" r=\"5\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1.5\"/>\n  </g>\n\n  <!-- ROW 2: Split by ref -->\n  <g class=\"node-card\" transform=\"translate(310, 325)\">\n    <rect width=\"160\" height=\"90\" rx=\"4\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1\"/>\n    <rect width=\"160\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"24\" width=\"160\" height=\"4\" fill=\"#25537b\"/>\n    <text x=\"10\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" fill=\"rgba(255,255,255,0.7)\">8:</text>\n    <text x=\"26\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\">Per-Segment BAM</text>\n    <text x=\"80\" y=\"55\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">BAMtools split</text>\n    <text x=\"80\" y=\"72\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">By reference</text>\n    <circle cx=\"0\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n    <circle cx=\"160\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- ivar consensus -->\n  <g class=\"node-card\" transform=\"translate(540, 325)\">\n    <rect width=\"160\" height=\"90\" rx=\"4\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1\"/>\n    <rect width=\"160\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"24\" width=\"160\" height=\"4\" fill=\"#25537b\"/>\n    <text x=\"10\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" fill=\"rgba(255,255,255,0.7)\">9:</text>\n    <text x=\"26\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\">ivar Consensus</text>\n    <text x=\"80\" y=\"55\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Per-segment</text>\n    <text x=\"80\" y=\"72\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">Consensus sequences</text>\n    <circle cx=\"0\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n    <circle cx=\"160\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- MAFFT -->\n  <g class=\"node-card\" transform=\"translate(760, 325)\">\n    <rect width=\"160\" height=\"90\" rx=\"4\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1\"/>\n    <rect width=\"160\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"24\" width=\"160\" height=\"4\" fill=\"#25537b\"/>\n    <text x=\"10\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" fill=\"rgba(255,255,255,0.7)\">10:</text>\n    <text x=\"30\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\">MAFFT</text>\n    <text x=\"80\" y=\"55\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Multiple alignment</text>\n    <text x=\"80\" y=\"72\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">Per segment</text>\n    <circle cx=\"0\" cy=\"45\" r=\"6\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"2\"/>\n    <circle cx=\"160\" cy=\"20\" r=\"5\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1.5\"/>\n    <circle cx=\"160\" cy=\"65\" r=\"5\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1.5\"/>\n  </g>\n\n  <!-- OUTPUT: snipit plots -->\n  <g class=\"node-card\" transform=\"translate(970, 300)\">\n    <rect width=\"140\" height=\"55\" rx=\"4\" fill=\"white\" stroke=\"#f97316\" stroke-width=\"1.5\"/>\n    <rect width=\"140\" height=\"22\" rx=\"4\" fill=\"#f97316\"/>\n    <rect x=\"0\" y=\"18\" width=\"140\" height=\"4\" fill=\"#f97316\"/>\n    <text x=\"70\" y=\"15\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" font-weight=\"600\" fill=\"white\">Snipit Plots</text>\n    <text x=\"70\" y=\"38\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">SNP visualizations</text>\n    <text x=\"70\" y=\"50\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"8\" fill=\"#868e96\">Per segment</text>\n    <circle cx=\"0\" cy=\"25\" r=\"5\" fill=\"white\" stroke=\"#f97316\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- OUTPUT: IQ-TREE -->\n  <g class=\"node-card\" transform=\"translate(970, 375)\">\n    <rect width=\"140\" height=\"55\" rx=\"4\" fill=\"white\" stroke=\"#f97316\" stroke-width=\"1.5\"/>\n    <rect width=\"140\" height=\"22\" rx=\"4\" fill=\"#f97316\"/>\n    <rect x=\"0\" y=\"18\" width=\"140\" height=\"4\" fill=\"#f97316\"/>\n    <text x=\"70\" y=\"15\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" font-weight=\"600\" fill=\"white\">ML Trees</text>\n    <text x=\"70\" y=\"38\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">IQ-TREE phylogenies</text>\n    <text x=\"70\" y=\"50\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"8\" fill=\"#868e96\">Per segment</text>\n    <circle cx=\"0\" cy=\"25\" r=\"5\" fill=\"white\" stroke=\"#f97316\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- REPORT: QC -->\n  <g class=\"node-card\" transform=\"translate(510, 475)\">\n    <rect width=\"160\" height=\"80\" rx=\"4\" fill=\"white\" stroke=\"#10b981\" stroke-width=\"1.5\"/>\n    <rect width=\"160\" height=\"28\" rx=\"4\" fill=\"#10b981\"/>\n    <rect x=\"0\" y=\"24\" width=\"160\" height=\"4\" fill=\"#10b981\"/>\n    <text x=\"80\" y=\"19\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\">QC Reports</text>\n    <text x=\"80\" y=\"52\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">QualiMap BamQC</text>\n    <text x=\"80\" y=\"68\" text-anchor=\"middle\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\">Mapping quality</text>\n    <circle cx=\"50\" cy=\"0\" r=\"5\" fill=\"white\" stroke=\"#10b981\" stroke-width=\"1.5\"/>\n    <circle cx=\"80\" cy=\"0\" r=\"5\" fill=\"white\" stroke=\"#10b981\" stroke-width=\"1.5\"/>\n  </g>\n\n  <!-- Legend -->\n  <g transform=\"translate(30, 625)\">\n    <text x=\"0\" y=\"0\" font-family=\"system-ui, sans-serif\" font-size=\"10\" font-weight=\"600\" fill=\"#495057\">Legend:</text>\n    <rect x=\"60\" y=\"-10\" width=\"14\" height=\"14\" rx=\"2\" fill=\"white\" stroke=\"#ffd700\" stroke-width=\"1.5\"/>\n    <text x=\"80\" y=\"0\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#6c757d\">Input</text>\n    <rect x=\"130\" y=\"-10\" width=\"14\" height=\"14\" rx=\"2\" fill=\"white\" stroke=\"#25537b\" stroke-width=\"1.5\"/>\n    <text x=\"150\" y=\"0\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#6c757d\">Processing</text>\n    <line x1=\"230\" y1=\"-4\" x2=\"270\" y2=\"-4\" stroke=\"#25537b\" stroke-width=\"4\" stroke-linecap=\"round\"/>\n    <text x=\"278\" y=\"0\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#6c757d\">Data flow</text>\n    <line x1=\"350\" y1=\"-4\" x2=\"390\" y2=\"-4\" stroke=\"#25537b\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-dasharray=\"5 3\"/>\n    <text x=\"398\" y=\"0\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#6c757d\">QC metrics</text>\n    <rect x=\"480\" y=\"-10\" width=\"14\" height=\"14\" rx=\"2\" fill=\"white\" stroke=\"#f97316\" stroke-width=\"1.5\"/>\n    <text x=\"500\" y=\"0\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#6c757d\">Output</text>\n    <rect x=\"560\" y=\"-10\" width=\"14\" height=\"14\" rx=\"2\" fill=\"white\" stroke=\"#10b981\" stroke-width=\"1.5\"/>\n    <text x=\"580\" y=\"0\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#6c757d\">Report</text>\n  </g>\n\n</svg>",
    "updated": "2026-02-09T00:00:00",
    "trsID": "#workflow/github.com/iwc-workflows/influenza-isolates-consensus-and-subtyping/main",
    "iwcID": "influenza-isolates-consensus-and-subtyping-main",
    "dockstore_id": 30392,
    "categories": [],
    "collections": [
        "Virology"
    ],
    "doi": "10.5281/zenodo.15078914",
    "tests": [
        {
            "doc": "Test outline for influenza-isolate-subtyping.ga",
            "job": {
                "References per segment collection": {
                    "class": "Collection",
                    "collection_type": "list",
                    "elements": [
                        {
                            "class": "File",
                            "identifier": "ref_4_ha",
                            "location": "https://zenodo.org/records/14628364/files/ref_4_ha.fasta",
                            "filetype": "fasta"
                        },
                        {
                            "class": "File",
                            "identifier": "ref_6_na",
                            "location": "https://zenodo.org/records/14628364/files/ref_6_na.fasta",
                            "filetype": "fasta"
                        }
                    ]
                },
                "Sequenced paired-end data": {
                    "class": "Collection",
                    "collection_type": "list:paired",
                    "elements": [
                        {
                            "class": "Collection",
                            "type": "paired",
                            "identifier": "SRR24839074",
                            "elements": [
                                {
                                    "identifier": "forward",
                                    "class": "File",
                                    "location": "https://zenodo.org/records/14628364/files/SRR24839074_1.fastq.gz",
                                    "filetype": "fastqsanger.gz"
                                },
                                {
                                    "identifier": "reverse",
                                    "class": "File",
                                    "location": "https://zenodo.org/records/14628364/files/SRR24839074_2.fastq.gz",
                                    "filetype": "fastqsanger.gz"
                                }
                            ]
                        },
                        {
                            "class": "Collection",
                            "type": "paired",
                            "identifier": "SRR6674560",
                            "elements": [
                                {
                                    "identifier": "forward",
                                    "class": "File",
                                    "location": "https://zenodo.org/records/14628364/files/SRR6674560_1.fastq.gz",
                                    "filetype": "fastqsanger.gz"
                                },
                                {
                                    "identifier": "reverse",
                                    "class": "File",
                                    "location": "https://zenodo.org/records/14628364/files/SRR6674560_2.fastq.gz",
                                    "filetype": "fastqsanger.gz"
                                }
                            ]
                        }
                    ]
                }
            },
            "outputs": {
                "Subtyping results": {
                    "asserts": {
                        "has_n_lines": {
                            "n": 2
                        },
                        "has_n_columns": {
                            "n": 2
                        },
                        "has_text": {
                            "text": "SRR24839074\tH5N1"
                        }
                    }
                },
                "fastp reports": {
                    "element_tests": {
                        "SRR6674560": {
                            "asserts": {
                                "has_text": {
                                    "text": "<tr><td class='col1'>total reads:</td><td class='col2'>345.266000 K</td></tr>"
                                }
                            }
                        }
                    }
                },
                "successful VAPOR runs - closest references": {
                    "element_tests": {
                        "SRR6674560": {
                            "elements": {
                                "ref_4_ha": {
                                    "asserts": {
                                        "has_text": {
                                            "text": "0.9841269841269841\t12086844.0\t1701\t7105.728395061728\t60503\t>HA|A/Texas/50/2012|A/H3N2|KJ942616.1"
                                        }
                                    }
                                },
                                "ref_6_na": {
                                    "asserts": {
                                        "has_text": {
                                            "text": "0.9929078014184397\t6978768.0\t1410\t4949.4808510638295\t34375\t>NA|A/Texas/50/2012|A/H3N2|KJ942618.1"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "Per-sample consensus sequences": {
                    "element_tests": {
                        "SRR6674560": {
                            "elements": {
                                "HA": {
                                    "asserts": {
                                        "has_text": {
                                            "text": ">Consensus_HA_threshold_0.7_quality_20"
                                        }
                                    }
                                },
                                "NA": {
                                    "asserts": {
                                        "has_text": {
                                            "text": ">Consensus_NA_threshold_0.7_quality_20"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "Per-segment consensus sequences with samples combined": {
                    "element_tests": {
                        "HA": {
                            "asserts": {
                                "has_text": {
                                    "text": ">SRR24839074|HA"
                                }
                            }
                        },
                        "NA": {
                            "asserts": {
                                "has_text": {
                                    "text": ">SRR24839074|NA"
                                }
                            }
                        }
                    }
                },
                "Snipit plots per segment": {
                    "element_tests": {
                        "HA": {
                            "asserts": {
                                "has_size": {
                                    "value": 854000,
                                    "delta": 10000
                                }
                            }
                        },
                        "NA": {
                            "asserts": {
                                "has_size": {
                                    "value": 730000,
                                    "delta": 10000
                                }
                            }
                        }
                    }
                }
            }
        }
    ]
}