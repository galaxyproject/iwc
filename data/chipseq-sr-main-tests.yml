- doc: Test outline for ChIPseq_SR
  job:
    Adapter sequence: GATCGGAAGAGCACACGTCTGAACTCCAGTCAC
    Effective genome size: 1870000000
    Normalize profile: true
    Percentage of bad quality bases per read: 70
    Reference genome: mm10
    SR fastq input:
      class: Collection
      collection_type: list
      elements:
      - class: File
        filetype: fastqsanger.gz
        hashes:
        - hash_function: SHA-1
          hash_value: 60cef994485a6bddf9e2b7efca464efc34559c12
        identifier: wt_H3K4me3
        location: https://zenodo.org/record/1324070/files/wt_H3K4me3_read1.fastq.gz
  outputs:
    MACS2 narrowPeak:
      element_tests:
        wt_H3K4me3:
          asserts:
            has_n_lines:
              n: 9
    MACS2 peaks:
      element_tests:
        wt_H3K4me3:
          asserts:
          - text: '# effective genome size = 1.87e+09'
            that: has_text
          - text: '# d = 200'
            that: has_text
          - text: '# tags after filtering in treatment: 44528'
            that: has_text
    MACS2 report:
      element_tests:
        wt_H3K4me3:
          asserts:
          - text: '# effective genome size = 1.87e+09'
            that: has_text
          - text: '# d = 200'
            that: has_text
          - text: '# tags after filtering in treatment: 44528'
            that: has_text
    MACS2 summits:
      element_tests:
        wt_H3K4me3:
          asserts:
            has_n_lines:
              n: 9
    'MultiQC on input dataset(s): Stats':
      asserts:
        has_line:
          line: "Sample\tmacs2-d\tmacs2-treatment_redundant_rate\tmacs2-peak_count\t\
            bowtie_2_hisat2-overall_alignment_rate\tfastp-pct_duplication\tfastp-after_filtering_q30_rate\t\
            fastp-after_filtering_q30_bases\tfastp-filtering_result_passed_filter_reads\t\
            fastp-after_filtering_gc_content\tfastp-pct_surviving\tfastp-pct_adapter"
        has_text_matching:
          expression: "wt_H3K4me3\t200.0\t0.0\t9\t98.[0-9]*\t0.22[0-9]*\t93.[0-9]*\t\
            2.3[0-9]*\t0.049[0-9]*\t57.[0-9]*\t99.[0-9]*\t0.12[0-9]*"
    MultiQC webpage:
      asserts:
      - text: wt_H3K4me3
        that: has_text
      - text: <a href="#fastp" class="nav-l1">fastp</a>
        that: has_text
      - text: <a href="#bowtie2" class="nav-l1">Bowtie 2 / HiSAT2</a>
        that: has_text
    coverage from MACS2:
      element_tests:
        wt_H3K4me3:
          asserts:
            has_size:
              delta: 10000
              value: 563563
    filtered BAM:
      element_tests:
        wt_H3K4me3:
          asserts:
            has_size:
              delta: 200000
              value: 2587182
    mapping stats:
      element_tests:
        wt_H3K4me3:
          asserts:
          - text: '49813 reads; of these:'
            that: has_text
          - text: 44357 (89.05%) aligned exactly 1 time
            that: has_text
          - text: 98.27% overall alignment rate
            that: has_text
