{
    "name": "main",
    "subclass": "Galaxy",
    "publish": true,
    "primaryDescriptorPath": "/segmentation-and-counting.ga",
    "testParameterFiles": [
        "/segmentation-and-counting-tests.yml"
    ],
    "authors": [
        {
            "name": "Leonid Kostrykin",
            "orcid": "0000-0003-1323-3762",
            "url": "https://github.com/kostrykin/"
        }
    ],
    "definition": {
        "a_galaxy_workflow": "true",
        "annotation": "This workflow performs segmentation and counting of cell nuclei using fluorescence microscopy images. The segmentation step is performed using Otsu thresholding (Otsu, 1979). The workflow is based on the tutorial: https://training.galaxyproject.org/training-material/topics/imaging/tutorials/imaging-introduction/tutorial.html",
        "creator": [
            {
                "class": "Person",
                "identifier": "https://orcid.org/0000-0003-1323-3762",
                "name": "Leonid Kostrykin",
                "url": "https://github.com/kostrykin/"
            }
        ],
        "format-version": "0.1",
        "license": "MIT",
        "release": "0.2",
        "name": "Segmentation and counting of cell nuclei in fluorescence microscopy images",
        "steps": {
            "0": {
                "annotation": "The fluorescence microscopy images to be segmented. Must be the single image channel, which contains the cell nuclei.",
                "content_id": null,
                "errors": null,
                "id": 0,
                "input_connections": {},
                "inputs": [
                    {
                        "description": "The fluorescence microscopy images to be segmented. Must be the single image channel, which contains the cell nuclei.",
                        "name": "input_image"
                    }
                ],
                "label": "input_image",
                "name": "Input dataset",
                "outputs": [],
                "position": {
                    "left": 0,
                    "top": 123.6936084329719
                },
                "tool_id": null,
                "tool_state": "{\"optional\": false, \"tag\": null}",
                "tool_version": null,
                "type": "data_input",
                "uuid": "facec436-5d6e-43de-a21e-cebc8272a35c",
                "when": null,
                "workflow_outputs": []
            },
            "1": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/imgteam/2d_simple_filter/ip_filter_standard/1.12.0+galaxy1",
                "errors": null,
                "id": 1,
                "input_connections": {
                    "input": {
                        "id": 0,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Filter 2-D image",
                "outputs": [
                    {
                        "name": "output",
                        "type": "tiff"
                    }
                ],
                "position": {
                    "left": 320.6808544907898,
                    "top": 244.80388558482915
                },
                "post_job_actions": {},
                "tool_id": "toolshed.g2.bx.psu.edu/repos/imgteam/2d_simple_filter/ip_filter_standard/1.12.0+galaxy1",
                "tool_shed_repository": {
                    "changeset_revision": "d51310ab328a",
                    "name": "2d_simple_filter",
                    "owner": "imgteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"__input_ext\": \"tiff\", \"chromInfo\": \"/opt/galaxy/tool-data/shared/ucsc/chrom/?.len\", \"filter\": {\"filter_type\": \"gaussian\", \"__current_case__\": 0, \"size\": \"3.0\"}, \"filter_type\": \"gaussian\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"radius\": \"3\", \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "1.12.0+galaxy1",
                "type": "tool",
                "uuid": "0c652b2d-7376-4444-b4c4-70babd1a0f14",
                "when": null,
                "workflow_outputs": []
            },
            "2": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/imgteam/2d_histogram_equalization/ip_histogram_equalization/0.18.1+galaxy0",
                "errors": null,
                "id": 2,
                "input_connections": {
                    "input": {
                        "id": 0,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Perform histogram equalization",
                "outputs": [
                    {
                        "name": "output",
                        "type": "tiff"
                    }
                ],
                "position": {
                    "left": 438.81238880324617,
                    "top": 9.67052833486391
                },
                "post_job_actions": {},
                "tool_id": "toolshed.g2.bx.psu.edu/repos/imgteam/2d_histogram_equalization/ip_histogram_equalization/0.18.1+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "b1c2c210813c",
                    "name": "2d_histogram_equalization",
                    "owner": "imgteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"__input_ext\": \"tiff\", \"chromInfo\": \"/opt/galaxy/tool-data/shared/ucsc/chrom/?.len\", \"h_type\": \"clahe\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "0.18.1+galaxy0",
                "type": "tool",
                "uuid": "c4b63332-c0ed-4a40-9670-9d5ba2a5e88f",
                "when": null,
                "workflow_outputs": []
            },
            "3": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/imgteam/2d_auto_threshold/ip_threshold/0.18.1+galaxy3",
                "errors": null,
                "id": 3,
                "input_connections": {
                    "input": {
                        "id": 1,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Threshold image",
                "outputs": [
                    {
                        "name": "output",
                        "type": "tiff"
                    }
                ],
                "position": {
                    "left": 565.4531507696091,
                    "top": 243.376959571321
                },
                "post_job_actions": {},
                "tool_id": "toolshed.g2.bx.psu.edu/repos/imgteam/2d_auto_threshold/ip_threshold/0.18.1+galaxy3",
                "tool_shed_repository": {
                    "changeset_revision": "699a5e9146b3",
                    "name": "2d_auto_threshold",
                    "owner": "imgteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"__input_ext\": \"input\", \"block_size\": \"5\", \"chromInfo\": \"/opt/galaxy/tool-data/shared/ucsc/chrom/?.len\", \"dark_bg\": \"true\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"invert_output\": false, \"th_method\": {\"method_id\": \"otsu\", \"__current_case__\": 1, \"threshold\": \"0\", \"block_size\": \"0\", \"offset\": \"0.0\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "0.18.1+galaxy3",
                "type": "tool",
                "uuid": "d75a2027-d855-4f05-9261-25f2f712efce",
                "when": null,
                "workflow_outputs": []
            },
            "4": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/imgteam/bfconvert/ip_convertimage/6.7.0+galaxy3",
                "errors": null,
                "id": 4,
                "input_connections": {
                    "input_file": {
                        "id": 2,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Convert image format",
                "outputs": [
                    {
                        "name": "output",
                        "type": "tiff"
                    }
                ],
                "position": {
                    "left": 689.7987516288889,
                    "top": 0
                },
                "post_job_actions": {},
                "tool_id": "toolshed.g2.bx.psu.edu/repos/imgteam/bfconvert/ip_convertimage/6.7.0+galaxy3",
                "tool_shed_repository": {
                    "changeset_revision": "fcadded98e61",
                    "name": "bfconvert",
                    "owner": "imgteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"__input_ext\": \"tiff\", \"bigtiff\": false, \"channel_options\": {\"extract\": \"False\", \"__current_case__\": 0}, \"chromInfo\": \"/opt/galaxy/tool-data/shared/ucsc/chrom/?.len\", \"compression\": \"False\", \"crop_options\": {\"extract\": \"False\", \"__current_case__\": 0}, \"input_file\": {\"__class__\": \"ConnectedValue\"}, \"noflat\": true, \"out_format\": \"png\", \"pyramid_options\": {\"generate\": \"False\", \"__current_case__\": 1}, \"range_options\": {\"extract\": \"False\", \"__current_case__\": 0}, \"series_options\": {\"extract\": \"False\", \"__current_case__\": 0}, \"tile_options\": {\"extract\": \"False\", \"__current_case__\": 0}, \"timepoint_options\": {\"extract\": \"False\", \"__current_case__\": 0}, \"z_options\": {\"extract\": \"False\", \"__current_case__\": 0}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "6.7.0+galaxy3",
                "type": "tool",
                "uuid": "a6a689c6-c1d0-4929-87a2-ac5206cf8026",
                "when": null,
                "workflow_outputs": []
            },
            "5": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/imgteam/binary2labelimage/ip_binary_to_labelimage/0.5+galaxy0",
                "errors": null,
                "id": 5,
                "input_connections": {
                    "input": {
                        "id": 3,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Convert binary image to label map",
                "outputs": [
                    {
                        "name": "output",
                        "type": "tiff"
                    }
                ],
                "position": {
                    "left": 812.10278473575,
                    "top": 245.5611328413049
                },
                "post_job_actions": {},
                "tool_id": "toolshed.g2.bx.psu.edu/repos/imgteam/binary2labelimage/ip_binary_to_labelimage/0.5+galaxy0",
                "tool_shed_repository": {
                    "changeset_revision": "984358e43242",
                    "name": "binary2labelimage",
                    "owner": "imgteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"__input_ext\": \"tiff\", \"chromInfo\": \"/opt/galaxy/tool-data/shared/ucsc/chrom/?.len\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"mode\": {\"mode_selector\": \"cca\", \"__current_case__\": 0}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "0.5+galaxy0",
                "type": "tool",
                "uuid": "cd899592-8b30-4a79-9aba-f75a10c75dd7",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "label_image",
                        "output_name": "output",
                        "uuid": "daaee143-81e0-4067-aac0-81f02732c343"
                    }
                ]
            },
            "6": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/imgteam/overlay_images/ip_overlay_images/0.0.4+galaxy4",
                "errors": null,
                "id": 6,
                "input_connections": {
                    "method_option|im1": {
                        "id": 4,
                        "output_name": "output"
                    },
                    "method_option|im2": {
                        "id": 5,
                        "output_name": "output"
                    }
                },
                "inputs": [
                    {
                        "description": "runtime parameter for tool Overlay images",
                        "name": "method_option"
                    },
                    {
                        "description": "runtime parameter for tool Overlay images",
                        "name": "method_option"
                    }
                ],
                "label": null,
                "name": "Overlay images",
                "outputs": [
                    {
                        "name": "out_png",
                        "type": "png"
                    }
                ],
                "position": {
                    "left": 1085.3470167429655,
                    "top": 104.58436042741572
                },
                "post_job_actions": {},
                "tool_id": "toolshed.g2.bx.psu.edu/repos/imgteam/overlay_images/ip_overlay_images/0.0.4+galaxy4",
                "tool_shed_repository": {
                    "changeset_revision": "ca362a9bfa20",
                    "name": "overlay_images",
                    "owner": "imgteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"__input_ext\": \"input\", \"chromInfo\": \"/opt/galaxy/tool-data/shared/ucsc/chrom/?.len\", \"method_option\": {\"method\": \"seg_contour\", \"__current_case__\": 2, \"im1\": {\"__class__\": \"ConnectedValue\"}, \"im2\": {\"__class__\": \"ConnectedValue\"}, \"thickness\": \"2\", \"color\": \"#ff0000\", \"show_label\": true, \"label_color\": \"#ffff00\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "0.0.4+galaxy4",
                "type": "tool",
                "uuid": "066a4e0d-2ae3-46f7-a0c8-77a1a83d119a",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "overlay_image",
                        "output_name": "out_png",
                        "uuid": "5b94aaa3-9034-465e-995f-3d8f1f057f4b"
                    }
                ]
            },
            "7": {
                "annotation": "",
                "content_id": "toolshed.g2.bx.psu.edu/repos/imgteam/count_objects/ip_count_objects/0.0.5-2",
                "errors": null,
                "id": 7,
                "input_connections": {
                    "input": {
                        "id": 5,
                        "output_name": "output"
                    }
                },
                "inputs": [],
                "label": null,
                "name": "Count objects in label map",
                "outputs": [
                    {
                        "name": "output",
                        "type": "tabular"
                    }
                ],
                "position": {
                    "left": 1086.8749834881503,
                    "top": 370.25000974083935
                },
                "post_job_actions": {},
                "tool_id": "toolshed.g2.bx.psu.edu/repos/imgteam/count_objects/ip_count_objects/0.0.5-2",
                "tool_shed_repository": {
                    "changeset_revision": "b58447a2eed2",
                    "name": "count_objects",
                    "owner": "imgteam",
                    "tool_shed": "toolshed.g2.bx.psu.edu"
                },
                "tool_state": "{\"__input_ext\": \"tiff\", \"chromInfo\": \"/opt/galaxy/tool-data/shared/ucsc/chrom/?.len\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}",
                "tool_version": "0.0.5-2",
                "type": "tool",
                "uuid": "75a4d4d8-0435-441f-a309-d04071cf125f",
                "when": null,
                "workflow_outputs": [
                    {
                        "label": "objects_count",
                        "output_name": "output",
                        "uuid": "8b3d51a7-2c1f-4f84-ac80-ef0ef6d25a3f"
                    }
                ]
            }
        },
        "tags": [],
        "uuid": "8c2d765b-2764-4b66-8542-adc2109c24f2",
        "version": 10
    },
    "workflow_job_input": {
        "input_image": {
            "class": "File",
            "path": "todo_test_data_path.ext"
        }
    },
    "readme": "# Segmentation and counting of cell nuclei in fluorescence microscopy images\n\nThis workflow performs segmentation and counting of cell nuclei using fluorescence microscopy images. The segmentation step is performed using Otsu thresholding (Otsu, 1979). The workflow is based on the tutorial: https://training.galaxyproject.org/training-material/topics/imaging/tutorials/imaging-introduction/tutorial.html\n\n![](test-data/overlay_image.png)\n\n## Inputs\n\n**`input_image`:** The fluorescence microscopy images to be segmented. Must be the single image channel, which contains the cell nuclei.\n\n## Outputs\n\n**`overlay_image`:** An overlay of the original image and the outlines of the segmentated objects, each also annotated with a unique number.\n\n**`objects_count`:** Table with a single column `objects` and a single row (the actual number of objects).\n\n**`label_image`:** The segmentation result (label map, which contains a unique label for each segmented object).\n",
    "changelog": "# Changelog\n\n## [0.2] - 2024-11-07\n\n- Upgrade the tests of the workflow\n- Upgrade the segmentation-and-counting.ga workflow to recent tool versions\n\n## [0.1] - 2024-02-29\n\n",
    "diagrams": "# Workflow diagrams\n\n## Segmentation and counting of cell nuclei in fluorescence microscopy images\n\n```mermaid\ngraph LR\n0[\"\u2139\ufe0f input_image\"]@{ shape: doc }\n1[\"Filter 2-D image\"]@{ shape: process }\n0 --> 1\n2[\"Perform histogram equalization\"]@{ shape: process }\n0 --> 2\n3[\"Threshold image\"]@{ shape: process }\n1 --> 3\n4[\"Convert image format\"]@{ shape: process }\n2 --> 4\n5[\"Convert binary image to label map\"]@{ shape: process }\n3 --> 5\n6[\"Overlay images\"]@{ shape: process }\n4 --> 6\n5 --> 6\n7[\"Count objects in label map\"]@{ shape: process }\n5 --> 7\n```\n",
    "diagram_svg": "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1100 530\" role=\"img\" aria-label=\"Fluorescence nuclei segmentation and counting workflow diagram\">\n  <title>Segmentation and Counting of Cell Nuclei in Fluorescence Microscopy</title>\n  <desc>Image analysis pipeline: Gaussian filtering, Otsu thresholding, binary to label map conversion, nuclei counting, histogram equalization, and overlay visualization.</desc>\n\n  <defs>\n    <pattern id=\"grid\" width=\"20\" height=\"20\" patternUnits=\"userSpaceOnUse\">\n      <path d=\"M 20 0 L 0 0 0 20\" fill=\"none\" stroke=\"#c5d5e4\" stroke-width=\"0.5\"/>\n    </pattern>\n    <pattern id=\"grid-major\" width=\"100\" height=\"100\" patternUnits=\"userSpaceOnUse\">\n      <rect width=\"100\" height=\"100\" fill=\"url(#grid)\"/>\n      <path d=\"M 100 0 L 0 0 0 100\" fill=\"none\" stroke=\"#b0c4d8\" stroke-width=\"1\"/>\n    </pattern>\n    <style>\n      .connection { stroke: #25537b; stroke-width: 4; fill: none; stroke-linecap: round; }\n      .connection-qc { stroke: #25537b; stroke-width: 3; fill: none; stroke-linecap: round; stroke-dasharray: 5 3; }\n      .connection-secondary { stroke: #25537b; stroke-width: 3; fill: none; stroke-linecap: round; }\n      .node-card { filter: drop-shadow(1px 2px 3px rgba(0,0,0,0.15)); }\n    </style>\n  </defs>\n\n  <rect width=\"1100\" height=\"530\" fill=\"#f8f9fa\"/>\n  <rect width=\"1100\" height=\"530\" fill=\"url(#grid-major)\"/>\n\n  <rect x=\"0\" y=\"0\" width=\"1100\" height=\"45\" fill=\"#25537b\"/>\n  <text x=\"20\" y=\"28\" font-family=\"system-ui, sans-serif\" font-size=\"16\" font-weight=\"600\" fill=\"white\">Segmentation and Counting of Cell Nuclei in Fluorescence Microscopy</text>\n\n  <!-- CONNECTIONS -->\n  <!-- Input Image -> Gaussian Filter -->\n  <path class=\"connection\" d=\"M 180 195 C 220 195, 240 230, 290 230\"/>\n  <!-- Input Image -> Histogram Equalization (for visualization) -->\n  <path class=\"connection-secondary\" d=\"M 180 175 C 250 175, 250 115, 290 115\"/>\n  <!-- Gaussian Filter -> Otsu Threshold -->\n  <path class=\"connection\" d=\"M 490 230 C 530 230, 530 230, 570 230\"/>\n  <!-- Otsu Threshold -> Binary to Label Map -->\n  <path class=\"connection\" d=\"M 770 230 C 810 230, 810 230, 850 230\"/>\n  <!-- Binary to Label Map -> Count Objects -->\n  <path class=\"connection\" d=\"M 850 275 C 850 360, 890 360, 960 360\"/>\n  <!-- Binary to Label Map -> Overlay Images -->\n  <path class=\"connection\" d=\"M 850 230 C 890 230, 890 200, 850 170\"/>\n  <!-- Histogram Equalization -> Convert Format -> Overlay Images -->\n  <path class=\"connection-secondary\" d=\"M 490 115 C 530 115, 530 115, 570 115\"/>\n  <!-- Convert Format -> Overlay Images -->\n  <path class=\"connection-secondary\" d=\"M 770 115 C 810 115, 810 150, 850 150\"/>\n\n  <!-- Label map -> label_image output -->\n  <path class=\"connection\" d=\"M 850 255 C 890 255, 920 285, 960 285\"/>\n\n  <!-- Overlay -> overlay_image output -->\n  <path class=\"connection\" d=\"M 850 115 C 900 115, 930 115, 960 115\"/>\n\n  <!-- INPUT NODES -->\n  <!-- Input Image -->\n  <g class=\"node-card\" transform=\"translate(0, 140)\">\n    <rect width=\"180\" height=\"90\" rx=\"4\" fill=\"white\"/>\n    <rect width=\"180\" height=\"28\" rx=\"4\" fill=\"#ffd700\"/>\n    <rect x=\"0\" y=\"14\" width=\"180\" height=\"14\" fill=\"#ffd700\"/>\n    <text x=\"90\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"#2C3143\" text-anchor=\"middle\">Input Image</text>\n    <text x=\"90\" y=\"55\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">Fluorescence</text>\n    <text x=\"90\" y=\"70\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">microscopy (nuclei)</text>\n    <circle cx=\"180\" cy=\"45\" r=\"6\" fill=\"#ffd700\" stroke=\"white\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- PROCESSING NODES -->\n  <!-- Histogram Equalization -->\n  <g class=\"node-card\" transform=\"translate(290, 75)\">\n    <rect width=\"200\" height=\"90\" rx=\"4\" fill=\"white\"/>\n    <rect width=\"200\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"14\" width=\"200\" height=\"14\" fill=\"#25537b\"/>\n    <text x=\"100\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\" text-anchor=\"middle\">Histogram Equalization</text>\n    <text x=\"100\" y=\"55\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">CLAHE contrast</text>\n    <text x=\"100\" y=\"70\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">enhancement</text>\n    <circle cx=\"0\" cy=\"45\" r=\"6\" fill=\"#25537b\" stroke=\"white\" stroke-width=\"2\"/>\n    <circle cx=\"200\" cy=\"45\" r=\"6\" fill=\"#25537b\" stroke=\"white\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- Convert Image Format -->\n  <g class=\"node-card\" transform=\"translate(570, 75)\">\n    <rect width=\"200\" height=\"90\" rx=\"4\" fill=\"white\"/>\n    <rect width=\"200\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"14\" width=\"200\" height=\"14\" fill=\"#25537b\"/>\n    <text x=\"100\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\" text-anchor=\"middle\">Convert to PNG</text>\n    <text x=\"100\" y=\"55\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">Format conversion</text>\n    <text x=\"100\" y=\"70\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">for visualization</text>\n    <circle cx=\"0\" cy=\"45\" r=\"6\" fill=\"#25537b\" stroke=\"white\" stroke-width=\"2\"/>\n    <circle cx=\"200\" cy=\"45\" r=\"6\" fill=\"#25537b\" stroke=\"white\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- Gaussian Filter -->\n  <g class=\"node-card\" transform=\"translate(290, 195)\">\n    <rect width=\"200\" height=\"90\" rx=\"4\" fill=\"white\"/>\n    <rect width=\"200\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"14\" width=\"200\" height=\"14\" fill=\"#25537b\"/>\n    <text x=\"100\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\" text-anchor=\"middle\">Gaussian Filter</text>\n    <text x=\"100\" y=\"55\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">Noise smoothing</text>\n    <text x=\"100\" y=\"70\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">(sigma=3)</text>\n    <circle cx=\"0\" cy=\"45\" r=\"6\" fill=\"#25537b\" stroke=\"white\" stroke-width=\"2\"/>\n    <circle cx=\"200\" cy=\"45\" r=\"6\" fill=\"#25537b\" stroke=\"white\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- Otsu Threshold -->\n  <g class=\"node-card\" transform=\"translate(570, 195)\">\n    <rect width=\"200\" height=\"90\" rx=\"4\" fill=\"white\"/>\n    <rect width=\"200\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"14\" width=\"200\" height=\"14\" fill=\"#25537b\"/>\n    <text x=\"100\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\" text-anchor=\"middle\">Otsu Threshold</text>\n    <text x=\"100\" y=\"55\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">Automatic binary</text>\n    <text x=\"100\" y=\"70\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">segmentation</text>\n    <circle cx=\"0\" cy=\"45\" r=\"6\" fill=\"#25537b\" stroke=\"white\" stroke-width=\"2\"/>\n    <circle cx=\"200\" cy=\"45\" r=\"6\" fill=\"#25537b\" stroke=\"white\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- Binary to Label Map -->\n  <g class=\"node-card\" transform=\"translate(850, 195)\">\n    <rect width=\"200\" height=\"90\" rx=\"4\" fill=\"white\"/>\n    <rect width=\"200\" height=\"28\" rx=\"4\" fill=\"#25537b\"/>\n    <rect x=\"0\" y=\"14\" width=\"200\" height=\"14\" fill=\"#25537b\"/>\n    <text x=\"100\" y=\"19\" font-family=\"system-ui, sans-serif\" font-size=\"11\" font-weight=\"600\" fill=\"white\" text-anchor=\"middle\">Binary to Label Map</text>\n    <text x=\"100\" y=\"55\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">Connected component</text>\n    <text x=\"100\" y=\"70\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#868e96\" text-anchor=\"middle\">analysis (CCA)</text>\n    <circle cx=\"0\" cy=\"45\" r=\"6\" fill=\"#25537b\" stroke=\"white\" stroke-width=\"2\"/>\n    <circle cx=\"200\" cy=\"45\" r=\"6\" fill=\"#25537b\" stroke=\"white\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- OUTPUT NODES -->\n  <!-- Overlay Image -->\n  <g class=\"node-card\" transform=\"translate(960, 90)\">\n    <rect width=\"120\" height=\"50\" rx=\"4\" fill=\"white\"/>\n    <rect width=\"120\" height=\"24\" rx=\"4\" fill=\"#f97316\"/>\n    <rect x=\"0\" y=\"12\" width=\"120\" height=\"12\" fill=\"#f97316\"/>\n    <text x=\"60\" y=\"17\" font-family=\"system-ui, sans-serif\" font-size=\"10\" font-weight=\"600\" fill=\"white\" text-anchor=\"middle\">Overlay Image</text>\n    <text x=\"60\" y=\"40\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\" text-anchor=\"middle\">Contours on image</text>\n    <circle cx=\"0\" cy=\"25\" r=\"6\" fill=\"#f97316\" stroke=\"white\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- Label Image -->\n  <g class=\"node-card\" transform=\"translate(960, 260)\">\n    <rect width=\"120\" height=\"50\" rx=\"4\" fill=\"white\"/>\n    <rect width=\"120\" height=\"24\" rx=\"4\" fill=\"#f97316\"/>\n    <rect x=\"0\" y=\"12\" width=\"120\" height=\"12\" fill=\"#f97316\"/>\n    <text x=\"60\" y=\"17\" font-family=\"system-ui, sans-serif\" font-size=\"10\" font-weight=\"600\" fill=\"white\" text-anchor=\"middle\">Label Image</text>\n    <text x=\"60\" y=\"40\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\" text-anchor=\"middle\">Segmented nuclei</text>\n    <circle cx=\"0\" cy=\"25\" r=\"6\" fill=\"#f97316\" stroke=\"white\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- Objects Count -->\n  <g class=\"node-card\" transform=\"translate(960, 340)\">\n    <rect width=\"120\" height=\"50\" rx=\"4\" fill=\"white\"/>\n    <rect width=\"120\" height=\"24\" rx=\"4\" fill=\"#f97316\"/>\n    <rect x=\"0\" y=\"12\" width=\"120\" height=\"12\" fill=\"#f97316\"/>\n    <text x=\"60\" y=\"17\" font-family=\"system-ui, sans-serif\" font-size=\"10\" font-weight=\"600\" fill=\"white\" text-anchor=\"middle\">Objects Count</text>\n    <text x=\"60\" y=\"40\" font-family=\"system-ui, sans-serif\" font-size=\"9\" fill=\"#868e96\" text-anchor=\"middle\">Nuclei count</text>\n    <circle cx=\"0\" cy=\"25\" r=\"6\" fill=\"#f97316\" stroke=\"white\" stroke-width=\"2\"/>\n  </g>\n\n  <!-- LEGEND -->\n  <g transform=\"translate(20, 470)\">\n    <rect width=\"1060\" height=\"45\" rx=\"6\" fill=\"white\" fill-opacity=\"0.85\" stroke=\"#dee2e6\"/>\n    <rect x=\"15\" y=\"15\" width=\"14\" height=\"14\" rx=\"3\" fill=\"#ffd700\"/>\n    <text x=\"35\" y=\"26\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Input</text>\n    <line x1=\"100\" y1=\"22\" x2=\"150\" y2=\"22\" stroke=\"#25537b\" stroke-width=\"4\" stroke-linecap=\"round\"/>\n    <text x=\"158\" y=\"26\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Data flow</text>\n    <line x1=\"260\" y1=\"22\" x2=\"310\" y2=\"22\" stroke=\"#25537b\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-dasharray=\"5 3\"/>\n    <text x=\"318\" y=\"26\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">QC / secondary</text>\n    <rect x=\"440\" y=\"15\" width=\"14\" height=\"14\" rx=\"3\" fill=\"#f97316\"/>\n    <text x=\"460\" y=\"26\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Output</text>\n    <rect x=\"530\" y=\"15\" width=\"14\" height=\"14\" rx=\"3\" fill=\"#25537b\"/>\n    <text x=\"550\" y=\"26\" font-family=\"system-ui, sans-serif\" font-size=\"10\" fill=\"#495057\">Processing</text>\n  </g>\n</svg>",
    "updated": "2024-11-07T00:00:00",
    "trsID": "#workflow/github.com/iwc-workflows/fluorescence-nuclei-segmentation-and-counting/main",
    "iwcID": "fluorescence-nuclei-segmentation-and-counting-main",
    "dockstore_id": 25723,
    "categories": [],
    "collections": [
        "Imaging"
    ],
    "doi": "10.5281/zenodo.15078515",
    "tests": [
        {
            "doc": "Test outline for segmentation-and-counting.ga",
            "job": {
                "input_image": {
                    "class": "File",
                    "filetype": "tiff",
                    "hashes": [
                        {
                            "hash_function": "SHA-1",
                            "hash_value": "42c34939d896d133ce9f0f2af6efd79b02ed52e6"
                        }
                    ],
                    "location": "https://raw.githubusercontent.com/galaxyproject/iwc/main/workflows/imaging/fluorescence-nuclei-segmentation-and-counting/test-data/input_image.tiff"
                }
            },
            "outputs": {
                "overlay_image": {
                    "path": "test-data/overlay_image.png",
                    "compare": "image_diff"
                },
                "objects_count": {
                    "path": "test-data/objects_count.tabular",
                    "compare": "diff",
                    "lines_diff": 0
                },
                "label_image": {
                    "path": "test-data/label_image.tiff",
                    "compare": "image_diff",
                    "metric": "iou"
                }
            }
        }
    ]
}