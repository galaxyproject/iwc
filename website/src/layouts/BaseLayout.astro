---
import { ClientRouter } from "astro:transitions";
import "@fontsource/atkinson-hyperlegible/400.css";
import "@fontsource/atkinson-hyperlegible/700.css";
import "@fontsource/atkinson-hyperlegible/400-italic.css";
import "@fontsource/atkinson-hyperlegible/700-italic.css";
import "../styles/global.css";
import IWCFooter from "../components/IWCFooter.astro";

interface Props {
    title?: string;
    description?: string;
    hasHero?: boolean;
    hasLeftSidebar?: boolean;
    hasRightSidebar?: boolean;
    ogTitle?: string;
    ogDescription?: string;
    ogImage?: string;
    ogType?: string;
    twitterCard?: string;
    twitterTitle?: string;
    twitterDescription?: string;
    twitterImage?: string;
}

const {
    title = "Intergalactic Workflow Commission",
    description = "Ready-to-use, open-source pipelines with sample data and training materials",
    hasHero = false,
    hasLeftSidebar = false,
    hasRightSidebar = false,
    ogTitle,
    ogDescription,
    ogImage = "https://iwc.galaxyproject.org/iwc_logo.png",
    ogType = "website",
    twitterCard = "summary",
    twitterTitle,
    twitterDescription,
    twitterImage = "https://iwc.galaxyproject.org/iwc_logo.png",
} = Astro.props;
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <meta name="description" content={description} />
        <title>{title}</title>

        <!-- Open Graph -->
        <meta property="og:title" content={ogTitle || title} />
        <meta property="og:description" content={ogDescription || description} />
        <meta property="og:image" content={ogImage} />
        <meta property="og:type" content={ogType} />

        <!-- Twitter Card -->
        <meta name="twitter:card" content={twitterCard} />
        <meta name="twitter:title" content={twitterTitle || ogTitle || title} />
        <meta name="twitter:description" content={twitterDescription || ogDescription || description} />
        <meta name="twitter:image" content={twitterImage} />

        <link rel="icon" type="image/png" href="/iwc_logo_white.png" />

        <!-- Enable client-side navigation with view transitions -->
        <ClientRouter />

        <!-- Allow pages to inject additional head content (e.g., JSON-LD structured data) -->
        <slot name="head" />
    </head>
    <body class="min-h-dvh flex flex-col bg-chicago-50 font-sans">
        {
            hasHero ? (
                <div class="header-hero-container relative">
                    <header>
                        <slot name="header" />
                    </header>
                    <div>
                        <slot name="hero" />
                    </div>
                </div>
            ) : (
                <header class="header-container relative">
                    <slot name="header" />
                </header>
            )
        }

        <main class="flex-1 flex">
            <div class="w-full">

                <div class="flex flex-col md:flex-row">
                    <!-- Left sidebar if provided -->
                    {
                        hasLeftSidebar && (
                            <div class="hidden md:block md:w-1/4 p-4">
                                <slot name="leftSidebar" />
                            </div>
                        )
                    }

                    <!-- Main content -->
                    <div class="flex-1 min-w-0 px-4 md:px-8 py-4">
                        <slot name="content">
                            <slot />
                        </slot>
                    </div>

                    <!-- Right sidebar if provided -->
                    {
                        hasRightSidebar && (
                            <div class="hidden md:block md:w-1/4 p-4">
                                <slot name="rightSidebar" />
                            </div>
                        )
                    }
                </div>
            </div>
        </main>

        <IWCFooter />
    </body>
</html>

<style>
    .header-hero-container,
    .header-container {
        background: linear-gradient(to bottom, #2c3143 0%, #1a1f2e 100%);
    }

    .header-hero-container::before,
    .header-container::before {
        content: "";
        position: absolute;
        inset: 0;
        background-image: linear-gradient(to right, rgba(255, 255, 255, 0.04) 1px, transparent 1px),
            linear-gradient(to bottom, rgba(255, 255, 255, 0.04) 1px, transparent 1px);
        background-size: 24px 24px;
        pointer-events: none;
    }
</style>
