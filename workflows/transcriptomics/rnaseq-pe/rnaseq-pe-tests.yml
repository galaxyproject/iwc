- doc: Test outline for rnaseq-pe
  job:
    gtf:
      class: File
      location: https://zenodo.org/record/4541751/files/Drosophila_melanogaster.BDGP6.87.gtf
      filetype: gtf
    PE fastq input:
      class: Collection
      collection_type: list:paired
      elements:
      - class: Collection
        type: paired
        identifier: GSM461177
        elements:
        - class: File
          identifier: forward
          location: https://zenodo.org/records/13951092/files/GSM461177_1.fastqsanger
        - class: File
          identifier: reverse
          location: https://zenodo.org/records/13951092/files/GSM461177_2.fastqsanger
      - class: Collection
        type: paired
        identifier: GSM461178
        elements:
        - class: File
          identifier: forward
          location: https://zenodo.org/records/13951092/files/GSM461178_1.fastqsanger
        - class: File
          identifier: reverse
          location: https://zenodo.org/records/13951092/files/GSM461178_2.fastqsanger
      - class: Collection
        type: paired
        identifier: GSM461180
        elements:
        - class: File
          identifier: forward
          location: https://zenodo.org/records/13951092/files/GSM461180_1.fastqsanger
        - class: File
          identifier: reverse
          location: https://zenodo.org/records/13951092/files/GSM461180_2.fastqsanger
      - class: Collection
        type: paired
        identifier: GSM461181
        elements:
        - class: File
          identifier: forward
          location: https://zenodo.org/records/13951092/files/GSM461181_1.fastqsanger
        - class: File
          identifier: reverse
          location: https://zenodo.org/records/13951092/files/GSM461181_2.fastqsanger

    forward_adapter: CTGTCTCTTATACACATCTCCGAGCCCACGAGAC
    reverse_adapter: CTGTCTCTTATACACATCTGACGCTGCCGACGA
    reference_genome: dm6
    strandedness: unstranded
    cufflinks_FPKM: true
    gtf with regions to exclude from FPKM normalization with Cufflinks: null
    stringtie_FPKM: true
  outputs:
    mapped-reads:
      element_tests:
        GSM461177:
          has_size:
            value: 3058282
            delta: 150000
        GSM461178:
          has_size:
            value: 3032322
            delta: 150000
        GSM461180:
          has_size:
            value: 3165439
            delta: 150000
        GSM461181:
          has_size:
            value: 3075214
            delta: 150000

    genes_expression_cufflinks:
      element_tests:
        GSM461177:
          asserts:
            has_line:
              line: "FBgn0017545	-	-	FBgn0017545	RpS3A	-	chr4:65224-67207	-	-	128511	122676	134345	OK"
        GSM461178:
          asserts:
            has_line:
              line: "FBgn0017545	-	-	FBgn0017545	RpS3A	-	chr4:65224-67207	-	-	141422	134823	148020	OK"
        GSM461180:
          asserts:
            has_line:
              line: "FBgn0017545	-	-	FBgn0017545	RpS3A	-	chr4:65224-67207	-	-	134779	128494	141063	OK"
        GSM461181:
          asserts:
            has_line:
              line: "FBgn0017545	-	-	FBgn0017545	RpS3A	-	chr4:65224-67207	-	-	127880	121988	133772	OK"
    transcripts_expression_cufflinks:
      element_tests:
        GSM461177:
          asserts:
            has_line:
              line: "FBtr0089175	-	-	FBgn0017545	RpS3A	-	chr4:66196-67207	910	409.883	114524	108672	120376	OK"
        GSM461178:
          asserts:
            has_line:
              line: "FBtr0089175	-	-	FBgn0017545	RpS3A	-	chr4:66196-67207	910	370.382	128757	122145	135370	OK"
        GSM461180:
          asserts:
            has_line:
              line: "FBtr0089175	-	-	FBgn0017545	RpS3A	-	chr4:66196-67207	910	366.172	122426	116120	128732	OK"
        GSM461181:
          asserts:
            has_line:
              line: "FBtr0089175	-	-	FBgn0017545	RpS3A	-	chr4:66196-67207	910	404.198	115973	110059	121886	OK"

    genes_expression_stringtie:
      element_tests:
        GSM461177:
          asserts:
            has_text_matching:
              expression: "FBgn0017545\tRpS3A\tchr4\t-\t65225\t67207\t324.32[0-9]*\t135844.57[0-9]*\t364040.59[0-9]*"
        GSM461178:
          asserts:
            has_text_matching:
              expression: "FBgn0017545\tRpS3A\tchr4\t-\t65225\t67207\t286.68[0-9]*\t143296.84[0-9]*\t365993.15[0-9]*"
        GSM461180:
          asserts:
            has_text_matching:
              expression: "FBgn0017545\tRpS3A\tchr4\t-\t65225\t67207\t282.60[0-9]*\t138208.90[0-9]*\t367356.56[0-9]*"
        GSM461181:
          asserts:
            has_text_matching:
              expression: "FBgn0017545\tRpS3A\tchr4\t-\t65225\t67207\t316.33[0-9]*\t129439.64[0-9]*\t344739.90[0-9]*"
