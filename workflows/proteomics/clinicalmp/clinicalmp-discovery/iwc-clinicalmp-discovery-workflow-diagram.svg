<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 920 580" role="img" aria-label="Clinical Metaproteomics Discovery Workflow diagram">
  <title>Clinical Metaproteomics Discovery Workflow</title>
  <desc>Workflow for clinical metaproteomics database searching using dual search engines (SearchGUI/PeptideShaker and MaxQuant) to identify microbial peptides</desc>
  <defs>
    <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
      <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#c5d5e4" stroke-width="0.5"/>
    </pattern>
    <pattern id="grid-major" width="100" height="100" patternUnits="userSpaceOnUse">
      <rect width="100" height="100" fill="url(#grid)"/>
      <path d="M 100 0 L 0 0 0 100" fill="none" stroke="#b0c4d8" stroke-width="1"/>
    </pattern>
    <style>
      .connection { stroke: #25537b; stroke-width: 4; fill: none; stroke-linecap: round; }
      .connection-qc { stroke: #25537b; stroke-width: 3; fill: none; stroke-linecap: round; stroke-dasharray: 5 3; }
      .connection-secondary { stroke: #25537b; stroke-width: 3; fill: none; stroke-linecap: round; }
      .node-card { filter: drop-shadow(1px 2px 3px rgba(0,0,0,0.15)); }
    </style>
  </defs>
  <rect width="920" height="580" fill="#f8f9fa"/>
  <rect width="920" height="580" fill="url(#grid-major)"/>
  <rect x="0" y="0" width="920" height="45" fill="#25537b"/>
  <text x="20" y="28" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="white">Clinical Metaproteomics Discovery Workflow</text>

  <!-- Connections -->
  <path d="M 180 115 C 220 115, 230 140, 270 140" class="connection"/>
  <path d="M 180 195 C 230 195, 240 210, 270 210" class="connection"/>
  <path d="M 180 275 C 230 275, 230 280, 270 280" class="connection"/>
  <path d="M 180 115 C 250 115, 250 350, 270 350" class="connection-secondary"/>
  <path d="M 470 140 C 510 140, 530 140, 560 140" class="connection"/>
  <path d="M 470 210 C 510 210, 530 215, 560 215" class="connection"/>
  <path d="M 470 280 C 510 280, 530 280, 560 280" class="connection"/>
  <path d="M 470 350 C 510 350, 530 350, 560 350" class="connection"/>
  <path d="M 760 140 C 790 140, 800 105, 820 105" class="connection"/>
  <path d="M 760 215 C 790 215, 800 105, 820 105" class="connection"/>
  <path d="M 760 280 C 790 280, 800 165, 820 165" class="connection"/>
  <path d="M 760 350 C 800 350, 810 165, 820 165" class="connection"/>

  <!-- Input Nodes -->
  <g class="node-card" transform="translate(0, 75)">
    <rect width="180" height="90" rx="4" fill="white" stroke="#e0e0e0" stroke-width="1"/>
    <rect width="180" height="28" rx="4" fill="#ffd700"/>
    <rect x="0" y="14" width="180" height="14" fill="#ffd700"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#2C3143">Protein Database</text>
    <text x="10" y="50" font-family="system-ui, sans-serif" font-size="9" fill="#495057">MetaNovo Human</text>
    <text x="10" y="62" font-family="system-ui, sans-serif" font-size="9" fill="#495057">SwissProt + cRAP</text>
    <circle cx="180" cy="45" r="6" fill="#ffd700" stroke="white" stroke-width="2"/>
  </g>

  <g class="node-card" transform="translate(0, 155)">
    <rect width="180" height="90" rx="4" fill="white" stroke="#e0e0e0" stroke-width="1"/>
    <rect width="180" height="28" rx="4" fill="#ffd700"/>
    <rect x="0" y="14" width="180" height="14" fill="#ffd700"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#2C3143">MS/MS Files</text>
    <text x="10" y="50" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Tandem Mass Spec</text>
    <text x="10" y="62" font-family="system-ui, sans-serif" font-size="9" fill="#495057">RAW files (collection)</text>
    <circle cx="180" cy="45" r="6" fill="#ffd700" stroke="white" stroke-width="2"/>
  </g>

  <g class="node-card" transform="translate(0, 235)">
    <rect width="180" height="90" rx="4" fill="white" stroke="#e0e0e0" stroke-width="1"/>
    <rect width="180" height="28" rx="4" fill="#ffd700"/>
    <rect x="0" y="14" width="180" height="14" fill="#ffd700"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#2C3143">Experimental Design</text>
    <text x="10" y="50" font-family="system-ui, sans-serif" font-size="9" fill="#495057">MaxQuant design file</text>
    <circle cx="180" cy="45" r="6" fill="#ffd700" stroke="white" stroke-width="2"/>
  </g>

  <!-- Processing Nodes - Search Engines -->
  <g class="node-card" transform="translate(270, 100)">
    <rect width="200" height="90" rx="4" fill="white" stroke="#e0e0e0" stroke-width="1"/>
    <rect width="200" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="14" width="200" height="14" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">SearchGUI + PeptideShaker</text>
    <text x="10" y="50" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Database search with</text>
    <text x="10" y="62" font-family="system-ui, sans-serif" font-size="9" fill="#495057">X!Tandem &amp; MSGF+</text>
    <circle cx="0" cy="45" r="6" fill="#25537b" stroke="white" stroke-width="2"/>
    <circle cx="200" cy="45" r="6" fill="#25537b" stroke="white" stroke-width="2"/>
  </g>

  <g class="node-card" transform="translate(270, 240)">
    <rect width="200" height="90" rx="4" fill="white" stroke="#e0e0e0" stroke-width="1"/>
    <rect width="200" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="14" width="200" height="14" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">MaxQuant</text>
    <text x="10" y="50" font-family="system-ui, sans-serif" font-size="9" fill="#495057">TMT 11-plex quantification</text>
    <text x="10" y="62" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Match between runs</text>
    <circle cx="0" cy="45" r="6" fill="#25537b" stroke="white" stroke-width="2"/>
    <circle cx="200" cy="45" r="6" fill="#25537b" stroke="white" stroke-width="2"/>
  </g>

  <!-- Processing Nodes - Filter -->
  <g class="node-card" transform="translate(560, 100)">
    <rect width="200" height="90" rx="4" fill="white" stroke="#e0e0e0" stroke-width="1"/>
    <rect width="200" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="14" width="200" height="14" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">Filter Microbial Peptides</text>
    <text x="10" y="50" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Select confident non-human</text>
    <text x="10" y="62" font-family="system-ui, sans-serif" font-size="9" fill="#495057">peptides (SGPS + MQ)</text>
    <circle cx="0" cy="45" r="6" fill="#25537b" stroke="white" stroke-width="2"/>
    <circle cx="200" cy="45" r="6" fill="#25537b" stroke="white" stroke-width="2"/>
  </g>

  <g class="node-card" transform="translate(560, 310)">
    <rect width="200" height="90" rx="4" fill="white" stroke="#e0e0e0" stroke-width="1"/>
    <rect width="200" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="14" width="200" height="14" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">Extract Accessions</text>
    <text x="10" y="50" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Filter UniProt accessions</text>
    <text x="10" y="62" font-family="system-ui, sans-serif" font-size="9" fill="#495057">from SwissProt+cRAP</text>
    <circle cx="0" cy="45" r="6" fill="#25537b" stroke="white" stroke-width="2"/>
    <circle cx="200" cy="45" r="6" fill="#25537b" stroke="white" stroke-width="2"/>
  </g>

  <!-- Output Nodes -->
  <g class="node-card" transform="translate(800, 80)">
    <rect width="120" height="50" rx="4" fill="white" stroke="#e0e0e0" stroke-width="1"/>
    <rect width="120" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="11" width="120" height="11" fill="#f97316"/>
    <text x="8" y="16" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Distinct Peptides</text>
    <text x="8" y="40" font-family="system-ui, sans-serif" font-size="9" fill="#495057">SGPS + MQ merged</text>
    <circle cx="0" cy="25" r="6" fill="#f97316" stroke="white" stroke-width="2"/>
  </g>

  <g class="node-card" transform="translate(800, 140)">
    <rect width="120" height="50" rx="4" fill="white" stroke="#e0e0e0" stroke-width="1"/>
    <rect width="120" height="22" rx="4" fill="#f97316"/>
    <rect x="0" y="11" width="120" height="11" fill="#f97316"/>
    <text x="8" y="16" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Accessions</text>
    <text x="8" y="40" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Filtered accessions</text>
    <circle cx="0" cy="25" r="6" fill="#f97316" stroke="white" stroke-width="2"/>
  </g>

  <!-- Legend -->
  <g transform="translate(20, 490)">
    <rect width="880" height="70" rx="6" fill="white" fill-opacity="0.9" stroke="#e0e0e0"/>
    <text x="15" y="20" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#495057">Legend</text>
    <rect x="15" y="32" width="30" height="16" rx="3" fill="#ffd700"/>
    <text x="50" y="44" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Input</text>
    <line x1="110" y1="40" x2="160" y2="40" stroke="#25537b" stroke-width="4" stroke-linecap="round"/>
    <text x="165" y="44" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Data flow</text>
    <line x1="250" y1="40" x2="300" y2="40" stroke="#25537b" stroke-width="3" stroke-linecap="round" stroke-dasharray="5 3"/>
    <text x="305" y="44" font-family="system-ui, sans-serif" font-size="10" fill="#495057">QC / secondary</text>
    <rect x="420" y="32" width="30" height="16" rx="3" fill="#f97316"/>
    <text x="455" y="44" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Output</text>
    <rect x="520" y="32" width="30" height="16" rx="3" fill="#10b981"/>
    <text x="555" y="44" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Report / QC</text>
  </g>
</svg>