- doc: Test outline for ChIPseq-PE-with-replicates-controls workflow
  job:
    Sample sheet:
      class: File
      path: test-data/test_sample_sheet.tsv
      filetype: tabular
    Sequencing data:
      class: Collection
      collection_type: list:paired
      elements:
      - class: Collection
        type: paired
        identifier: SRR5204807
        elements:
        - identifier: forward
          class: File
          location: https://github.com/nf-core/test-datasets/raw/refs/heads/chipseq/testdata/SRR5204807_Spt5-ChIP_IP1_SacCer_ChIP-Seq_ss100k_R1.fastq.gz
          filetype: fastqsanger.gz
        - identifier: reverse
          class: File
          location: https://github.com/nf-core/test-datasets/raw/refs/heads/chipseq/testdata/SRR5204807_Spt5-ChIP_IP1_SacCer_ChIP-Seq_ss100k_R2.fastq.gz
          filetype: fastqsanger.gz
      - class: Collection
        type: paired
        identifier: SRR5204808
        elements:
        - identifier: forward
          class: File
          location: https://github.com/nf-core/test-datasets/raw/refs/heads/chipseq/testdata/SRR5204808_Spt5-ChIP_IP2_SacCer_ChIP-Seq_ss100k_R1.fastq.gz
          filetype: fastqsanger.gz
        - identifier: reverse
          class: File
          location: https://github.com/nf-core/test-datasets/raw/refs/heads/chipseq/testdata/SRR5204808_Spt5-ChIP_IP2_SacCer_ChIP-Seq_ss100k_R2.fastq.gz
          filetype: fastqsanger.gz
      - class: Collection
        type: paired
        identifier: SRR5204809
        elements:
        - identifier: forward
          class: File
          location: https://github.com/nf-core/test-datasets/raw/refs/heads/chipseq/testdata/SRR5204809_Spt5-ChIP_Input1_SacCer_ChIP-Seq_ss100k_R1.fastq.gz
          filetype: fastqsanger.gz
        - identifier: reverse
          class: File
          location: https://github.com/nf-core/test-datasets/raw/refs/heads/chipseq/testdata/SRR5204809_Spt5-ChIP_Input1_SacCer_ChIP-Seq_ss100k_R2.fastq.gz
          filetype: fastqsanger.gz
      - class: Collection
        type: paired
        identifier: SRR5204810
        elements:
        - identifier: forward
          class: File
          location: https://github.com/nf-core/test-datasets/raw/refs/heads/chipseq/testdata/SRR5204810_Spt5-ChIP_Input2_SacCer_ChIP-Seq_ss100k_R1.fastq.gz
          filetype: fastqsanger.gz
        - identifier: reverse
          class: File
          location: https://github.com/nf-core/test-datasets/raw/refs/heads/chipseq/testdata/SRR5204810_Spt5-ChIP_Input2_SacCer_ChIP-Seq_ss100k_R2.fastq.gz
          filetype: fastqsanger.gz
    Reference genome: "sacCer3"
    Sequencing adapter - forward: null
    Sequencing adapter - reverse: null
    Effective genome size: 12000000
    Average size of sequenced fragments: 200
  outputs:
    multiqc_stats:
      asserts:
        has_n_lines:
          n: 5
        has_text_matching:
          expression: "SRR5204807_Spt5_rep1\t163.0\t0.0\t0.0\t844.+"
    macs2_report:
      element_tests:
        wt_H3K4me3:
          asserts:
            - that: "has_text"
              text: "# name = SRR5204807_Spt5_rep1"
            - that: "has_text"
              text: "# fragment size is determined as 163 bps"
            - that: "has_text"
              text: "# fragments after filtering in treatment: 86394"
    mapping_stats:
      element_tests:
        SRR5204807_Spt5_rep1:
            asserts:
            - that: "has_text"
              text: "3067 (3.14%) aligned concordantly 0 times"
            - that: "has_text"
              text: "80795 (82.60%) aligned concordantly exactly 1 time"
