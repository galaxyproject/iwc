# VGP Workflow #2

This workflow performs a phased assembly using Hifi Pacbio dta.

## VGP Pipeline

The Collaboration between the [VGP](https://vertebrategenomesproject.org/) lead to the creation of a set of workflows dedicated to hybrid genome assembly. The pipeline inclide de following workflows:
-   Creation of kmer count histograms with Meryl
-   Hifi Long Read phased assembly with Hifiasm
-   Scaffolding with Bionano Mapping data (Optional)
-   Scaffolding with HiC data



### Inputs

-   Collection of PacBio long reads
-   Meryl database generated by the workflow VGP #1 : Meryl database creation
-   Lineage of the organism to use for Busco search
-   Ploidy of the organism

### Outputs

-   Cutadapt trimmed reads
-   Hifiasm assembly :
    -   Primary assembly contig graph
    -   Alternate assembly contig graph
    -   Haplotype resolved unitig graph
    -   Processed unitig graph

#### Hifiasm Primary assembly

-   Primary assembly in fasta format
-   Quast Quality Control
    -   Tabular report
    -   HTML report
    -   PDF report
    -   Log
-   Busco search
    -   Short text summary
    -   Missing Buscos table
    -   Full table
    -   Summary image
-   Coverage cutoffs and read depth histograms
    -   Stats
    -   Base Coverage (tabular)
    -   Base coverage (wig)
    -   Histogram plot
    -   Cutoffs
    -   Log
-   Haplotigs and overlaps in an assembly
    -   Duplication bed file
    -   Log
    -   Purged Assembly (Primary) (fasta)
    -   Sequences purged from the assembly (alternate) (fasta)


#### Hifiasm Alternate assembly

-   Alternate assembly in fasta format
-   Full Alternate assembly in fasta format (Hifiasm alternate + purge dups alternate)
-   Coverage cutoffs and read depth histograms
    -   Stats
    -   Base Coverage (tabular)
    -   Base coverage (wig)
    -   Histogram plot
    -   Cutoffs
    -   Log
-   Haplotigs and overlaps in an assembly
    -   Duplication bed file
    -   Log
    -   Purged Assembly (Primary) (fasta)
    -   Sequences purged from the assembly (alternate) (fasta)

#### Purged Primary assembly

-   Quast Quality Control
    -   Tabular report
    -   HTML report
    -   PDF report
    -   Log
-   Busco search
    -   Short text summary
    -   Missing Buscos table
    -   Full table
    -   Summary image

#### Purged Alternate assembly

-   Quast Quality Control
    -   Tabular report
    -   HTML report
    -   PDF report
    -   Log
-   Busco search
    -   Short text summary
    -   Missing Buscos table
    -   Full table
    -   Summary image


#### Other stats

-   GenomeScope
    -   Linear plot
    -   Log plot
    -   Transformed linear plot
    -   Transformed log plot
    -   Model
    -   Summary
    -   Model parameters
-   Parameter file containing the estimated genome size
-   Merqury analysis of Hifiasm assemblies
    -   Stats
    -   Size files
    -   Qv files
    -   Images
    -   Bed files
    -   Wig files
-   Merqury analysis of purged assemblies
    -   Stats
    -   Size files
    -   Qv files
    -   Images
    -   Bed files
    -   Wig files
