# VGP Workflow #2

This workflow performs a pseudohaplotype-phased assembly using PacBio HiFi long read data. This results in a **primary** and an **alternate** assembly. Since this workflow runs hifiasm with *internal purging turned off*, the primary assembly from this workflow might still have **false duplicates** in it, resulting from haplotypic duplication. This can be purged at a later step. 

## VGP Assembly Pipeline

The collaboration between the [VGP](https://vertebrategenomesproject.org/) has led to the creation of a set of workflows dedicated to high-quality genome assembly with long reads. The pipeline includes the following workflows:
-   Creation of k-mer count databases and histograms with Meryl
-   HiFi long read assembly with Hifiasm (three modes available: pseudohaplotype, HiC-phased, and trio)
-   Scaffolding with Bionano optical map data (optional)
-   Scaffolding with HiC data


### Inputs

-   PacBio HiFi long reads (as a collection)
-   Meryl database, generated by the workflow `VGP #1 : Meryl database creation`
-   GenomeScope summary, generated by the workflow `VGP #1: Meryl database creation`

### Outputs

-   Cutadapt trimmed reads (as a collection)
-   Hifiasm assembly:
    -   GFAs:
        -   Primary assembly contig graph
        -   Alternate assembly contig graph
        -   Raw unitig graph
        -   Processed unitig graph
    -   Hifiasm Primary assembly:
        -   Primary assembly in fasta format
        -   BUSCO 
            -   Short text summary
            -   Missing Buscos table
            -   Full table
            -   Summary image
    -   Hifiasm Alternate assembly:
        -   Alternate assembly in fasta format
-   Parameter file containing the estimated genome size (for use in downstream workflows)
-   QUAST statistics for both assemblies:
        -   Tabular report
        -   HTML report
        -   PDF report
        -   Log
-   Merqury analysis of Hifiasm assemblies
    -   Stats (completeness stats)
    -   Size files
    -   QV files
    -   Images (spectra-cn & spectra-asm plots)
    -   BED files
    -   WIG files
-   gfastats
    -   gfastats on primary contig graph
    -   gfastats on alternate contig graph
