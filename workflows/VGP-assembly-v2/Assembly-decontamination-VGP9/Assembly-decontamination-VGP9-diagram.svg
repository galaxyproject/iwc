<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 600" role="img" aria-label="Assembly decontamination VGP9 workflow diagram">
  <title>Assembly Decontamination VGP9</title>
  <desc>VGP workflow for decontaminating genome assemblies using NCBI FCS tools for adapter screening, foreign organism detection, and mitochondrial sequence identification</desc>

  <defs>
    <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
      <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#c5d5e4" stroke-width="0.5"/>
    </pattern>
    <pattern id="grid-major" width="100" height="100" patternUnits="userSpaceOnUse">
      <rect width="100" height="100" fill="url(#grid)"/>
      <path d="M 100 0 L 0 0 0 100" fill="none" stroke="#b0c4d8" stroke-width="1"/>
    </pattern>
    <style>
      .connection { stroke: #25537b; stroke-width: 4; fill: none; stroke-linecap: round; }
      .connection-secondary { stroke: #25537b; stroke-width: 3; fill: none; stroke-linecap: round; }
      .connection-qc { stroke: #25537b; stroke-width: 3; fill: none; stroke-linecap: round; stroke-dasharray: 5 3; }
      .node-card { filter: drop-shadow(1px 2px 3px rgba(0,0,0,0.15)); }
    </style>
  </defs>

  <rect width="1100" height="600" fill="#f8f9fa"/>
  <rect width="1100" height="600" fill="url(#grid-major)"/>

  <rect x="0" y="0" width="1100" height="45" fill="#25537b"/>
  <text x="20" y="28" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="white">Assembly Decontamination VGP9</text>
  <text x="1080" y="28" text-anchor="end" font-family="system-ui, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)">VGP Assembly Pipeline</text>

  <!-- CONNECTIONS -->

  <!-- Assembly to FCS Adaptor -->
  <path class="connection" d="M 200 130 C 260 130, 280 110, 330 110"/>

  <!-- Assembly to FCS-GX -->
  <path class="connection" d="M 200 140 C 270 140, 290 240, 330 240"/>

  <!-- Assembly to BLAST Mito -->
  <path class="connection" d="M 200 150 C 280 150, 290 370, 330 370"/>

  <!-- FCS Adaptor to Modify Action -->
  <path class="connection" d="M 530 110 C 580 110, 590 170, 620 170"/>

  <!-- FCS-GX to Modify Action -->
  <path class="connection" d="M 530 240 C 580 240, 590 190, 620 190"/>

  <!-- Assembly to Modify Action (for cleanup) -->
  <path class="connection" d="M 200 145 C 500 145, 580 180, 620 180"/>

  <!-- BLAST Mito to Modify Action -->
  <path class="connection" d="M 530 370 C 580 370, 590 205, 620 205"/>

  <!-- Modify Action to gfastats -->
  <path class="connection" d="M 820 180 C 870 180, 870 180, 900 180"/>

  <!-- gfastats to Clean Assembly output -->
  <path class="connection" d="M 1000 170 C 1020 170, 1020 105, 920 105"/>

  <!-- FCS Adaptor to Adaptor Report -->
  <path class="connection-qc" d="M 530 125 C 700 125, 880 310, 920 310"/>

  <!-- FCS-GX to Contaminants Report -->
  <path class="connection-qc" d="M 530 260 C 700 260, 880 385, 920 385"/>

  <!-- BLAST Mito to Mito Report -->
  <path class="connection-qc" d="M 530 385 C 700 385, 880 465, 920 465"/>

  <!-- INPUT NODES -->

  <!-- Scaffolded Assembly -->
  <g class="node-card" transform="translate(20, 90)">
    <rect width="180" height="90" rx="4" fill="white" stroke="#ffd700" stroke-width="1.5"/>
    <rect width="180" height="28" rx="4" fill="#ffd700"/>
    <rect x="0" y="24" width="180" height="4" fill="#ffd700"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(44,49,67,0.6)">1:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#2C3143">Scaffolded Assembly</text>
    <text x="90" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Input FASTA assembly</text>
    <text x="90" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">From scaffolding step</text>
    <circle cx="180" cy="40" r="6" fill="white" stroke="#ffd700" stroke-width="2"/>
    <circle cx="180" cy="55" r="6" fill="white" stroke="#ffd700" stroke-width="2"/>
    <circle cx="180" cy="65" r="6" fill="white" stroke="#ffd700" stroke-width="2"/>
  </g>

  <!-- PROCESSING NODES -->

  <!-- FCS Adaptor -->
  <g class="node-card" transform="translate(330, 70)">
    <rect width="200" height="90" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="200" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="24" width="200" height="4" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)">A:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">NCBI FCS Adaptor</text>
    <text x="100" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Adapter contamination</text>
    <text x="100" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">Screen &amp; remove adapters</text>
    <circle cx="0" cy="40" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="200" cy="40" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="200" cy="55" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
  </g>

  <!-- FCS-GX -->
  <g class="node-card" transform="translate(330, 195)">
    <rect width="200" height="100" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="200" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="24" width="200" height="4" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)">B:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">NCBI FCS-GX</text>
    <text x="100" y="50" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Foreign organism</text>
    <text x="100" y="65" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">contamination screen</text>
    <text x="100" y="82" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">Taxonomy-based detection</text>
    <circle cx="0" cy="45" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="200" cy="45" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="200" cy="65" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
  </g>

  <!-- BLAST Mitochondria -->
  <g class="node-card" transform="translate(330, 330)">
    <rect width="200" height="90" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="200" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="24" width="200" height="4" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)">C:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">BLAST (Mito search)</text>
    <text x="100" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Mitochondrial detection</text>
    <text x="100" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">Identify mito scaffolds</text>
    <circle cx="0" cy="40" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="200" cy="40" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="200" cy="55" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
  </g>

  <!-- Modify Action Report (apply decontamination) -->
  <g class="node-card" transform="translate(620, 130)">
    <rect width="200" height="110" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="200" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="24" width="200" height="4" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)">D:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">Apply Decontamination</text>
    <text x="100" y="50" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Merge action reports</text>
    <text x="100" y="65" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Remove contaminants</text>
    <text x="100" y="82" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#868e96">Filter &amp; mask sequences</text>
    <circle cx="0" cy="40" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="0" cy="55" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="0" cy="70" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="0" cy="80" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="200" cy="50" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
  </g>

  <!-- gfastats -->
  <g class="node-card" transform="translate(900, 140)">
    <rect width="100" height="80" rx="4" fill="white" stroke="#25537b" stroke-width="1"/>
    <rect width="100" height="28" rx="4" fill="#25537b"/>
    <rect x="0" y="24" width="100" height="4" fill="#25537b"/>
    <text x="10" y="19" font-family="system-ui, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)">E:</text>
    <text x="26" y="19" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white">gfastats</text>
    <text x="50" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#495057">Final stats</text>
    <circle cx="0" cy="45" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
    <circle cx="100" cy="35" r="6" fill="white" stroke="#25537b" stroke-width="2"/>
  </g>

  <!-- OUTPUT NODES -->

  <!-- Final Decontaminated Assembly -->
  <g class="node-card" transform="translate(920, 70)">
    <rect width="160" height="60" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="160" height="24" rx="4" fill="#f97316"/>
    <rect x="0" y="20" width="160" height="4" fill="#f97316"/>
    <text x="80" y="16" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Clean Assembly</text>
    <text x="80" y="42" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Decontaminated FASTA</text>
    <text x="80" y="54" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">Assembly info + stats</text>
    <circle cx="0" cy="35" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- Adaptor Report -->
  <g class="node-card" transform="translate(920, 280)">
    <rect width="160" height="50" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="160" height="24" rx="4" fill="#f97316"/>
    <rect x="0" y="20" width="160" height="4" fill="#f97316"/>
    <text x="80" y="16" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Adaptor Report</text>
    <text x="80" y="42" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Masking action report</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- Contaminants Report -->
  <g class="node-card" transform="translate(920, 355)">
    <rect width="160" height="60" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="160" height="24" rx="4" fill="#f97316"/>
    <rect x="0" y="20" width="160" height="4" fill="#f97316"/>
    <text x="80" y="16" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Contaminants</text>
    <text x="80" y="42" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Taxonomy report</text>
    <text x="80" y="54" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">Foreign sequences</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- Mitochondrial Report -->
  <g class="node-card" transform="translate(920, 435)">
    <rect width="160" height="60" rx="4" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <rect width="160" height="24" rx="4" fill="#f97316"/>
    <rect x="0" y="20" width="160" height="4" fill="#f97316"/>
    <text x="80" y="16" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white">Mito Scaffolds</text>
    <text x="80" y="42" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#495057">Mitochondrial seqs</text>
    <text x="80" y="54" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#868e96">Identified by BLAST</text>
    <circle cx="0" cy="30" r="5" fill="white" stroke="#f97316" stroke-width="2"/>
  </g>

  <!-- Legend -->
  <g transform="translate(20, 570)">
    <text x="0" y="0" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#495057">Legend:</text>
    <rect x="60" y="-10" width="14" height="14" rx="2" fill="white" stroke="#ffd700" stroke-width="1.5"/>
    <text x="80" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Input</text>
    <rect x="130" y="-10" width="14" height="14" rx="2" fill="white" stroke="#25537b" stroke-width="1.5"/>
    <text x="150" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Processing</text>
    <line x1="230" y1="-4" x2="270" y2="-4" stroke="#25537b" stroke-width="4" stroke-linecap="round"/>
    <text x="278" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Data flow</text>
    <line x1="350" y1="-4" x2="390" y2="-4" stroke="#25537b" stroke-width="3" stroke-linecap="round" stroke-dasharray="5 3"/>
    <text x="398" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">QC metrics</text>
    <rect x="480" y="-10" width="14" height="14" rx="2" fill="white" stroke="#f97316" stroke-width="1.5"/>
    <text x="500" y="0" font-family="system-ui, sans-serif" font-size="9" fill="#6c757d">Output</text>
  </g>
</svg>