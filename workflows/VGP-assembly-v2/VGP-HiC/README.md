# VGP Workflow #4

This workflow produces uses HiC reads to scaffold either contigs or scaffolds (*e.g.*, scaffolds from the Bionano workflow). In the absence of additional Bionano scaffolding data, this workflow can also be run on the contigs straight out from either hifiasm or purge_dups. 

## VGP Assembly Pipeline

The collaboration between the [VGP](https://vertebrategenomesproject.org/) has led to the creation of a set of workflows dedicated to high-quality genome assembly with long reads. The pipeline includes the following workflows:
-   Creation of k-mer count databases and histograms with Meryl
-   HiFi long read assembly with Hifiasm (three modes available: pseudohaplotype, HiC-phased, and trio)
-   Scaffolding with Bionano optical map data (optional)
-   Scaffolding with HiC data


### Inputs

-   HiC forward (R1) reads
    -   NOTE: if you have multiple files of forward reads, you must concatenate them into one file
-   HiC reverse (R2) reads
    -   NOTE: if you have multiple files of reverse reads, you must concatenate them into one file, in the same order as the concatenated R1 reads
-   Restriction enzyme sequences text file (this is the `re_bases.txt` file in Genome Ark for VGP assemblies)
-   Contigs in fasta format (output of the workflow `VGP #2: Long read assembly with hifiasm`) or scaffolds in fasta format (output of the workflow `VGP #3: Bionano scaffolding`)
-   Estimated genome size parameter file, generated by workflow `VGP #2: Long read assembly with hifiasm`

### Outputs

-   Pretext heatmap before HiC scaffolding
    -   PretextMap files and sorted BAM files are also produced
-   Pretext heatmap after HiC scaffolding
    -   PretextMap files and sorted BAM files are also produced
-   SALSA2 scaffolded assembly outputs:
    -   HiC scaffolded assembly (as fasta file)
    -   AGP file
-   QUAST
    -   Tabular report
    -   HTML report
    -   PDF report
    -   Log
-   BUSCO
    -   Short text summary
    -   Missing Buscos table
    -   Full table
    -   Summary image
-   gfastats on HiC scaffolded assembly
